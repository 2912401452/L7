_jsload_('mouse', 'w.Ob.ob({nG:"_docMsMov",I1:function(){var a=this.La.xc;w.C.h(a,"mousedown",this.XV,this);this.uK||(this.uK=function(){this.RA=!1},this.bs=function(a){if(!this.Bf&&!this.Vf){var c=this.zg(a,!0,!0);this.r(this.nG,{event:a,eX:c})}},w.l.ae||(this.bs=w.a.ZW(this.bs,150,this)));this.IX();w.C.h(document,"mousedown",this.uK,this);w.C.h(document,"mouseout",this.bs,this);this.h(this.nG,this.pX,this);w.C.h(a,"mouseover",this.jda,this);w.C.h(a,"mouseup",this.YV,this);w.C.h(a,"contextmenu",this.$z,this);w.C.h(a, "rightclick",this.$z,this)},zaa:function(){var a=this.La.xc;w.C.I(document,"mousemove",this.bs,this);w.C.I(a,"mousemove",this.tK,this)},IX:function(){var a=this.La.xc;w.C.h(document,"mousemove",this.bs,this);w.C.h(a,"mousemove",this.tK,this)},jda:function(){this.RA=!0},V5:function(){var a=this.La.xc;w.C.I(a,"mousedown",this.XV,this);w.C.I(document,"mousedown",this.uK,this);w.C.I(document,"mouseout",this.bs,this);this.I(this.nG,this.pX,this);w.C.I(document,"mousemove",this.bs,this);w.C.I(a,"mousemove", this.tK,this);w.C.I(a,"mouseup",this.YV,this);w.C.I(a,"contextmenu",this.$z,this);w.C.I(a,"rightclick",this.$z,this)},K1:function(){w.C.h(this.La.xc,"mousewheel",this.WV,this)},Y5:function(){w.C.I(this.La.xc,"mousewheel",this.WV,this)},J1:function(){this.h("mousemove",this.JR);this.h("mouseout",this.KR);this.h("mouseover",this.LR);this.h("mouseup",this.MR);this.h("mousedown",this.IR);this.h("rightclick",this.OR);this.h("contextmenu",this.AR);this.h("rdblclick",this.PR)},X5:function(){this.I("mousemove", this.JR);this.I("mouseout",this.KR);this.I("mouseover",this.LR);this.I("mouseup",this.MR);this.I("mousedown",this.IR);this.I("rightclick",this.OR);this.I("contextmenu",this.AR);this.I("rdblclick",this.PR)},keyboardEnableChanged:function(){this.get("keyboardEnable")?this.G1():this.tH()},scrollWheelChanged:function(){this.get("scrollWheel")?this.h("mousewheel",this.NR):this.I("mousewheel",this.NR)},$z:function(a){w.C.preventDefault(a)},M5:function(a){var b=this.zg(a,!1,!0),c=0;"3D"==this.J.view.type? (this.ia("mousewheel",b),a.wheelDelta?(c=a.wheelDelta,window.opera&&9.5>parseFloat(window.opera.version())&&(c=-c)):a.detail&&(c=-a.detail,120!==c&&-120!==c&&(c*=20)),a=c/800,a=this.get("zoom")+a,this.eU(a,b.Bd,!0)):(a.wheelDelta?(c=a.wheelDelta/120,window.opera&&9.5>parseFloat(window.opera.version())&&(c=-c)):a.detail&&(c=-a.detail),this.R.Ux=(this.R.Ux||0)+c,this.r("mousewheel",b))},WV:function(a){this.get("scrollWheel")&&this.M5(a)},vK:function(a,b){w.C.preventDefault(a);b=this.zg(a,!1,!0);var c= this.R;if(!this.Or(b.sb,c.nq)){c.nq=b.sb;if(c.ho){if(!c.Mc&&(b.sb.x!==this.R.Gm.x||b.sb.y!==this.R.Gm.y)){var d;this.SG(c.mq)&&c.mq.get("draggable")&&(d=c.mq);!d&&this.get("dragEnable")&&(d=this);d&&(c.Mc=!0,c.gn=d,c.Gf=c.Gm,c.fn=c.UL)}c.Mc&&(c.ei=b,b.button=a.buttons||a.button||0,this.KH())}if(a.preventDefault)a.preventDefault();else return!1}},iD:function(a){this.IX();w.j.Na(this.K,"amap-drag");a=this.zg(a);w.j.Tba();w.j.RU();this.R&&(this.R.Mc=!1);this.Bf&&!this.Vf&&this.r("moveend");this.R.Em&& (this.R.Em=!1,this.R.Mc=!1,this.R.gn.r("dragend",a));this.R.ho=!1;this.R.nq=null;this.R.Gf=null;w.C.I(document,"mousemove",this.vK,this);w.C.I(document,"mouseup",this.iD,this);try{w.C.I(window.parent.document,"mouseup",this.iD,this)}catch(b){}w.C.kja(this.La.xc)},kda:function(a,b){b=b||this.zg(a);var c=this.get("size"),d;0<=b.sb.x&&b.sb.x<=c.width&&0<=b.sb.y&&b.sb.y<=c.height&&(d=!0);this.xW&&!d?this.r("mouseout",b):!this.xW&&d&&this.r("mouseover",b);this.xW=d},tK:function(a){if(!this.Bf&&!this.Vf&& (w.C.preventDefault(a),w.l.Xo&&(a=window.event),a)){a=this.zg(a);var b=this.R,c=a.ad,d;this.R.ho||(c instanceof w.D.Lg?d=c.Bc.get("cursor"):c instanceof w.w.qc&&(d=c.get("cursor")),d&&c!==this||(d=this.J.Mg.defaultCursor),d=this.J.get("optimalCursor")||d,this.K.style.cursor=d||"");d=b.p5;var e=a.Eq;d!==e&&(d&&b.WQ&&b.WQ.r("mouseout",a),e&&c&&(c.r("mouseover",a),c.get("topWhenMouseOver")&&c.Bc.setTop(!0)));a.ad.r("mousemove",a);a.ad!==this&&this.r("mousemove",a);b.p5=a.Eq||null;b.WQ=a.ad||null}},R:{Mc:!1}, XV:function(a){this.RA=!0;w.j.qba();w.j.IU();this.R.nq=null;this.R.Gf=null;var b=this.zg(a,!0);this.R.LU=new Date;this.R.mq=b.ad;this.R.Gm=b.sb;this.R.n5=b.button;this.R.ho=!0;this.R.o5=b;this.R.Mc||(this.R.UL=b);this.Pd&&this.Pd.stop();var c=b.ad;!c.Bc&&c.get("dragEnable")&&(this.R.ho=!0);w.j.Ha(this.K,"amap-drag");c=!1;b.ad.r("mousedown",b);b.ad!==this&&(this.r("mousedown",b),c=b.ad.get("draggable"));c=c||this.get("dragEnable");w.C.Fha(this.La.xc);w.C.h(document,"mousemove",this.vK,this);w.C.h(document, "mouseup",this.iD,this);try{window.parent.document&&w.l.Xo&&w.C.h(window.parent.document,"mouseup",this.iD,this)}catch(d){}w.C.stopPropagation(a);c&&this.zaa()},pX:function(a){this.kda(a.event,a.eX)},Rla:function(a){this.vK(a.event,a.eX)},YV:function(a){a=this.zg(a);var b=a.ad,c=this.J.get("allBubble")||b.get("bubble");b!==document&&(b.r("mouseup",a),a.ad!==this&&c&&this.r("mouseup",a));this.Or(a.sb,this.R.Gm)&&(this.Xe&&this.Or(this.R.kt,a.sb)&&a.button===this.R.n5?(clearTimeout(this.Xe),this.Xe= null,w.C.DW(a)?c?(b.r("dblclick",a),b!==this&&this.r("dblclick",a)):b.r("dblclick",a):b.r("rdblclick",a),this.R.kt=null):(w.C.DW(a)?(this.r("clickstart",a),c?(b.r("click",a),b!==this&&this.r("click",a)):(b.r("click",a),this.r("closeOverlays",a)),b.get("topWhenClick")&&b.Bc.setTop(!0),this.r("clickend",a)):c?(b.r("rightclick",a),b!==this&&this.r("rightclick",a),this.r("contextmenu",a)):(b.r("rightclick",a),b.r("contextmenu",a)),this.R.kt=a.sb,this.Xe&&clearTimeout(this.Xe),this.Xe=setTimeout(w.a.bind(function(){clearTimeout(this.Xe); this.Xe=null;this.R.kt=null},this),260)))}});w.Ob.ob({NR:function(a){this.ia("mousewheel",a);var b=this;if(1<=Math.abs(this.R.Ux)&&!this.A_){var c=this.R.Ux;if(1<=c)c=1;else if(-1>=c)c=-1;else return;b.rB(a.Bd,c);this.R.Ux=0;this.A_=!0;setTimeout(function(){b.A_=!1;b.R.Ux=0},w.l.Iy?50:40)}},JR:function(a){this.ia("mousemove",a)},KR:function(a){this.ia("mouseout",a)},LR:function(a){this.ia("mouseover",a)},MR:function(a){this.ia("mouseup",a)},IR:function(a){this.ia("mousedown",a)},OR:function(a){this.ia("rightclick",a)},AR:function(a){this.ia("contextmenu", a)},PR:function(a){this.get("doubleClickZoom")&&this.get("zoomEnable")&&this.rB(a.Bd,-1);this.ia("rdblclick",a)}});w.Ob.ob({V4:function(){this.Cw={left:[37],right:[39],HC:[40],pv:[38],kh:[187,107,61],lh:[189,109,173]};this.u2={left:this.Ft(this.oB(100,0)),right:this.Ft(this.oB(-100,0)),HC:this.Ft(this.oB(0,-100)),pv:this.Ft(this.oB(0,100)),kh:this.Ft(this.zT(1)),lh:this.Ft(this.zT(-1))}},G1:function(){this.get("keyboardEnable")&&(this.Cw||this.V4(),w.C.h(document,"keydown",this.lB,this),w.C.h(document,"keyup",this.wR,this))},tH:function(){w.C.I(document,"keydown",this.lB,this);w.C.I(document,"keyup",this.wR,this)}, wR:function(a){var b=a.keyCode;!a.ctrlKey||37!==b&&39!==b||this.set("refresh",1)},lB:function(a){var b=a.keyCode,c;for(c in this.Cw)if(this.Cw.hasOwnProperty(c))for(var d=0;d<this.Cw[c].length;d+=1)if(b===this.Cw[c][d]){if(!this.RA)return;if(!a.ctrlKey&&!a.shiftKey){this.u2[c]();w.C.preventDefault(a);return}37===b?(this.t5(),w.C.preventDefault(a)):39===b?(this.o9(),w.C.preventDefault(a)):38===b?(this.q8(),w.C.preventDefault(a)):40===b&&(this.p8(),w.C.preventDefault(a))}},Ft:function(a){return function(){a()}}, t5:function(){this.get("rotateEnable")&&(this.r("rotate"),this.set("rotation",-8+parseFloat(this.get("rotation"))%360))},o9:function(){this.get("rotateEnable")&&(this.r("rotate"),this.set("rotation",8+parseFloat(this.get("rotation"))%360))},p8:function(){this.get("rotateEnable")&&this.set("pitch",-4+parseFloat(this.get("pitch")))},q8:function(){this.get("rotateEnable")&&this.set("pitch",4+parseFloat(this.get("pitch")))},zT:function(a){var b=this.J;return function(){1===a?b.zoomIn():b.zoomOut()}}, oB:function(a,b){var c=this.J;return function(){c.panBy(a,b)}}}); ')
_jsload_('vectorlayer', '(function(a){a.lL||(a.lL=function(){function a(b,c,d){for(var e=0,g=d.length;e<g;e++){var h=d.charCodeAt(e);if(128>h)b.setUint8(c++,h>>>0&127|0);else if(2048>h)b.setUint8(c++,h>>>6&31|192),b.setUint8(c++,h>>>0&63|128);else if(65536>h)b.setUint8(c++,h>>>12&15|224),b.setUint8(c++,h>>>6&63|128),b.setUint8(c++,h>>>0&63|128);else if(1114112>h)b.setUint8(c++,h>>>18&7|240),b.setUint8(c++,h>>>12&63|128),b.setUint8(c++,h>>>6&63|128),b.setUint8(c++,h>>>0&63|128);else throw Error("bad codepoint "+h);}}function c(a, b,c){var d="",e=b;for(b+=c;e<b;e++)if(c=a.getUint8(e),0===(c&128))d+=String.fromCharCode(c);else if(192===(c&224))d+=String.fromCharCode((c&15)<<6|a.getUint8(++e)&63);else if(224===(c&240))d+=String.fromCharCode((c&15)<<12|(a.getUint8(++e)&63)<<6|(a.getUint8(++e)&63)<<0);else if(240===(c&248))d+=String.fromCharCode((c&7)<<18|(a.getUint8(++e)&63)<<12|(a.getUint8(++e)&63)<<6|(a.getUint8(++e)&63)<<0);else throw Error("Invalid byte "+c.toString(16));return d}function d(a){for(var b=0,c=0,d=a.length;c< d;c++){var e=a.charCodeAt(c);if(128>e)b+=1;else if(2048>e)b+=2;else if(65536>e)b+=3;else if(1114112>e)b+=4;else throw Error("bad codepoint "+e);}return b}function e(a,b){this.offset=b||0;this.view=a}function g(c,e,h){var k=typeof c;if("string"===k){var q=d(c);if(32>q)return e.setUint8(h,q|160),a(e,h+1,c),1+q;if(256>q)return e.setUint8(h,217),e.setUint8(h+1,q),a(e,h+2,c),2+q;if(65536>q)return e.setUint8(h,218),e.setUint16(h+1,q),a(e,h+3,c),3+q;if(4294967296>q)return e.setUint8(h,219),e.setUint32(h+ 1,q),a(e,h+5,c),5+q}if(c instanceof ArrayBuffer){q=c.byteLength;if(256>q)return e.setUint8(h,196),e.setUint8(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+2),2+q;if(65536>q)return e.setUint8(h,197),e.setUint16(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+3),3+q;if(4294967296>q)return e.setUint8(h,198),e.setUint32(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+5),5+q}if("number"===k){if(c<<0!==c)return e.setUint8(h,203),e.setFloat64(h+1,c),9;if(0<=c){if(128>c)return e.setUint8(h, c),1;if(256>c)return e.setUint8(h,204),e.setUint8(h+1,c),2;if(65536>c)return e.setUint8(h,205),e.setUint16(h+1,c),3;if(4294967296>c)return e.setUint8(h,206),e.setUint32(h+1,c),5;throw Error("Number too big 0x"+c.toString(16));}if(-32<=c)return e.setInt8(h,c),1;if(-128<=c)return e.setUint8(h,208),e.setInt8(h+1,c),2;if(-32768<=c)return e.setUint8(h,209),e.setInt16(h+1,c),3;if(-2147483648<=c)return e.setUint8(h,210),e.setInt32(h+1,c),5;throw Error("Number too small -0x"+(-c).toString(16).substr(1)); }if("undefined"===k)return e.setUint8(h,212),e.setUint8(h+1,0),e.setUint8(h+2,0),3;if(null===c)return e.setUint8(h,192),1;if("boolean"===k)return e.setUint8(h,c?195:194),1;if("object"===k){var k=0,s=Array.isArray(c),r=null;s?q=c.length:(r=Object.keys(c),q=r.length);16>q?(e.setUint8(h,q|(s?144:128)),k=1):65536>q?(e.setUint8(h,s?220:222),e.setUint16(h+1,q),k=3):4294967296>q&&(e.setUint8(h,s?221:223),e.setUint32(h+1,q),k=5);if(s)for(s=0;s<q;s++)k+=g(c[s],e,h+k);else for(s=0;s<q;s++)var u=r[s],k=k+g(u, e,h+k),k=k+g(c[u],e,h+k);return k}throw Error("Unknown type "+k);}function h(a){var b=typeof a;if("string"===b){var c=d(a);if(32>c)return 1+c;if(256>c)return 2+c;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if(a instanceof ArrayBuffer){c=a.byteLength;if(256>c)return 2+c;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if("number"===b){if(a<<0!==a)return 9;if(0<=a){if(128>a)return 1;if(256>a)return 2;if(65536>a)return 3;if(4294967296>a)return 5;if(1.8446744073709552E19>a)return 9;throw Error("Number too big 0x"+ a.toString(16));}if(-32<=a)return 1;if(-128<=a)return 2;if(-32768<=a)return 3;if(-2147483648<=a)return 5;if(-9223372036854775E3<=a)return 9;throw Error("Number too small -0x"+a.toString(16).substr(1));}if("undefined"===b)return 3;if("boolean"===b||null===a)return 1;if("object"===b){b=0;if(Array.isArray(a))for(var c=a.length,e=0;e<c;e++)b+=h(a[e]);else for(var g=Object.keys(a),c=g.length,e=0;e<c;e++)var k=g[e],b=b+(h(k)+h(a[k]));if(16>c)return 1+b;if(65536>c)return 3+b;if(4294967296>c)return 5+b;throw Error("Array or object too long 0x"+ c.toString(16));}throw Error("Unknown type "+b);}var k={};k.Roa=a;k.Qoa=c;k.Poa=d;e.prototype.map=function(a){for(var b={},c=0;c<a;c++){var d=this.parse();b[d]=this.parse()}return b};e.prototype.FI=function(a){var b=new ArrayBuffer(a);(new Uint8Array(b)).set(new Uint8Array(this.view.buffer,this.offset,a),0);this.offset+=a;return b};e.prototype.yE=function(a){var b=c(this.view,this.offset,a);this.offset+=a;return b};e.prototype.vI=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=this.parse();return b}; e.prototype.parse=function(){var a=this.view.getUint8(this.offset);if(160===(a&224))return this.offset++,this.yE(a&31);if(128===(a&240))return this.offset++,this.map(a&15);if(144===(a&240))return this.offset++,this.vI(a&15);if(0===(a&128))return this.offset++,a;if(224===(a&224))return a=this.view.getInt8(this.offset),this.offset++,a;if(212===a&&0===this.view.getUint8(this.offset+1))this.offset+=3;else{switch(a){case 217:return a=this.view.getUint8(this.offset+1),this.offset+=2,this.yE(a);case 218:return a= this.view.getUint16(this.offset+1),this.offset+=3,this.yE(a);case 219:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.yE(a);case 196:return a=this.view.getUint8(this.offset+1),this.offset+=2,this.FI(a);case 197:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.FI(a);case 198:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.FI(a);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 204:return a=this.view.getUint8(this.offset+ 1),this.offset+=2,a;case 205:return a=this.view.getUint16(this.offset+1),this.offset+=3,a;case 206:return a=this.view.getUint32(this.offset+1),this.offset+=5,a;case 207:var a=this.view.getUint32(this.offset+1),b=this.view.getUint32(this.offset+5);this.offset+=9;return 4294967296*a+b;case 208:return a=this.view.getInt8(this.offset+1),this.offset+=2,a;case 209:return a=this.view.getInt16(this.offset+1),this.offset+=3,a;case 210:return a=this.view.getInt32(this.offset+1),this.offset+=5,a;case 211:return a= this.view.getInt32(this.offset+1),b=this.view.getUint32(this.offset+5),this.offset+=9,4294967296*a+b;case 222:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.map(a);case 223:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.map(a);case 220:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.vI(a);case 221:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.vI(a);case 202:return a=this.view.getFloat32(this.offset+1),this.offset+=5,a;case 203:return a= this.view.getFloat64(this.offset+1),this.offset+=9,a}throw Error("Unknown type 0x"+a.toString(16));}};k.Pj=function(a){var b=new DataView(a),b=new e(b),c=b.parse();if(b.offset!==a.byteLength)throw Error(a.byteLength-b.offset+" trailing bytes");return c};k.BJ=function(a){var b=new ArrayBuffer(h(a)),c=new DataView(b);g(a,c,0);return b};return{TU:function(a,b){b(null,{pu:a.pu,Wc:a.Wc,Ba:k.BJ(a.Ba)})},EU:function(a,b){b(null,{pu:a.pu,Wc:a.Wc,Ba:k.Pj(a.Ba)})}}},a.zu=a.l.vn?new a.Os(a.lL,{hostWorker:a.fD, clientId:"msg",lazy:"untilCall"}):new a.Os(function(){},{hostWorker:a.fD,clientId:"msg",lazy:"untilCall"}))})(w);!w.rF&&w.l.vn&&(w.rF=function(){function a(a,b){return a.bind?a.bind(b):function(){a.apply(b,arguments)}}function b(){v="unsupport";p.length=0;c();this.r("disable")}function c(){r&&(clearTimeout(r.Oaa),r.onopen=r.onmessage=r.onerror=null,3!==r.readyState&&r.close(),r=null)}function d(){B=!0;this.flush();this.r("open")}function e(){B?(v="closed",c()):b.call(this)}function g(a,b){if("unsupport"===v)return!1;"connected"===v?h.call(this,a):("closed"===v&&this.Naa(),p.push({data:a,jz:b}));x+=1}function h(a){var c= this;r.readyState===WebSocket.OPEN&&(r.send(a),t&&clearTimeout(t),t=setTimeout(function(){b.call(c);t=null},5E3),y&&clearTimeout(y),y=setTimeout(function(){c.close();y=null},1E4))}var k=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,l={},m="undefined"===typeof window||!k,n=null,p=[],q=[],s=+new Date,r=null,u=1,v="closed",x=0,t=null,y=null,B=!1;m||(l.Dea=function(){if(q.length){var a=w.A.Rb+"://webapi.amap.com/count?",b=["type=v","k="+w.A.key,"u="+w.A.Sm,"m="+(w.l.Y?1:0),"pf="+w.l.Pr,"frq="+ q.join(",")];new w.Sa.fb(a+b.join("&"))}},w.extend(l,w.ka),w.event.V(window,"beforeunload",l.Dea,l));l.tfa=function(a){if("encode"===a.Wc)g.call(this,a.Ba);else if("decode"===a.Wc)if(a=a.Ba,"ack"===a.type)switch(a.command){case "tiles":this.r("ack",a);break;case "retain":v="connected";this.flush();break;case "close":b.call(this)}else 0===a.content.errcode&&("tiles"===a.type?this.r("tiles",a):"traffic"===a.type&&this.r("traffic",a))};l.Jha=function(a){x=a};l.ir=function(){return x};l.close=function(){r&& (v="closed",r.close())};l.Naa=function(){var c=this;"closed"===v&&(null===n&&(n=m?this.A.yN+"://"+this.A.vv:w.A.yN+"://"+w.A.vv),r=new WebSocket(n),r.binaryType="arraybuffer",v="connecting",r.onopen=a(d,this),r.onclose=a(e,this),r.onerror=a(b,this),r.ontimeout=a(b,this),r.onmessage=a(this.ufa,this),r.Oaa=setTimeout(function(){r.readyState!==WebSocket.OPEN&&b.call(c)},1200))};l.wy=function(){return"connected"===v};l.Rda=function(){return"closed"===v};l.flush=function(){if("connected"===v){for(var a= 0,b=p.length;a<b;a++)h.call(this,p[a].data);p.length=0}};l.SK=function(){return"unsupport"!==v};l.send=function(a){var b=this,c=u++;a={Wc:"encode",Ba:a,pu:s};var d=this.TU;m||(d=w.zu.TU);d(a,function(a,d){a||g.call(b,d.Ba,c)});return c};l.QU=function(a){for(var b=0,c=p.length;b<c;b++)if(p[b].jz===a)return p.splice(b,1),!0;return!1};l.p$=function(a){q.push(a)};l.ufa=function(a){var b=this;t&&(clearTimeout(t),t=null);var c=this.EU,d=self.vx;m||(c=w.zu.EU,d=w.zu.vx);d([a.data]);c({pu:s,Wc:"decode",Ba:a.data}, function(a,c){a||b.tfa(c)})};return l});w.Mh={ZZ:function(){0===w.Da.be&&w.Mh.aW()},Ooa:function(a,b){if(!a)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]&&a[c].Tn===b)return!0},raa:function(a,b){var c="limg-"+a.key+"-"+b.q.Ac;w.Da[c]&&delete w.Da[c]},mV:function(a){return w.Da[a.Tn?a.Tn:a]},$k:function(a){var b=null,c=null,d=!1;a.Tn?(b=a,c=b.Tn,(a=b.url)&&(d=!0)):c=a;var e=w.Da[c];d&&e&&e.src!==a&&(e=w.Da[c]=null);if(!e&&a){d="data:"===a.substr(0,5);e=document.createElement("img");d||(e.crossOrigin="Anonymous");w.Da[c]=e;e.loaded=!1; w.Da.be+=1;w.C.h(e,"load",this.jD,this);w.C.h(e,"error",this.$V,this);var g=this;e.iv=setTimeout(function(){e.loaded||g.aW()},300);e.src=a;b&&(e.jla=c,b.url=null)}},aW:function(){for(var a=0;a<w.Da.Np.length;a+=1)w.Da.Np[a].set("display")},jU:function(a){w.C.I(a,"load",this.jD,this);w.C.I(a,"error",this.$V,this)},jD:function(a){a=a.target;a.loaded=!0;w.Da.be-=1;this.jU(a);this.ZZ();a.iv&&(clearTimeout(a.iv),a.iv=null)},$V:function(a){a=a.target;a.loaded=!1;w.Da.be-=1;this.jU(a);this.ZZ();a.iv&&(clearTimeout(a.iv), a.iv=null)}};w.w.vk=w.w.qc.extend({B:function(a,b,c){this.bC=c;w.Da.Np.push(this);this.Ac=w.a.wV("layer");this.kb=2;a.get("textRatio");this.MN=25;this.X("tiles",a);this.yja=a.get("vdataUrl")||b.J.get("vdataUrl")||w.A.vv;this.ji=!0;this.fa=a;this.tj=w.l.Y?!1:!0;this.g=b;this.ai=this.$h=!0;this.he("zoom center centerCoords resolution coordsBound styleID iconsID businessIconsID forceBig mode display".split(" "),b);this.he("zooms detectRetina visible merge sort zIndex textIndex watermark opacity".split(" "),a);this.X("lang", b,!0);this.get("watermark")&&(this.xv=new Image,this.xv.src=this.get("watermark"));this.Soa="v4";this.wa={};this.fi={};this.ee=256;this.Ir=[];this.Ge=this.df=0;this.ja=w.l.ja&&this.get("detectRetina");this.ee=256*(this.ja?2:1);this.X("mapStyle",b);this.X("style",b);this.dn=0;this.X("features",b);this.De=18;this.X("reload",a)},mapStyleChanged:function(){this.get("mapStyle");this.td=!1;if(this.g.get("styleUrl")||"normal"===this.get("mapStyle"))this.td=!!this.g.get("showBuildingBlock");this.featuresChanged()}, featuresChanged:function(){this.set("reload")},langChanged:function(){this.set("reload");this.fa.up()},Q9:function(){var a=!1,b=this.iQ();if(b){if(this.qh){var c="active"===this.qh.ww;b.aw(this.qh);c&&(b.hq(this.qh,"active"),a=!0)}w.l.maa&&!a&&b.NB()}},Vv:function(){this.Q9()},Az:function(a,b){var c=!0;if("hotspotout"===a)this.g.J.set("optimalCursor",null);else if("hotspotover"===a)this.g.J.set("optimalCursor","pointer");else if("mouseup"===a||"mousedown"===a)c=!1;var d=this.iQ();if(d)switch(a){case "hotspotout":d.SB(b); break;case "hotspotover":d.hq(b,"hover");break;case "mouseup":d.hq(b,"hoverup");break;case "mousedown":d.hq(b,"active")}c&&(c=b.Oa,c=new w.G(c[0],c[1]),c=this.g.qe(c,3),this.g.J.r(a,{name:b.name,lnglat:c,id:b.gl,isIndoorPOI:b.PK}))},iQ:function(){if(!w.l.iW){var a=this.Q||this.pm;if(!a)return null;var b=this.g?this.g.J.get("hotspotOptions"):{},b=w.extend({},b);if(b.disableHighlight)return null;this.gx||(this.gx=new w.w.vk.I0(a));return this.gx}},jo:function(a){(a=this.FV(a))&&this.Az("hotspotclick", a)},rt:function(a){var b="mousemove"===a.type;if(!this.g.Vf||!b){var c=this.FV(a);switch(a.type){case "mousemove":case "mouseup":case "mousedown":c&&this.qh!==c&&(this.qh&&this.Az("hotspotout",this.qh),this.Az("hotspotover",c)),!c&&this.qh&&this.Az("hotspotout",this.qh),c&&!b&&this.Az(a.type,c)}this.qh=c}},textIndexChanged:function(){this.set("display")},yfa:function(){this.g.h("click",this.jo,this);this.g.h("mousemove",this.rt,this);this.g.h("mousedown",this.rt,this);this.g.h("mouseup",this.rt,this)}, YI:function(){this.g.I("click",this.jo,this);this.g.I("mousemove",this.rt,this);this.g.I("mousedown",this.rt,this);this.g.I("mouseup",this.rt,this)},Tl:function(){return null},mn:function(){var a=this.yr?null:this.g.J.get("forceZooms");return{ji:!0,ee:256,visible:this.get("visible"),gd:a||this.get("zooms"),kC:this.tj&&this.ta,$h:!this.g.FE,ai:!this.g.FE,opacity:this.get("opacity"),qd:!1}},Jl:function(a){if(w.Q.canvas.vk)return new w.Q.canvas.vk(this,a)},Cx:function(a){0===a.indexOf("amap://styles/")&& (a="normal");var b=this.get("forceBig")||w.l.Y&&!this.ja?"6":"5";this.url=w.A.Rb+"://"+this.yja+"/tiles?mapType="+a+"&v="+(w.Lc?3:2)+"&style="+b;this.url+=this.ja?"&rd=2":"&rd=1";this.url+="&flds="+this.xa;this.url+="&t="},styleChanged:function(){this.g.ec||this.featuresChanged()}}); w.w.Yc=w.w.vk.extend({Jl:function(a){var b=this;if(!b.xv&&w.l.Je&&"vw"===b.g.get("baseRender")){var c=["wgl"];this.g.ec&&c.push("wgl2");if(w.hb.yy(c))return new w.Q.uf.Yc(b,a)}else if(c=["cmng","cgl"],this.g.ec&&c.push("cgl2"),w.hb.yy(c))return new w.Q.canvas.Yc(b,a);w.hb.eg(c,function(){b.set("display")})},featuresChanged:function(){var a=this.get("features"),b=[];"all"===a?b=this.bC:a&&(-1!==w.a.indexOf(a,"bg")&&-1!==w.a.indexOf(this.bC,"region")&&b.push("region"),-1!==w.a.indexOf(a,"building")&& -1!==w.a.indexOf(this.bC,"building")&&b.push("building"),-1!==w.a.indexOf(a,"road")&&-1!==w.a.indexOf(this.bC,"road")&&b.push("road"));this.xa=b;this.Cx(this.get("mapStyle")||"normal");this.set("reload")}});w.w.T0=w.w.Yc.extend({B:function(){this.kl(arguments);this.De=this.hm=17;this.xa=["building"];this.td=!0;this.Cx(this.get("mapStyle")||"normal");this.yr=!0},featuresChanged:function(){},mapStyleChanged:function(){}}); w.w.Wh=w.w.vk.extend({Jl:function(a){var b=this;if(this.FK()){if(this.rv=!0,w.Q.canvas.uF)return this.XT(),a=new w.Q.canvas.uF(this,a),a.h("afterLabelRender",this.Vv,this),a}else{b.rv=!1;if(w.Q.canvas.tF)return a=new w.Q.canvas.tF(this,a),a.h("afterLabelRender",this.Vv,this),a;a=["cmng","labelcanvas"];w.l.vJ&&a.push("labelDir");w.hb.eg(a,function(){b.set("display")})}},FK:function(){var a=this.get("mapStyle");return"normal"!==a&&"amap://styles/normal"!==a||this.g.get("nolimg")?!1:w.l.rv?!0:!1},Ada:function(){var a= this.get("mapStyle");return"normal"!==a&&"amap://styles/normal"!==a||this.g.get("nolimg")||w.l.qd||w.l.Y?!1:!0},featuresChanged:function(){var a=this.get("features"),b=this.get("mapStyle"),c=[];"all"===a?c=["roadlabel","poilabel"]:a&&(-1!==w.a.indexOf(a,"road")&&c.push("roadlabel"),-1!==w.a.indexOf(a,"point")&&c.push("poilabel"));a=this.FK();c.length&&(a||this.Ada())&&c.unshift("limg");this.xa=c;this.Cx(b);this.set("reload");(b=this.Q||this.pm)&&a^this.rv&&(this.gx&&(this.gx=this.gx.Q=null),b.I("afterLabelRender", this.Vv,this),b.Vt(),this.pm=this.Q=null)},XT:function(){this.Cr=w.A.Rb+"://"+(this.fa.get("vdataUrl")||this.g.J.get("vdataUrl")||w.A.vv)+"/limg?";var a=this.ja?2:1;this.Cr+="&font="+(w.l.Y&&!this.ja?"big":"small");this.Cr+="&scl="+a;this.Cr+="&t="},FV:function(a){return a.tf?(a=this.sV(this.g.bc(a.tf,20),!0))?a[0]:null:null},sV:function(a,b){var c=this.g.XC();if(c&&(c=c.nr(this)))return c.eu(a,b)}});w.w.vk.I0=w.aa.extend({B:function(a){this.w9(a)},w9:function(a){this.Q=a},SB:function(a){if(a.ww){a.ww=!1;var b=this.Q;b&&b.SB.apply(b,arguments)}},aw:function(a){a.ww=!1;var b=this.Q;b&&b.aw.apply(b,arguments)},hq:function(a,b){b||(console.warn("hlStyle is required, e.g. hover, active.."),b="hover");if(a.ww!==b){a.ww=b;var c=this.Q;c&&c.hq.apply(c,arguments)}},NB:function(){var a=this.Q;a&&a.NB()}});w.Ls={Ax:function(a,b){this.zf={};this.zf.pu=w.a.Jb(this.zf);b.Ic||(b.Ic=w.rF());this.Ic=b.Ic;this.Ic.h("tiles",this.RD,this);this.Ic.h("ack",this.QD,this);this.Ic.h("disable",this.PD,this)},xT:function(){if(this.eh&&!this.ak&&w.Uh.Bja||this.ak&&w.Uh.hea||!this.ak&&!this.eh&&this.ji&&w.kf.Eda)return!0},Yw:function(a){this.Cf=w.a.Ut(this.Cf,a)},qo:function(){return w.a.keys(this.Af).length?!0:!1},aB:function(a){w.a.Pb(a,function(a){w.Mh.$k(a)})},fA:function(){for(var a=this.Cf.length-1;0<=a;a--){var b= this.Cf[a];b.aq||b.abort()}this.Cf.splice(0,this.Cf.length)},Fu:function(a){if(this.q&&a.XK===this.q.Ac){this.Se||this.If?this.MH([this.q,"groupcomplete",null,null,"allbase"]):(this.Ri(),this.wq.AC(this.q,"groupcomplete",null,null,"allbase"));for(var b=0,c=a.Uc.length;b<c;b+=1)this.Qy(a.Uc[b],a.uu,a.Vu,a.Y)}},Qy:function(a,b){var c=a.Wc,d=this.wa.get(a.ll);if(d){var e=this.q.xa;d.xa||(d.Ga={},d.xa=[]);var g="";(this.g.jk&&!this.g.ec||this.Nda&&this.g.ec)&&this.KJ(c,a.Ba);"poilabel"===c||"roadlabel"=== c?(a.Qd||(g=a.Ba,a.Qd=null),d.xa.push.apply(d.xa,a.Ba),c===this.q.xa[this.q.xa.length-1]&&(d.Qd=null)):d.Ga[c]=a.Ba;"building"!==c&&"poilabel"!==c||!a.Xk||d.Te||(d.Te={},d.Te.je=a.Xk,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:d}));if("roadlabel"!==c&&"poilabel"!==c||this.sW||!w.l.vJ&&!this.g.ec)this.Se||this.If?this.MH([this.q,g,d,b,c]):(this.Ri(),this.wq.AC(this.q,g,d,b,c));c===e[e.length-1]&&(c="roadlabel"===c||"poilabel"===c?"labels":"allbase",this.Se||this.If?this.MH([this.q,"tileComplete",d, b,c]):(this.Ri(),this.wq.AC(this.q,"tileComplete",d,b,c)))}},nA:function(){if(this.g){var a=this.g.J.getMapStyle();this.jp=a;this.i5(a);this.Ic&&this.Ic.SK()&&(-1!==a.indexOf("amap://styles")&&(a="normal"),a={command:"status",payload:{mapType:a,style:w.l.Y&&!this.q.ja?"6":"5",rd:this.q.ja?2:1}},this.g.J.get("workerMode")&&this.xT()?(w.kf.caa(a,w.a.pp),this.Ic.Rda()||this.Ic.close()):this.Ic.send(a))}},mapStyleChanged:function(){this.nA()},styleChanged:function(){this.nA()},PD:function(){for(var a in this.zf)this.zf.hasOwnProperty(a)&& this.zf[a].Nb&&(this.yk(this.zf[a].Nb,this.zf[a].nc),delete this.zf[a],delete this.Af[a]);this.Ic=null;this.mj("mapStyle");this.set("display",1)},QD:function(a){var b=a.reqId;this.zf[b]&&(!a.content.status&&this.zf[b]&&this.yk(this.zf[b].Nb,this.zf[b].nc),delete this.zf[b],delete this.Af[b])},RD:function(a){var b=a.reqId;if((!/-1$/.test(b)||!this.qo())&&this.zf[b]){var c=a.content.opt,d=this.zf[b].Nb[0];c!==this.Ta&&!d.xg||d.xg&&2<(this.qo()||Math.abs(c-this.Ta))?this.yk(this.zf[b].Nb,this.zf[b].nc): this.Lr(a.content.data,c)}},sI:function(a,b){var c=a.ze,d=null;!this.bg&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&18>=c.nc&&(b?d={Qd:!0,data:a.cba,url:this.kn(a.nc,[]),w:this.q,"x-vd-v":c.Ed,tv:c.rf,bgc:this.g.vd,vdataVersion:c.Ud,td:this.g.J.get("showBuildingBlock")}:this.ME||(d={Uc:a.data.Uc,"x-vd-v":c.Ed,tv:c.rf,bgc:this.g.vd,vdataVersion:c.Ud,Je:!!this.bg,url:this.kn(a.nc,[]),w:this.q,td:this.g.J.get("showBuildingBlock")}));d&&w.ym.set(d)},cL:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]? arguments[2]:!1;if(a.length)if(this.wY)this.tX=!0;else{void 0===this.Cf&&(this.Cf=[]);c||this.fA();void 0===this.Af&&(this.Af={});var d=1,e=[],g=this;18<b&&(d=Math.pow(2,b-18));for(var h=Math.pow(2,20-a[0].ma.z),k=0;k<a.length;k+=1){var l=a[k],m=l.ma;l.nc=b;m.S=h;if(18<b&&!this.bg){for(var n=0;n<d;n+=1)for(var p=0;p<d;p+=1){var q=new w.Xa(new w.uk(b,d*m.x+n,d*m.y+p));this.wa.Fc(q.key)||(this.wa.set(q.key,q),q.status="loading")}this.wa.set(l.key+"/"+b,l)}else this.wa.set(l.key,l),this.bg&&10>m.z&& this.jV(l)?this.set("display",0):l.status="loading"}this.B8(a,b,w.a.bind(function(a,d){var g=this;if(d.length){for(var h=0,k=d.length;h<k;h++){var l=d[h].ma,m=l.x,n=l.y,l=l.z;if(10>l){var p=Math.pow(2,l);if(m>=p||0>m)m=(m+p)%p}m=w.a.LC(m,n,l).join(",");w.a.ga(e,m)||e.push(m)}h=this.I3({Fia:d,xg:c,nc:b,$M:e});if(this.g.J.get("workerMode")&&this.xT())if(this.eh)w.Uh.aj(h,function(a,c){null!==c.data&&g.g&&(void 0===w.Uh.Wv&&(w.Uh.Wv=!0),c.GW?g.yk(c.Nb,b):(c.bk&&g.EB(),g.ak?(w.a.Pb(c.Nb,function(a){this.wa.set(a.key, a);a.Qd&&!a.Qd.loaded&&(w.Mh.$k(a.Qd,!0),a.Qd.loaded=!0);a.M&&a.M.Da&&this.aB(a.M.Da);a.Te&&a.Te.je&&w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:a})},g),g.set("display"),g.sI(c,!0)):(w.a.Pb(c.Nb,function(a){var b=this.wa.get(a.key);b&&(b.status=a.status,a.M&&a.M.Da&&this.aB(a.M.Da))},g),g.sI(c),c.data&&g.Fu(c.data))))});else{var q=w.kf.aX;if(!this.g.J.ta||w.kf.rba)q=w.kf.aj;this.nA();q(h,function(a,c){if(g.g){void 0===w.kf.Wv&&(w.kf.Wv=!0);c.GW&&g.yk(c.Nb,b);if(q===w.kf.aX){if(c.disabled){w.kf.rba= !0;g.set("display");return}if(c.d$)return}c.bk&&g.EB();c.data&&(g.g.vd!==c.Mq&&(g.g.vd=c.Mq),w.a.Pb(c.Nb,function(a){var b=this.wa.get(a.key);b&&(b.status=a.status,a.M&&a.M.Da&&this.aB(a.M.Da))},g),g.aB(c.icons),g.sI(c),c.data&&g.Fu(c.data))}})}else!this.eh&&this.Ic&&this.Ic.SK()?this.g.J.get("workerMode")?this.bB(d,b,e,c):(1>this.Ic.ir()||3<this.Bq?this.bB(d,b,e,c):((2===this.Ic.ir()||this.Ic.wy())&&this.nA(),this.A5(d,b,e,c)),this.Ic.Jha(this.Ic.ir()+1),this.Ic.TW&&this.Ic.p$(Math.ceil((new Date- this.Ic.TW)/1E3)),this.Ic.TW=new Date):this.bB(d,b,e,c)}},this));window.renderDelay&&(this.wY=setTimeout(function(){g.tX&&g.set("display",!1);g.tX=!1;g.wY=null},window.renderDelay))}},i5:function(a){a&&"normal"!==a&&0!==a.indexOf("amap://styles/")?this.ME=!0:this.ME=!1},B8:function(a,b,c){if(!this.bg&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&(this.ak||!this.ME)&&18>=b){var d=w.ym,e=this,g=this.g,h=g.J;g.Ey||void 0!==g.AD||("dv"===h.get("baseRender")?g.AD=1:g.AD=2);d.get({type:h.ta?"NFS":"FS",td:this.q.yr|| this.q.td,Bia:a,Je:!!this.bg,w:this.q,url:this.kn(b,[]),timeout:500},function(d,h){if(e.q){if(!d&&h.DK.length){h.DK.length===a.length&&(g.Ey||g.AD--,e.EB());if(h.Uc){e.Ed=h.ze["x-vd-v"];e.rf=h.ze.tv;var m=h.ze.bgc;e.g.vd!==m&&(e.g.vd=m);h.DK.forEach(function(a){a.status="loaded"});m=e.EG(b,h.Uc);e.Fu(m)}else h.iea.forEach(function(a){e.Du(a,b,[],h.ze["x-vd-v"],!0)}),e.set("display");a=h.Oea}c(null,a)}})}else c(null,a)},A5:function(a,b,c,d){if(!d||!this.qo()){var e=[(new Date).getTime(),this.Ic.ir()+ 1&65535,d?1:0].join("-");d||(this.Af[e]=1);var g={command:"tiles",reqId:e,payload:{t:c,opt:b,cs:{level:b,flds:this.q.xa.join(","),v:w.Lc?"3":"2"}}},h;if(!this.Ic.wy()){var k=this;setTimeout(function(){k.Ic&&!k.Ic.wy()&&(k.Bq?k.Bq++:k.Bq=1,k.Ic.QU(h)&&(delete k.zf[e],delete k.Af[e],k.bB(a,b,c,d)))},300)}h=this.Ic.send(g);this.zf[e]={Nb:a,nc:b}}},wL:function(a){if(!a.ta||a.xg)a.status="",a.ta=void 0,a.qa=null,a.tc=null,a.Jc&&(a.Jc.tc=null,a.Jc.Jc=null,a.Jc=null),this.wa.Sn(a.key)},I3:function(a){var b= a.Fia,c=a.nc,d=a.$M;a=a.xg;var e=+new Date,g=this.eh&&w.Uh&&!w.Uh.Wv||!this.eh&&w.kf&&!w.kf.Wv;return{Ac:e,Mq:this.g.vd,eh:this.eh,ak:this.ak,td:this.q.td,Oda:!!w.Lc,Je:this.bg,WK:this.q.Ac,xa:this.q.xa,qd:this.q.ja,kb:this.q.kb,sK:Math.ceil(this.Mf.gD),Nb:w.a.filter(b,function(a){return"loaded"!==a.status}),nc:c,$M:d,xg:a,url:this.kn(c,d,b)+"&_id="+e,de:this.EG(c,[],g)}},EG:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;w.Lc&&1<w.Lc.length&&(w.Lc=w.Lc[this.q.get("forceBig")|| w.l.Y&&!this.q.ja?1:0]);var d=w.Lc||null,e={Mda:"3D"===this.q.g.J.view.type,Y$:this.q.td,pC:w.A.pC||null,wla:this.q.get("businessIconsID"),Ed:this.Ed,rf:this.rf,Mma:this.q.get("iconsID"),XK:this.q.Ac,uu:a,mu:this.q.mu,Ky:this.q.fa.get("merge"),Uc:b,Y:this.q.get("forceBig")||w.l.Y,mode:this.q.get("mode"),vga:w.A.Rb,KY:this.q.get("forceBig")?1:this.q.kb,Vu:this.q.get("forceBig")?!1:this.q.ja};c&&(e.Lc=d);return e},gw:function(a){a=a.split(";");for(var b=0,c=a.length;b<c;b+=1){a[b]=a[b].split(",");for(var d= 0,e=a[b].length;d<e;d+=1)a[b][d]=parseInt(a[b][d],36)}return a},Lr:function(a,b,c){if(this.q){for(var d=[],e=0,g=a.length;e<g;e+=1){var h=a[e];h&&(c&&(h=JSON.parse(h)),h["x-vd-v"]?(this.Ed=h["x-vd-v"],this.rf=h.tv,this.Ud=[h.tv,h.vdv].join("-"),h.bgc&&(h="#"+h.bgc.substring(2),this.g.vd!==h&&(this.g.vd=h))):this.Du(h,b,d))}if(d.length){var k=this;a=null;var l;this.bg?(a=w.WE,l=a.RX):(a=w.zu,l=this.eh?a["label:parseLabel"]:a["base:parseDataToVector"]);(function(){l(k.EG(b,d),function(a,c){if(k.q&& !a){var d=c.icons;if(d)for(var e=0;e<d.length;e+=1)w.Mh.$k(d[e]);!this.bg&&(w.l.gf||w.l.bj&&!k.g.J.ta)&&(k.ak||!k.ME)&&18>=b&&w.ym.set({Uc:c.data.Uc,"x-vd-v":k.Ed,tv:k.rf,bgc:k.g.vd,Ud:k.Ud,Je:!!k.bg,url:k.kn(10,[]),w:k.q,td:k.q.td},function(){});c.data&&k.Fu(c.data)}})})()}}},Du:function(a,b,c){function d(d,e,g){e=[g,d,e].join("/");18<b&&!l.bg&&(e+="/"+b);if((d=l.wa.get(e))&&"loaded"!==d.status)if(l.PZ(d,p)||d.xg){if(-1!==n.indexOf(m))if("limg"===m){if(e=a[1],d.Qd=e,"string"===typeof e.b&&(e.b=l.gw(e.b)), g="",g="object"===typeof e.u?e.u.url:e.u)d={url:g,Tn:"limg-"+d.key+"-"+l.q.Ac},e.u=d,w.Mh.$k(d,!0)}else{e={ti:d.ma,ll:e,Ba:a,Wc:m,mu:l.q.mu,EI:l.g.vd,NK:"building"===m,dh:"poilabel"===m||"roadlabel"===m||"building"===m&&l.q.td};if("poilabel"===m||"roadlabel"===m)e.Qd=d.Qd;m===n[n.length-1]&&(d.status="loaded");c.push(e)}}else l.yM(b,d,p,w.a.bind(l.wL,l)),18<b&&l.wa.Sn(e)}var e=a[0].split("-"),g=parseInt(e[1]),h=parseInt(e[2]),k=parseInt(e[0]),l=this,m=e[3],n=this.q.xa,p=18<b?Math.pow(2,b-18):1,e= l.Mf.gD,q=Math.pow(2,k);10>k&&(g<=e&&d(g+q,h,k),g>=q-e&&d(g-q,h,k));d(g,h,k)},MH:function(a){this.Iq||(this.Iq=[]);this.Iq.push(a)},Ri:function(){if(this.Iq&&this.Iq.length){for(var a=0,b=this.Iq.length;a<b;a+=1)this.wq.AC.apply(this.wq,this.Iq[a]);this.Iq=[]}},yk:function(a,b){for(var c=18<b?Math.pow(2,b-18):1,d=0;d<a.length;d+=1){var e=a[d];this.yM(b,e,c,w.a.bind(this.wL,this));18<b&&this.wa.Sn(e.key+"/"+b)}w.l.gf&&w.ym.Sn({Nb:a,url:this.kn(b,[]),w:this.q,Je:!!this.bg,td:this.q.td})},kn:function(a, b,c){return this.q.url+b.join(";")+"&lv="+a+"&preload="+(c&&c[0]&&c[0].xg?1:0)},j4:function(){var a=this.q.url,b="rb";if(/\\/limg/.test(a)||/flds=[^&]+label/.test(a))b="rl";return b},EB:function(){this.g.Ey||w.Yd.ue.end({key:this.j4(),index:0,id:this.g.J.id})},bB:function(a,b,c){function d(a,c){var d=a.split("|");d[0]=c+d[0];var e=d,g="";d[d.length-1]&&(g=d[d.length-1],e=d.splice(0,d.length-1));l.Lr(e,b,!0);return g}var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,g=new XMLHttpRequest; g.wp=[(new Date).getTime(),e?1:0].join("-");e||(this.Af[g.wp]=1);var h=this.kn(b,c,a),k=0,l=this;g.En="";g.onreadystatechange=function(){if(l.q&&!(2>g.readyState)){var c=4===g.readyState&&0===g.status;(b!==l.Ta&&!a[0].xg||a[0].xg&&(b>l.Ta||2<l.Ta-b)||c)&&!g.aq?(g.aq=!0,l.yk(a,b),g.onreadystatechange="",c||g.abort(),e?l.Yw(g):delete l.Af[g.wp]):g.aq||(3===g.readyState?(c=g.responseText.substring(k),g.En=d(c,g.En),k=g.responseText.length):4===g.readyState&&(l.EB(),delete l.Af[g.wp],c=g.responseText.substring(k), l.eh&&(c+="|"),d(c,g.En),g.En="",l.g.J.ta||w.Yd.ue.push({id:l.g.J.id,key:"ds",Un:g.responseText.length/2}),e&&l.Yw(g)))}};g.onerror=function(){};this.yK||(this.yK=1);g.open("GET",h,!0);g.send();e&&this.Cf.push(g)},PZ:function(a,b){var c=this.tm||this.Mf,d=a.ma.x,e=a.ma.y;return d>Math.floor(c.Sd/b)||d<Math.floor(c.pe/b)||e>Math.floor(c.yd/b)||e<Math.floor(c.zd/b)?!1:!0},yM:function(a,b,c,d){if(18<a){b=b.ma;for(var e=0;e<c;e+=1)for(var g=0;g<c;g+=1){var h=new w.uk(a,c*b.x+e,c*b.y+g)+"";(h=this.wa.get(h))&& d(h)}}else d(b),b.Jc&&d(b.Jc)}};w.Q.canvas.Wh=w.Q.zi.extend({ga:[w.Ls],B:function(a,b){arguments.callee.oa.apply(this,arguments);this.Ac=w.a.Jb(this);this.Cm=300;this.De=a.De;this.eh=this.ji=!0;this.X("mapStyle",a.g);this.X("style",a.g);this.ak=!0;this.zt=1;var c=this;this.wQ=function(){c.Yea=!0;c.set("display",0)};this.Ef();this.aL(a)},aL:function(a){a=w.l.Y||a.ja?"big":"small";var b=w.A.Rb+"://vdata.amap.com/style_icon/icon-biz-"+a+".png";w.Mh.$k(w.A.Rb+"://vdata.amap.com/style_icon/icon-normal-"+a+".png",!0);w.Mh.$k(b,!0)},hw:function(a){w.Mh.raa(a, this);var b=w.Q.canvas.Wh.rc.hw;b&&b.apply(this,arguments)},Ef:function(){this.Ck=document.createElement("canvas");this.Ck.className="amap-labels";this.Ck.draggable=!1;this.Ck.BW=!0;this.zj=this.Ck.getContext("2d",{alpha:!0});this.ny=[];this.Cy=[];this.Uo=this.q.ja?16:8},Ur:function(a){var b=Math.pow(2,a.W.zoom-this.ce),c=this.q.ja?this.q.kb:1,d=a.W.gb.Ua(this.ep).wc(this.bf);this.transform={translate:this.transform.translate.add(d.Vc(c)),scale:b/c,rotate:0};this.gb=a.W.gb},Tu:function(a,b){if(!this.ra|| 3E4<Math.abs(this.gb.x-this.ra.x)/this.S||3E4<Math.abs(this.gb.y-this.ra.y)/this.S)this.ra=this.gb;this.re=this.ce;this.qi=this.bf;this.pi=!1;this.currentTime=+new Date;this.qN=b.qN;this.Cd=[this.Aa.Lb.x,this.Aa.Lb.y];this.tj=b.kC;var c=this.lj;this.Se=this.zoom<<0!==this.zoom;var d=this.gb.Ua(this.ra);d.x<-w.a.Za/2&&(d.x+=w.a.Za);d.x>w.a.Za/2&&(d.x-=w.a.Za);this.TI=d.wc(this.bf);for(d=c.length-1;0<=d;d-=1){var e=c[d];if(e.length){var g=e[0].ma.z,h=!1;!e.rg||w.Da.be||!(g<=this.zoom&&"in"===this.Gu|| g>=this.zoom&&"out"===this.Gu)&&this.Gu||this.labels&&this.labels.length&&!a.ck&&this.$D(this.labels.hv,this.Mf)||(h=!0,this.labels&&this.labels.Zk?(this.fp=this.labels.Zk,this.fp.zoom=this.labels.zoom):(this.fp=[],this.fp.zoom=null),this.labels=[],this.labels.zoom=g,this.labels.hv=this.Mf);if(h){for(g=e.length-1;0<=g;g-=1){var k=e[g],h=!1,l=k.xa;!l&&k.Jc&&k.Jc.xa&&(l=k.Jc.xa,h=!0);if(l){for(var k=0,m=l.length;k<m;k+=1)l[k].reverse=h;Array.prototype.push.apply(this.labels,l)}}this.labels.sort(function(a, b){return a.hl>b.hl?-1:a.le>=b.le?-1:1})}}}if(this.gaa(a)){this.ld();if(!this.g.J.ta)return;this.iM(a);this.hn=this.labels}this.Yea=!1;this.Qe(a)},ld:function(){if(this.rg&&!this.q.ta){var a=this.q;w.Yd.ue.end({id:this.g.J.id,key:"rl",index:2});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.ia("complete"))}},kc:function(a,b){this.jp=a.jp;this.rk=a.rk;this.mm(a,b);this.Se||this.Ri();this.ep&&(a.UZ||a.WM&&w.l.Mj||a.If&&!a.Se&&a.L$)?this.Ur(a,b):this.Tu(a,b);this.ep=this.gb;this.pi&&this.set("display", 0)},Qe:function(a){var b=this.gb.Ua(this.ra);b.x<-w.a.Za/2&&(b.x+=w.a.Za);b.x>w.a.Za/2&&(b.x-=w.a.Za);this.transform={translate:new w.G(a.W.Aa.Vb.x*(this.q.ja?this.q.kb:1),a.W.Aa.Vb.y*(this.q.ja?this.q.kb:1)),scale:1/(this.q.ja?this.q.kb:1),rotate:0}},$D:function(a,b){return a.zd===b.zd&&a.pe===b.pe&&a.yd===b.yd&&a.Sd===b.Sd},eu:function(a,b){var c;if(this.zoom){var d=a.wc(Math.pow(2,20-this.zoom));this.labels&&(c=this.Gca(d,b))&&(c.PK=!1);!c&&this.Hb&&(c=this.Fca(d))&&(c.PK=!0)}return c?[c]:[]}, Gca:function(a,b){for(var c=a.x,d=a.y,e=this.labels.Zk||this.labels,g=e.length-1;0<=g;g-=1){var h=e[g],k=h.Oa[0]/this.S,l=h.Oa[1]/this.S;if((h.gl||!b)&&this.vW(h,c,d,k,l))return h}},Fca:function(a){var b=a.x;a=a.y;for(var c=this.Hb.length-1;0<=c;c-=1){var d=this.Hb[c],e=d.Oa[0]/this.S,g=d.Oa[1]/this.S;if(d.gl&&this.vW(d,b,a,e,g))return d}},vW:function(a,b,c,d,e){for(var g=0;g<a.wb.length;g+=1){var h=a.wb[g][2],k=a.wb[g][3],l=a.wb[g][0],m=a.wb[g][1];this.q.ja&&(h/=this.q.kb,k/=this.q.kb,l/=this.q.kb, m/=this.q.kb);if(b>=d+l-1&&b<=d+l+h+1&&c>=e+m-1&&c<=e+m+k+1)return!0}return!1},reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.labels=[];this.ny=[];this.Cy=[];this.yb&&this.yb.parentNode&&this.yb.parentNode.removeChild(this.yb);this.Ck&&this.Ck.parentNode&&this.Ck.parentNode.removeChild(this.Ck);this.set("display")},gi:function(){return this.Ck},KJ:function(a,b){if("roadlabel"===a||"poilabel"===a)for(var c=0;c<b.length;c+=1){var d=b[c];if(d.Ub){var e="",g="",h="";d.Td&&(h=d.Td[0], e=h[3],g=h[4],h=d.Yi?"":h[7]);if(e=this.T.du&&this.T.du(e,g,h,d.Ub,d.Xq))d.visible=e[4],d.ik=e[3];if(d.Td)for(g=0;g<d.Td.length;g+=1)h=d.Td[g],h[3]=e[0],h[4]=e[1],d.un&&(h[7]=e[2])}}}});w.vF={kn:function(a,b,c){return this.q.Cr+b.join(";")+"&lv="+a+"&preload="+(c&&c[0]&&c[0].xg?1:0)},Lr:function(a,b){if(this.q){for(var c=[],d=[],e=0,g=a.length;e<g;e+=1){var h=a[e];h&&(h=JSON.parse(h),h["x-vd-v"]?(this.Ed=h["x-vd-v"],this.Ud=[h.tv||"",h.vdv].join("-"),this.rf=h.tv,this.g.vd="#"+h.bgc.substring(2)):(this.Du(h,b,c,this.Ed||"v4"),d.push(h)))}d.length&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&18>=b&&w.ym.set({Qd:!0,data:d,url:this.kn(b,[]),w:this.q,vdataVersion:this.Ud,"x-vd-v":this.Ed,tv:this.rf, bgc:this.g.vd,td:this.g.J.get("showBuildingBlock")});this.set("display")}},Nu:function(a,b){var c=0,d=0,e=1,c=256*b.x,d=256*b.y,e=b.S;return[(c+a[0])*e,(d+a[1])*e]},Du:function(a,b,c,d,e){function g(c,g,l){c=[l,c,g].join("/");if(c=p.wa.get(c)){g=c.ma;var m=w.A.Rb+"://vdata.amap.com/icons/"+(h||k?"b":"n")+(10>g.z?"39":"18")+"/1/";if(c&&"loaded"!==c.status)if(p.PZ(c,r)||c.xg){if(-1!==s.indexOf(q))if("limg"===q)a[1]&&(c.Qd={url:"data:image/png;base64,"+a[1],Tn:"limg-"+c.key+"-"+p.q.Ac},w.Mh.$k(c.Qd, !0));else{if("roadlabel"===q)for(var n=1;n<a.length;n+=1){var v=a[n];v.qz=v[0];var E=w.a.qs(v[1],d);if(!(0>E[0]||256<=E[0]||0>E[1]||256<=E[1])){var A=p.Nu(E,g),E={Oa:A,name:v[0],Yi:!0,Bd:E,Da:[],wb:[],visible:!0,ik:!0},I=E.name;E.Xr=15>v[2]%90||75<v[2]%90?90*Math.floor((v[2]+15)/90):v[2];A=v[3];0<=v[8]&&(E.zB={name:v[6],KZ:v[7],dir:v[8]});var D=A[2];l=A[3];var F=-Math.floor(l/2);if(v[4])if("v5"<=d){var C=v[5].split(":"),H=C[1],H=parseInt(H)-1,C=w.A.Rb+"://vdata.amap.com/style_icon/icon-normal-"+(h|| k?"big":"small")+".png";E.Da.push(C);var C=Math.floor(H/10),K=H%10,L=0,J=0,N=0;k?(L=48,N=J=40):h?(L=J=40,N=36):(L=J=24,N=20);var M=L*Math.max(D+2,N)/N,C=[-M/2,-L/2,M,L,J*K,J*C,J,J];E.le=7;E.wb.push(C)}else{F=!1;H=parseInt(v[5]);153===H&&(0===I.indexOf("G")?(H="153g",F=!0):0===I.indexOf("S")&&(H="153s",F=!0));if(151===H||150===H)F=!1,0===I.indexOf("G")&&(H=150,F=!0),0===I.indexOf("S")&&(H=151,F=!0);152===H&&(H=151);!0===F&&(m=w.A.Rb+"://webapi.amap.com/theme/v1.3/icons/"+(h||k?"b/":"n/"));C=m+H+".png"; w.Mh.$k(C);E.Da.push(C);M=v[4][0]*u;v=v[4][1]*u;C=[-M/2,-v/2,M,v];E.wb.push(C);D=Math.min(M-3,D);l=Math.min(v,l);F=-Math.floor(l/2)+(k?3:1)}E.Da.push(c.Qd);E.le=11;E.wb.push([-Math.floor(D/2),F,D,l,A[0],A[1],A[2],A[3]]);c.xa||(c.xa=[]);c.xa.push(E)}}else if("poilabel"===q){I=[];for(n=1;n<a.length;n+=1)if(v=a[n],v.qz=v[0],E=w.a.qs(v[1],d),!(0>E[0]||256<=E[0]||0>E[1]||256<=E[1])){A=p.Nu(E,g);E={Oa:A,name:v[0].replace("^",""),un:!0,Bd:E,Da:[],wb:[],visible:!0,ik:!0};H=0;E.hl=v[8];v[6]&&("v5"<=d?(C=v[6].split(":"), H=C[1],F=Math.floor((parseInt(C[0].split("_")[1])-28)/2)):H=v[6]);if(H&&v[3]){if("v5"<=d){C=w.A.Rb+"://vdata.amap.com/style_icon/icon-"+(1===F?"biz-":"normal-")+(h||k?"big":"small")+".png";E.Da.push(C);H=parseInt(H)-1;C=Math.floor(H/10);K=H%10;k?(L=48,J=40,N=28):h?(L=J=40,N=28):(L=J=24,N=20);M=L;if(151===H||152===H||153===H)N-=4,D=v[7][0][2],M=L*Math.max(D+2,N)/N;C=[-M/2,-L/2,M,L,J*K,J*C,J,J]}else C=m+H+".png",w.Mh.$k(C),E.Da.push(C),C=[-Math.round(v[3][0]/2),-Math.round(v[3][1]/2),v[3][0],v[3][1]], k&&!e&&(C[0]*=u,C[1]*=u,C[2]*=u,C[3]*=u);E.wb.push(C)}if(v[2]&&v[7])for(D=v[2],C=0;C<v[2].length;C+=1){E.Da.push(c.Qd);A=v[7][C];k&&!e&&(D[C][0]=Math.round(D[C][0]*u),D[C][1]=Math.round(D[C][1]*u),D[C][2]=Math.round(D[C][2]*u),D[C][3]=Math.round(D[C][3]*u));M=D[C][0];K=D[C][1]-(k?4:2);L=A[3];J=A[2];M<-J&&H&&v[3]&&(M=-J+E.wb[0][0]);if("v5">d){if("375"===H||"3751"===H)J=Math.min(D[C][2],k?24:14),M=-Math.floor(J/2),K=-Math.floor(L/2)}else M-=2;E.le=L-4;4===l&&"\\u5317\\u4eac"===E.name&&(K=k?-50:-26);E.wb.push([M, K,J,A[3],A[0],A[1],A[2],A[3]])}E.Xl=v[5];E.Xl&&I.push(E.Xl);E.gl=v[4];E.im=v[9];E.iL=v[10];E.$e=H;E.vr=F;c.xa||(c.xa=[]);c.xa.push(E)}c.Te||(c.Te={},c.Te.je=I,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:c}))}q===s[s.length-1]&&(c.status="loaded",c.ta=c.qa=!0,c.Jc&&(c.Jc.ta=c.Jc.qa=!0))}}else p.yM(b,c,r,w.a.bind(p.wL,p))}}var h=w.l.Y,k=this.q.ja,l=a[0].split("-");1===l.length&&(l=a[0].split("_"));c=parseInt(l[1]);var m=parseInt(l[2]),n=parseInt(l[0]),p=this,q=l[3],s=this.q.xa,r=18<b?Math.pow(2,b-18): 1,l=Math.ceil(p.Mf.gD),u=this.q.ja?this.q.kb:1,v=Math.pow(2,n);10>n&&(c<=l&&g(c+v,m,n),c>=v-l&&g(c-v,m,n));g(c,m,n)}};w.Q.canvas.uF=w.Q.canvas.Wh.extend({ga:[w.vF]});w.Q.canvas.Wh.ob({iM:function(a){this.zt++;var b=this.Ck,c=this.zj;this.ju={};var d=this.q.ja?this.q.kb:1,e;0!==a.W.rotation?(e=2*Math.floor(a.W.Aa.Vb.x)*d,d*=2*Math.floor(a.W.Aa.Vb.y)):(e=a.size.width*d,d*=a.size.height);w.j.qm(b,e,d,!0);w.l.naa&&b.parentNode&&b.parentNode.appendChild(b);c.textBaseline="bottom";this.bW=0;a.Hb&&(this.eY(a.Hb,1,a.Hb),0===a.Hb.length&&this.labels&&this.labels.Zk&&this.labels.zoom===this.zoom&&this.labels.Zk.length!==this.labels.length&&(this.labels.Zk=null));this.labels&& this.eY(this.labels,0,a.Hb);!w.l.Y&&this.fp&&this.fp.length&&this.Eca(a);this.ny=this.ny&&this.yY(c,this.ny,480);this.Cy=this.Cy&&this.yY(c,this.Cy,200);a.Hb&&this.BY(a.Hb,c,w.oh.yV(this.g.J),this.hc,e,d);this.labels&&this.BY(this.labels,c,w.oh.yV(this.g.J),this.hc,e,d);this.fp=[];this.labels&&(this.labels.Uu=this.zoom,this.labels.Ru=this.gb,this.labels.fz=this.rotation,this.labels.DY=this.q.ja,this.labels.size=a.size);a.Hb&&(this.Hb=a.Hb);this.Hb&&(this.Hb.Uu=this.zoom,this.Hb.Ru=this.gb,this.Hb.fz= this.rotation,this.Hb.size=a.size);this.r("afterLabelRender")},zY:function(a,b,c){var d=void 0===b.ik?!0:b.ik,e=1,g=void 0===b.visible?!0:b.visible,h=null;if(b.Ub&&this.g.ec){var k=h="",l="";b.Td&&this.rJ&&(l=b.Td[0],h=l[3],k=l[4],l=b.Yi?"":l[7]);if(h=this.T.du&&this.T.du(h,k,l,b.Ub,b.Xq))g=h[4],d=h[3],e=h[5]}if(g){if(this.zj.globalAlpha!==c||e)this.zj.globalAlpha=c||e;g=0;for(k=b.Da.length;g<k;g+=1)(d||"CANVAS"===b.Da[g].tagName)&&this.Cba(a,b.Da[g],b.wb[g],b.Xr,c||e);this.zj.globalAlpha!==c&&(this.zj.globalAlpha= c);b.Td&&this.rJ&&this.rJ(a,b,h)}},Cba:function(a,b,c,d){var e=this.zj;b=this.Ql(b);if(!b)return 1;var g=c[2],h=c[3],k=c[0],l=c[1];d=(d||0)%360*-Math.PI/180;if(0!==d){var m=Math.cos(d),n=Math.sin(d),p=a[0],q=a[1];e.transform(m,n,-n,m,(1-m)*p+n*q,(1-m)*q-n*p)}k=a[0]+k;a=a[1]+l;4===c.length?b.loaded&&e.drawImage(b,k,a,g,h):e.drawImage(b,c[4],c[5],c[6],c[7],k,a,g,h);0!==d&&e.setTransform(1,0,0,1,0,0)},Ql:function(a){if(!a)return null;if("IMG"===a.tagName||"CANVAS"===a.tagName||(a=w.Mh.mV(a))&&a.loaded)return a}, bD:function(a){var b=a.Oa,c=b[0];a.reverse&&(c>w.a.Za/2?c-=w.a.Za:c<-w.a.Za/2&&(c+=w.a.Za));return this.Ho(c,b[1])},Ho:function(a,b){var c=this.q.ja?this.q.kb:1,d=this.S,e=0,g=0,e=(a-this.Cd[0])/d,g=(b-this.Cd[1])/d;return[Math.round(e*c),Math.round(g*c)]},Lca:function(a){var b=a.Oa,c=b[0];a.reverse&&(c>w.a.Za/2?c-=w.a.Za:c<w.a.Za/2&&(c+=w.a.Za));return[c/this.S,b[1]/this.S]},dea:function(a,b){var c=a.Oa;return c[0]>b.od.x||c[1]>b.od.y||c[0]<b.Lb.x||c[1]<b.Lb.y?!1:!0},Eca:function(a){var b=this.fp; if(this.fp.zoom!==this.labels.zoom)for(var c=0,d=b.length;c<d;c+=1){var e=b[c];e.un&&this.dea(e,a.W.Aa)&&(this.Cy.push(e),e.zoom=b.zoom,e.BK=new Date)}},eY:function(a,b,c){var d=!(!c||!c.length),e=a.zoom-this.zoom,g=a.Zk||a;if(0<e||d){a.Zk=[];for(var h=0,k=g.length;h<k;h+=1){var l=g[h],m=this.Lca(l);l.un||b?l.Xl&&d&&c.sX&&-1!==w.a.indexOf(c.sX,l.Xl)||(5>e&&this.yda(m,l,0<e,b,d)?a.Zk.push(l):w.l.Y||0===e&&!b||(this.ny.push(l),l.zoom=this.labels?this.labels.zoom:this.ce,l.BK=new Date)):l.Yi&&a.Zk.push(l)}}else a.Zk= a;return!1},yY:function(a,b,c,d,e){a=new Date;for(var g=[],h=0,k=b.length;h<k;h+=1){var l=b[h],m=Math.max(0,Math.abs(l.zoom-this.zoom)),m=Math.max(0,1-(a-l.BK)/(1/Math.pow(1.3,m)*c));if(0<m){g.push(l);var n=this.bD(l);-20>n[0]||n[0]>d+20||-20>n[1]||n[1]>e+20||this.zY(n,l,m)}else l.BK=void 0}g.length&&(this.bW=this.pi=1);return g},BY:function(a,b,c,d,e,g){d=a.zoom!==this.zoom;18===a.zoom&&18<this.zoom&&(d=!1);b.globalAlpha=1;a=a.Zk;b=0;for(var h=a.length;b<h;b+=1){var k=a[b];if(!(d&&k.Yi||k.Dm&&c&& 0<=c.indexOf(k.Dm))){var l=this.bD(k);-20>l[0]||l[0]>e+20||-20>l[1]||l[1]>g+20||this.zY(l,k)}}},gaa:function(a){this.hn&&this.hn.DY!==this.q.ja&&this.q.set("reload");if(this.bW)return!0;if(a.Hb&&a.Hb.length)if(this.Hb&&this.Hb.length){if(this.Hb!==a.Hb||this.Hb.Uu!==this.zoom||this.Hb.Ru!==this.gb||this.Hb.fz!==this.rotation||!this.Hb.size.qb(a.size))return!0}else return!0;else if(this.Hb&&this.Hb.length)return!0;return!this.labels||!this.g.dV&&this.labels===this.hn&&this.hn&&this.hn.Uu===this.zoom&& this.hn.Ru===this.gb&&!a.ck&&this.hn.fz===this.rotation&&this.hn.DY===this.q.ja&&this.hn.size.qb(a.size)?!1:!0},yda:function(a,b,c,d,e){if(!e&&!c&&!d)return!0;var g;e=b.Da.length;if(b.im>this.zoom)g=!0;else if(!c&&d)g=!1;else for(var h=0;h<e;h+=1){var k=b.wb[h],l=k[2],m=k[3],n=k[0],k=k[1],n=a[0]+n,k=a[1]+k;this.zda(n,k,l,m)||(g=!0)}if(!g&&(c||d))for(h=0;h<e;h+=1)for(k=b.wb[h],l=k[2],m=k[3],n=k[0],k=k[1],n=a[0]+n,k=a[1]+k,l=Math.ceil((n+l)/this.Uo),c=Math.ceil((k+m)/this.Uo),n=Math.floor(n/this.Uo), k=Math.floor(k/this.Uo),d=0,m=l-n;d<=m;d+=1)for(var l=0,p=c-k;l<=p;l+=1)this.ju[n+d]||(this.ju[n+d]={}),this.ju[n+d][k+l]=1;return!g},zda:function(a,b,c,d){var e=Math.ceil((a+c)/this.Uo);d=Math.ceil((b+d)/this.Uo);a=Math.floor(a/this.Uo);b=Math.floor(b/this.Uo);c=0;for(e-=a;c<=e;c+=1)if(this.ju[a+c])for(var g=0,h=d-b;g<=h;g+=1){if(1===this.ju[a+c][b+g])return!1}else this.ju[a+c]={};return!0}});w.Q.canvas.Wh.$_=w.aa.extend({B:function(a){this.Q=a},v9:function(a){this.jp=a;return this.XH([0,0,0])?!0:this.jp=!1},OQ:function(){return this.Q.Se?!1:!0},C4:function(a){if(a){var b=Array.prototype.slice.call(arguments,0);switch(a.type){case "icon":return this.F4.apply(this,b);case "label":return this.G4.apply(this,b);default:console.error("Unknown type",a)}}},bQ:function(a,b,c){a=null;try{a=b.getImageData.apply(b,c)}catch(d){console.error(d),a=null}return a},P9:function(a){return 0>a?0:255<a?255: Math.round(a)},nT:function(a,b){for(var c=0;4>c;c++)a[b+c]=this.P9(a[b+c]);return a},WH:function(a,b){var c=259*(b+255)/(255*(259-b));return[c*(a[0]-128)+128,c*(a[1]-128)+128,c*(a[2]-128)+128]},m9:function(a){return[255-a[0],255-a[1],255-a[2]]},XH:function(a,b){isNaN(b)&&(b=20);var c=Math.max(0,0.299*a[0]+0.587*a[1]+0.114*a[2]-b);switch(this.jp){case "amap://styles/normal":case "normal":return[1*c,1.2*c,255];case "amap://styles/light":case "light":return[1*c,1*c,255];case "amap://styles/fresh":case "fresh":return[1* c,1*c,220];case "amap://styles/grey":case "amap://styles/dark":case "insight":case "dark":return[1.5*a[0],1.5*a[1],1*a[2]];case "amap://styles/blue":case "amap://styles/darkblue":case "blue_night":case "mapv":return[2*a[0],1.5*a[1],1*a[2]]}return!1},H4:function(a,b){var c=20,d=10;switch(b.Vl){case "active":c+=20,d+=20}return this.WH(this.XH(a,c),d)},uQ:function(a,b){var c=-110;switch(b.Vl){case "active":c+=30}return this.WH(this.XH(this.m9(a),c),50)},E4:function(a){return this.WH(a,20)},tQ:function(a, b,c,d,e,g){var h=a[b],k=a[b+1],l=a[b+2];a=a[b+3];0<a?(e=e.call(this,[h,k,l,a],g),c[d]=e[0],c[d+1]=e[1],c[d+2]=e[2]):(c[d]=h,c[d+1]=k,c[d+2]=l);c[d+3]=a;this.nT(c,d)},V3:function(a){var b=a.data,c=a.width;a=a.height;for(var d=0,e=0,g=[Infinity,Infinity],h=[-Infinity,-Infinity],k=0;k<c;k++)for(var l=0;l<a;l++){var m=4*this.AG(k,l,c,a);if(!(76.5>b[m+3])){e++;k<g[0]&&(g[0]=k);l<g[1]&&(g[1]=l);k>h[0]&&(h[0]=k);l>h[1]&&(h[1]=l);for(var n=!0,p=0;4>p;p++)if(220>b[m+p]){n=!1;break}n&&d++}}return{Lja:0<e?d/ e:0,Haa:[g[0],g[1],h[0]-g[0]+1,h[1]-g[1]+1]}},AG:function(a,b,c){return b*c+a},LB:function(a,b,c,d,e,g,h){var k=this.AG(b,c,d,e);d=a[4*k+0];e=a[4*k+1];var l=a[4*k+2];a=a[4*k+3];if(a/255<h.mX||h.HZ&&!h.HZ.call(this,d,e,l,a))return!1;g.push([b,c]);return!0},r8:function(a,b){var c=Math.abs(a[0]-b[0]),d=Math.abs(a[1]-b[1]);return Math.sqrt(c*c+d*d)},st:function(a,b){return 0.1>Math.abs(a[0]-b[0])&&0.1>Math.abs(a[1]-b[1])},F9:function(a,b){for(var c=[a[0]],d=1,e=a.length;d<e;d++){var g=a[d];this.r8(g, c[c.length-1])<=b&&c.push(g)}return this.st(c[c.length-1],a[a.length-1])?c:null},cla:function(){},s2:function(a,b,c,d){d=w.extend({mX:0.2,iX:4},d);var e,g,h=[],k=[],l=[],m=[];for(e=0;e<c;e++){for(g=0;g<b&&!this.LB(a,g,e,b,c,h,d);g++);for(g=b-1;0<=g&&!this.LB(a,g,e,b,c,k,d);g--);}if(!h.length||!k.length)return null;for(g=0;g<b;g++){var n;e=h[0][0];n=k[0][0];if(g>=e&&g<=n)for(e=0;e<c&&!this.LB(a,g,e,b,c,l,d);e++);e=h[h.length-1][0];n=k[k.length-1][0];if(g>=e&&g<=n)for(e=c-1;0<=e&&!this.LB(a,g,e,b,c, m,d);e--);}if(!l.length||!m.length)return null;m.reverse();h.reverse();if(this.st(l[l.length-1],k[0])&&this.st(k[k.length-1],m[0])&&this.st(m[m.length-1],h[0])&&this.st(h[h.length-1],l[0])){b=[m,h,l,k];e=0;for(a=b.length;e<a;e++)if(!(2>b[e].length||(b[e]=this.F9(b[e],d.iX),b[e])))return null;return[].concat(b[0]).concat(b[1].slice(1)).concat(b[2].slice(1)).concat(b[3].slice(1))}return null},D3:function(a){for(var b=[Infinity,Infinity],c=[-Infinity,-Infinity],d=0,e=a.length;d<e;d++){var g=a[d][0], h=a[d][1];b[0]>g&&(b[0]=g);b[1]>h&&(b[1]=h);c[0]<g&&(c[0]=g);c[1]<h&&(c[1]=h)}return b.concat([c[0]-b[0]+1,c[1]-b[1]+1])},jQ:function(a,b){this.eT||(this.eT=document.createElement("canvas"));var c=this.eT;c.width=a;c.height=b;return c},b4:function(a){switch(a.length){case 2:return"lineTo";case 4:return"quadraticCurveTo"}return null},HP:function(a){switch(a.length){case 2:return[a[0]+0.5,a[1]+0.5];case 4:return[a[0]+0.5,a[1]+0.5,a[2]+0.5,a[3]+0.5]}return a},SO:function(a,b){a.beginPath();for(var c= 0,d=b.length;c<d;c++){var e=b[c];0===c?(2<e.length&&(4===e.length?e=e.slice(-2):console.error("Unknown start point: ",b)),a.moveTo.apply(a,this.HP(e))):a[this.b4(e)].apply(a,this.HP(e))}},J3:function(a){a=this.uQ([255,255,255],{Vl:a.Vl});this.nT(a,0);return"rgba("+a.slice(0,3).join(",")+", 0.8)"},D4:function(a,b,c){function d(a){return[Math.round((a[0]-n)*q+n-m[0]),Math.round((a[1]-p)*s+p-m[1])]}c=w.extend({Vl:"hover",HT:!0,padding:[1.5,1.5]},c);var e=a.width,g=a.height,h=this.jQ(2*e+10,g),k=h.getContext("2d"), l=this.D3(b),m=c.padding;w.l.qd&&(m[0]+=2.5,m[1]+=2.5);for(var n=l[0],p=l[1],q=(l[2]+2*m[0])/l[2],s=(l[3]+2*m[1])/l[3],l=0,r=b.length;l<r;l++)switch(b[l].length){case 2:b[l]=d(b[l]);break;case 4:b[l]=d(b[l]).concat(d(b[l].slice(2)));break;default:console.error("Unknown point: ",b[l])}k.save();this.SO(k,b);k.closePath();k.fillStyle=c.fillStyle||"rgba(255,255,255,0.85)";k.fill();k.putImageData(a,e+6,0);k.drawImage(h,e+6,0,e,g,0,0,e,g);a=c.HT&&10<b.length;var u=c.strokeStyle||this.J3(c);k.strokeStyle= a?"#fff":u;k.lineCap="butt";k.lineJoin="round";k.lineWidth=w.l.qd?2:1.2;k.stroke();k.restore();return{qa:h,Df:[0,0,e,g],ld:a?function(a,c){this.G9(a,c,b,u)}:null}},G9:function(a,b,c,d){this.w2();var e=this.Q.zt;this.KO(a,c,{duration:200,NL:0,startTime:Date.now(),Hha:function(a){a.strokeStyle=d;a.lineCap="butt";a.lineJoin="round";a.lineWidth=w.l.qd?2:1;a.translate(b[0],b[1])},Mja:function(){return this.Q.zt!==e}})},w2:function(){this.HF&&w.a.Wg(this.HF)},KO:function(a,b,c,d){this.OQ()?this.HF=w.a.pc(function(){this.HF= null;if(c.Mja.call(this))d&&d.call(this);else{var e=(Date.now()-c.startTime)/c.duration;1<e&&(e=1);var g=Math.round(b.length*e);if(c.NL<g){var h=1===e?b:b.slice(c.NL,g+1);h.length&&(a.save(),c.Hha.call(this,a,e),this.SO(a,h),a.stroke(),a.restore());c.NL=g}1>e?this.KO(a,b,c,d):d&&d.call(this)}},this):d&&d.call(this)},E2:function(a,b,c){a=a.createImageData(b.width,b.height);var d=a.data,e=a.width,g=a.height,h=c[0]+c[2],k=c[1],l=c[1]+c[3];for(c=c[0];c<h;c++)for(var m=k;m<l;m++)for(var n=4*this.AG(c, m,e,g),p=0;4>p;p++)d[n+p]=b.data[n+p];return a},u5:function(a,b,c){var d=a[1]+(b[1]-a[1])*c;return[Math.round(a[0]+(b[0]-a[0])*c),Math.round(d)]},a5:function(a,b,c){for(var d=1/c,e=[],g=1;g<c;g++){var h=this.u5(a,b,d*g);e.length&&this.st(h,e[e.length-1])||e.push(h)}return e},b5:function(a,b){for(var c=1,d=a.length;c<d;c++){var e=a[c-1],g=a[c];2===g.length&&(4===e.length&&(e=e.slice(2)),2===e.length&&(e=this.a5(e,g,b),a.splice.apply(a,[c,0].concat(e)),c+=e.length,d+=e.length))}},e4:function(a,b,c, d,e){e=Math.round(Math.min(c,d)*e);c--;d--;e?a=[[a+c,b+d-e],[a+c,b+d,a+c-e,b+d],[a+e,b+d],[a,b+d,a,b+d-e],[a,b+e],[a,b,a+e,b],[a+c-e,b],[a+c,b,a+c,b+e],[a+c,b+d-e]]:(e=[a+c,b+d],a=[e,[a,b+d],[a,b],[a+c,b],e]);this.b5(a,5);return a},F4:function(a,b,c,d,e,g){b=a.Df;var h=c?c.HK:this.bQ(d,e,b);if(h){var k=c?c.eW:null,l=h,m=a.padding,n=m?m[0]:0,p=m?m[1]:0;(m=0<n*p)&&(l=this.E2(e,l,[n,p,l.width-2*n,l.height-2*p]));d=l.data;b=l.width;var q=l.height;if(b&&q){c=(c=this.Q.g)&&c.J?c.J.get("hotspotOptions"): {};c=w.extend({borderAnimation:!0},c);l=this.V3(l);a=!a.Xda&&0.46<=l.Lja;var s=e.createImageData(b,q);e=s.data;for(var r=a?this.uQ:this.E4,u=0,v=d.length;u<v;u+=4)this.tQ(d,u,e,u,r,{Vl:g});if(m&&(e=a&&!w.l.qd?this.s2(d,b,q,{HZ:a?function(a,b,c){return!(220<a&&220<b&&220<c)}:null,mX:0.2,iX:4}):null,e||(e=l.Haa,e=this.e4(e[0],e[1],e[2],e[3],0.2)),e)){var x=this.D4(s,e,{Vl:g,fillStyle:"active"!==g?null:"#ddd",KD:h,HT:c.borderAnimation&&"hover"===g&&!k,padding:a?[1.5,1.5]:[2.5,2.5]}),s=null;return{KD:h, Su:function(a,b){k&&h&&a.putImageData(h,b[0],b[1]);a.drawImage(x.qa,x.Df[0],x.Df[1],x.Df[2],x.Df[3],b[0],b[1],b[2],b[3]);x.ld&&(x.ld.call(this,a,b),x.ld=null)}}}return{KD:h,Su:function(a,b){if(m){var c=this.jQ(s.width,s.height);c.getContext("2d").putImageData(s,0,0);a.clearRect(b[0]+n,b[1]+p,b[2]-2*n,b[3]-2*p);a.drawImage(c,0,0,c.width,c.height,b[0],b[1],b[2],b[3])}else a.putImageData(s,b[0],b[1]);s=null}}}}},G4:function(a,b,c,d,e,g){a=a.Df;if(c=c?c.HK:this.bQ(d,e,a))if(d=c.data,a=c.width,b=c.height, a&&b){var h=e.createImageData(a,b);e=h.data;a=0;for(b=d.length;a<b;a+=4)this.tQ(d,a,e,a,this.H4,{Vl:g});return{KD:c,Su:function(a,b){a.putImageData(h,b[0],b[1]);h=null}}}},lQ:function(a,b,c){var d=c[2],e=c[3],g=a[0]+c[0];a=a[1]+c[1];if(4===c.length||c.IQ){if((b=this.Q.Ql(b))&&b.loaded)return c=[4,4],w.l.qd&&(c[0]*=2,c[1]*=2),{type:"icon",Xda:b.src&&b.src.indexOf&&0<=b.src.indexOf("/indoor_icon/"),padding:c,Df:[g-c[0],a-c[1],d+2*c[0],e+2*c[1]]}}else return{type:"label",Df:[g,a,d,e]}}}); w.Q.canvas.Wh.ob({$P:function(){this.HG||(this.HG=new w.Q.canvas.Wh.$_(this));return!1===this.HG.v9(this.jp)?null:this.HG},hq:function(a,b){var c=this.$P();if(c&&c.OQ()&&a&&a.Da&&a.wb&&0===this.rotation){var d=this.zt,e=this.bD(a),g=[],h;a.mo||(a.mo=[]);var k=a.mo;for(h=a.wb.length-1;0<=h;h--){if(k[h]){if(k[h].rev!==d)continue;if(k[h].eW===b)continue}var l=c.lQ(e,a.Da[h],a.wb[h]);if(l){var m=c.C4(l,a,k[h],this.Ck,this.zj,b);m&&(k[h]={eW:b,rev:d,HK:m.KD},g.push({Su:m.Su,Df:l.Df,Xy:"icon"===l.type? 2:1}))}}g.sort(function(a,b){return a.Xy-b.Xy});h=0;for(d=g.length;h<d;h++)g[h].Su.call(c,this.zj,g[h].Df),g[h].Su=null}},aw:function(a){a.mo&&(a.mo.length=0,a.mo=null)},NB:function(){var a=this.zj;a&&a.putImageData&&a.putImageData(a.getImageData(0,0,1,1),0,0)},SB:function(a){if(a&&a.Da&&a.wb&&a.mo){var b=this.zj,c=this.$P();if(c){for(var d=this.zt,e=this.bD(a),g=a.mo,h=0,k=a.wb.length;h<k;h++){var l=g[h];if(l&&(g[h]=null,d===l.rev)){var m=c.lQ(e,a.Da[h],a.wb[h]);m&&m.Df&&b.putImageData(l.HK,m.Df[0], m.Df[1])}}a.mo=null;this.zt++}}}});w.Cs={h:function(a,b,c,d,e){if(this.Nd(a,b,c||this))return this;var g=this.ve=this.ve||{};g[a]=g[a]||[];e?g[a].unshift({jb:b,ke:c||this,dk:d}):g[a].push({jb:b,ke:c||this,dk:d});"complete"===a&&this.ta&&this.r(a);return this},Nd:function(a,b,c){var d=this.ve;if(b&&c){if(d&&a in d&&d[a])for(var e=0;e<d[a].length;e+=1)if(d[a][e].jb===b&&d[a][e].ke===c)return!0;return!1}return d&&a in d&&d[a]&&0<d[a].length},I:function(a,b,c){if(!this.Nd(a))return this;var d=this.ve;if(d&&d[a])for(var e=0;e<d[a].length;e+= 1)if(!(d[a][e].jb!==b&&"mv"!==b||c&&d[a][e].ke!==c)){d[a].splice(e,1);d[a].length||(d[a]=null);break}return this},JD:function(a,b){if(!this.Nd(a))return this;var c=this.ve;if(c&&c[a])for(var d=0;d<c[a].length;d+=1)if(!b||c[a][d].ke===b){c[a].splice(d,1);c[a].length||(c[a]=null);break}return this},r:function(a,b){function c(a){var b=Array.prototype.slice.call(arguments,1),c,d,e,g;d=0;for(e=b.length;d<e;d+=1)for(c in g=b[d]||{},g)Object.prototype.hasOwnProperty.call(g,c)&&(a[c]=g[c]);return a}if(!this.Nd(a))return this; var d={type:a};b||"string"!==typeof b&&"number"!==typeof b&&"boolean"!==typeof b?("object"===typeof HTMLElement?b instanceof HTMLElement:b&&"object"===typeof b&&1===b.nodeType&&"string"===typeof b.nodeName)?d.value=b:d=c(d,b):d.value=b;for(var e=[].concat(this.ve[a]),g=0;g<e.length;g+=1)e[g].jb&&(e[g].jb.call(e[g].ke||this,d),e[g]&&e[g].dk&&this.ve[a]&&this.ve[a].splice(g,1));return this},bi:function(a){a?this.ve&&this.ve[a]&&(this.ve[a]=null):this.ve=null;return this}};(function(){if(w.l.Br&&!w.Uh){w.Uh=w.$E();var a=w.a.dK({Nu:"posToCoord",gw:"_decodeBoundsList"});w.Uh.Zj(null,new Function("\\n    return {\\n      "+a.posToCoord+": "+w.vF.Nu.toString()+",\\n      "+a._decodeBoundsList+": "+w.Ls.gw.toString()+"\\n  }"));w.Uh.Zj(null,function(){return{Lr:function(a,c){a.ak?this.lfa.call(this,a,c):this.mfa.call(this,a,c)},mfa:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=0,k=d.length;h<k;h+=1){var l=d[h];l&&(a.tW&&(l=JSON.parse(l)),l["x-vd-v"]?(this.Ed=a.de.Ed=l["x-vd-v"], this.Ud=a.de.Ud=[l.tv||"",l.vdv].join("-"),this.rf=a.de.rf=l.tv):this.kfa(this.extend({},a,{Qx:l,Uc:g})))}g.length?this.parseLabel(this.extend({},a.de,{Uc:g}),function(d,g){var h=g.data,k=g.tda;c(d,{Ac:a.Ac,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),data:h,tda:k,bk:e,ze:{Ed:a.de.Ed,Ud:a.de.Ud,rf:a.de.rf,nc:a.nc}},{Jr:!e,jn:e})}):c(null,{Ac:a.Ac,data:null,bk:e},{Jr:!e,jn:e})},kfa:function(a){function c(a,b,c){var n=[c,a,b].join("/");18<h&&!m&&(n+="/"+h);if((a=d.filter(function(a){return a.key=== n})[0])&&"loaded"!==a.status&&-1!==l.indexOf(v))if("limg"===v)b=g[1],a.Qd=b,"string"===typeof b.b&&(b.b=u.gw(b.b)),c="",(c="object"===typeof b.u?b.u.url:b.u)&&(b.u={url:c,Tn:"limg-"+a.key+"-"+e});else{b={ti:a.ma,ll:n,Ba:g,Wc:v,NK:"building"===v,dh:"poilabel"===v||"roadlabel"===v||"building"===v&&p};if("poilabel"===v||"roadlabel"===v)b.Qd=a.Qd;v===l[l.length-1]&&(a.status="loaded");k.push(b)}}var d=a.Nb,e=a.WK,g=a.Qx,h=a.nc,k=a.Uc,l=a.xa,m=a.Je,n=a.sK,p=a.td,q=g[0].split("-");a=parseInt(q[1]);var s= parseInt(q[2]),r=parseInt(q[0]),u=this,v=q[3],q=Math.pow(2,r);10>r&&(a<=n&&c(a+q,s,r),a>=q-n&&c(a-q,s,r));c(a,s,r)},lfa:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=[],k=0,l=d.length;k<l;k+=1){var m=d[k];m&&(m=JSON.parse(m),m["x-vd-v"]?(this.Ed=a.de.Ed=m["x-vd-v"],this.Ud=a.de.Ud=[m.tv||"",m.vdv].join("-"),this.rf=a.de.rf=m.tv):(this.jfa(this.extend({},a,{Qx:m,Uc:g,Ed:this.Ed||"v4"})),h.push(m)))}c(null,{Ac:a.Ac,cba:h,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),bk:e,ze:{Ed:a.de.Ed,Ud:a.de.Ud, rf:a.de.rf,nc:a.nc}},{Jr:!e,jn:e})},jfa:function(a){function c(a,b,c,e){var k=[e,b,c].join("/");if(a=a.filter(function(a){return a.key===k})[0])if(b=a.ma,c=q.Rb+"://vdata.amap.com/icons/"+(s||g?"b":"n")+(10>b.z?"39":"18")+"/1/",a&&"loaded"!==a.status&&-1!==h.indexOf(t))if("limg"===t)n[1]&&(a.Qd={url:"data:image/png;base64,"+n[1],Tn:"limg-"+a.key+"-"+m});else{if("roadlabel"===t)for(var l=1;l<n.length;l+=1){var r=n[l];r.qz=r[0];var u=d.qs(r[1],p);if(!(0>u[0]||256<=u[0]||0>u[1]||256<=u[1])){var v=x.Nu(u, b),u={Oa:v,name:r[0],Yi:!0,Bd:u,Da:[],wb:[],visible:!0,ik:!0},H=u.name;u.Xr=15>r[2]%90||75<r[2]%90?90*Math.floor((r[2]+15)/90):r[2];v=r[3];0<=r[8]&&(u.zB={name:r[6],KZ:r[7],dir:r[8]});var K=v[2];e=v[3];var L=-Math.floor(e/2);if(r[4])if("v5"<=p){var J=r[5].split(":"),N=J[1],N=parseInt(N)-1,J=q.Rb+"://vdata.amap.com/style_icon/icon-normal-"+(s||g?"big":"small")+".png";u.Da.push(J);var J=Math.floor(N/10),M=N%10,T=0,W=0,Z=0;g?(T=48,Z=W=40):s?(T=W=40,Z=36):(T=W=24,Z=20);var Y=T*Math.max(K+2,Z)/Z,J=[-Y/ 2,-T/2,Y,T,W*M,W*J,W,W];u.le=7;u.wb.push(J)}else{L=!1;N=parseInt(r[5]);153===N&&(0===H.indexOf("G")?(N="153g",L=!0):0===H.indexOf("S")&&(N="153s",L=!0));if(151===N||150===N)L=!1,0===H.indexOf("G")&&(N=150,L=!0),0===H.indexOf("S")&&(N=151,L=!0);152===N&&(N=151);!0===L&&(c=q.Rb+"://webapi.amap.com/theme/v1.3/icons/"+(s||g?"b/":"n/"));J=c+N+".png";u.Da.push(J);Y=r[4][0]*y;r=r[4][1]*y;J=[-Y/2,-r/2,Y,r];u.wb.push(J);K=Math.min(Y-3,K);e=Math.min(r,e);L=-Math.floor(e/2)+(g?3:1)}u.Da.push(a.Qd);u.le=11;u.wb.push([-Math.floor(K/ 2),L,K,e,v[0],v[1],v[2],v[3]]);a.xa||(a.xa=[]);a.xa.push(u)}}else if("poilabel"===t){H=[];for(l=1;l<n.length;l+=1)if(r=n[l],r.qz=r[0],u=d.qs(r[1],p),!(0>u[0]||256<=u[0]||0>u[1]||256<=u[1])){v=x.Nu(u,b);u={Oa:v,name:r[0].replace("^",""),un:!0,Bd:u,Da:[],wb:[],visible:!0,ik:!0};N=0;u.hl=r[8];r[6]&&("v5"<=p?(J=r[6].split(":"),N=J[1],L=Math.floor((parseInt(J[0].split("_")[1])-28)/2)):N=r[6]);if(N&&r[3]){if("v5"<=p){J=q.Rb+"://vdata.amap.com/style_icon/icon-"+(1===L?"biz-":"normal-")+(s||g?"big":"small")+ ".png";u.Da.push(J);N=parseInt(N)-1;J=Math.floor(N/10);M=N%10;Z=W=T=0;g?(T=48,W=40,Z=28):s?(T=W=40,Z=28):(T=W=24,Z=20);Y=T;if(151===N||152===N||153===N)Z-=4,K=r[7][0][2],Y=T*Math.max(K+2,Z)/Z;J=[-Y/2,-T/2,Y,T,W*M,W*J,W,W]}else J=c+N+".png",u.Da.push(J),J=[-Math.round(r[3][0]/2),-Math.round(r[3][1]/2),r[3][0],r[3][1]],g&&(J[0]*=y,J[1]*=y,J[2]*=y,J[3]*=y);u.wb.push(J)}if(r[2]&&r[7])for(K=r[2],J=0;J<r[2].length;J+=1){u.Da.push(a.Qd);v=r[7][J];g&&(K[J][0]=Math.round(K[J][0]*y),K[J][1]=Math.round(K[J][1]* y),K[J][2]=Math.round(K[J][2]*y),K[J][3]=Math.round(K[J][3]*y));Y=K[J][0];M=K[J][1]-(g?4:2);T=v[3];W=v[2];Y<-W&&N&&r[3]&&(Y=-W+u.wb[0][0]);if("v5">p){if("375"===N||"3751"===N)W=Math.min(K[J][2],g?24:14),Y=-Math.floor(W/2),M=-Math.floor(T/2)}else Y-=2;u.le=T-4;4===e&&"\\u5317\\u4eac"===u.name&&(M=g?-50:-26);u.wb.push([Y,M,W,v[3],v[0],v[1],v[2],v[3]])}u.Xl=r[5];u.Xl&&H.push(u.Xl);u.gl=r[4];u.im=r[9];u.iL=r[10];u.$e=N;u.vr=L;a.xa||(a.xa=[]);a.xa.push(u)}a.Te||(a.Te={},a.Te.je=H)}t===h[h.length-1]&&(a.status= "loaded",a.ta=a.qa=!0,a.Jc&&(a.Jc.ta=a.Jc.qa=!0))}}var d=this,e=a.Nb,g=a.qd,h=a.xa,k=a.sK,l=a.kb,m=a.WK,n=a.Qx,p=a.Ed,q=this.A,s=this.l.Y,r=n[0].split("-");1===r.length&&(r=n[0].split("_"));a=parseInt(r[1]);var u=parseInt(r[2]),v=parseInt(r[0]),x=this,t=r[3],y=g?l:1,l=Math.pow(2,v);10>v&&(a<=k&&c(e,a+l,u,v),a>=l-k&&c(e,a-l,u,v));c(e,a,u,v)}}},function(a){a||(w.Uh.hea=!0)})}})();(function(){if(w.l.Br&&!w.kf){w.kf=w.$E();var a=w.a.dK({h:"on",Nd:"hasEvents",I:"off",JD:"offByContext",r:"emit",bi:"clearEvents"});w.kf.Zj(null,function(){return{aX:function(a,c){var d=this;if(3<this.Bq||this.disabled)return this.aj(a,c);var e=a.Nb,g=a.nc,h=a.xg,k=a.$M,l=a.Oda,m=a.xa;a.de.Lc?this.Lc=a.de.Lc:a.de.Lc=this.Lc;if(h&&this.qo())this.yk(e,c);else{var n=[(new Date).getTime(),this.ir()+1&65535,h?1:0].join("-");h||(this.Af[n]=1);var k={command:"tiles",reqId:n,payload:{t:k,opt:g,cs:{level:g, flds:m.join(","),v:l?"3":"2"}}},p=this.send(k);this.Qm[n]={Nb:e,nc:g,F:a,Cc:c,xg:h};this.wy()||setTimeout(function(){d.wy()||(d.Bq?d.Bq++:d.Bq=1,d.QU(p)&&(delete d.Qm[n],delete d.Af[n],d.aj(a,c)))},300);this.h("tiles",this.RD,this);this.h("ack",this.QD,this);this.h("disable",this.PD,this)}},caa:function(a){this.SK()&&this.send(a)},PD:function(){this.disabled=!0;this.close();for(var a in this.Qm)this.Qm.hasOwnProperty(a)&&this.rG(a)},rG:function(a){var c=this.Qm[a];c&&(this.yk(c.Nb,c.Cc),delete this.Qm[a], delete this.Af[a])},QD:function(a){var c=a.reqId,d=this.Qm[c];d&&(a.content.status?d.Cc&&(d.Cc(null,{Ac:d.F.Ac,d$:!0,bk:!0},{Jr:!1,jn:!0}),delete this.Qm[c],delete this.Af[c]):this.rG(c))},RD:function(a){var c=a.reqId,d=this.Qm[c];d&&(d.xg&&this.qo()?this.rG(c):this.Lr(this.extend({bk:!1},d.F,{LE:a.content.data,nc:a.content.opt}),d.Cc))},Lr:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=0,k=d.length;h<k;h+=1){var l=d[h];l&&(a.tW&&(l=JSON.parse(l)),l["x-vd-v"]?(this.Ed=a.de.Ed=l["x-vd-v"],this.rf=a.de.rf= l.tv,this.Ud=a.Ud=[l.tv||"",l.vdv].join("-"),l.bgc&&(l="#"+l.bgc.substring(2),a.Mq!==l&&(a.Mq=l))):this.Du(this.extend({},a,{Qx:l,Uc:g})))}g.length?(d=this.extend({},a.de,{Uc:g}),(a.Je?this.RX:this.parseDataToVector)(d,function(d,g){c(d,{Ac:a.Ac,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),data:g.data,Mq:a.Mq,bk:e,ze:{Ed:a.de.Ed,rf:a.de.rf,Ud:a.de.Ud,nc:a.nc}},{Jr:!e,jn:e})})):c(null,{Ac:a.Ac,Nb:[],data:null,bk:e},{Jr:!e,jn:e})}}});w.kf.Zj(null,w.lL);w.kf.Zj(null,new Function("\\n    return {\\n      "+ a.on+": "+w.Cs.h.toString()+",\\n      "+a.hasEvents+": "+w.Cs.Nd.toString()+",\\n      "+a.off+": "+w.Cs.I.toString()+",\\n      "+a.offByContext+": "+w.Cs.JD.toString()+",\\n      "+a.emit+": "+w.Cs.r.toString()+",\\n      "+a.clearEvents+": "+w.Cs.bi.toString()+"\\n    }\\n  "));w.kf.Zj(null,w.rF,function(a){a||(w.kf.Eda=!0)})}})(); ')
_jsload_('overlay', 'w.pa.dc=w.pa.Wd.extend({B:function(a,b){var c=a.length;this.Of=Array(c);for(var d,e,g=0;g<c;g+=1)if(d=a[g],e=new w.pa.XN(d),this.Of[g]=e,!b)if(0===g){if(0===d.length)break;e.$o(d)||d.reverse()}else 0!==d.length&&e.$o(d)&&d.reverse()},Tc:function(){if(0===this.Of.length)return[Infinity,Infinity,-Infinity,-Infinity];if(!this.nf){for(var a=this.Of[0].Tc(),b=1;b<this.Of.length;b+=1){var c=this.Of[b].Tc();w.H.sU(a,c)||w.H.extend(a,c)}this.nf=a}return this.nf},MV:function(){return this.Of},ah:function(){return w.pa.Xd.Xz}, nd:function(a){for(var b=this.Of,c,d=0,e=b.length;d<e&&(c=b[d].nd(a),0<d&&(c=!c),c);d+=1);return c}});w.pa.Gs=w.pa.Wd.extend({B:function(a){var b=a.length;this.Ze=Array(b);for(var c=0;c<b;c+=1){var d=new w.pa.dc(a[c]);this.Ze[c]=d}},Tc:function(){if(!this.nf){for(var a=[Infinity,Infinity,-Infinity,-Infinity],b=this.Ze,c=0,d=b.length;c<d;c+=1)w.H.extend(a,b[c].Tc());this.nf=a}return this.nf},TJ:function(){return this.Oa},ah:function(){return w.pa.Xd.Vz},pV:function(){return this.Ze},nd:function(a){for(var b=!1,c=0,d=this.Ze.length;c<d;c+=1)if(this.Ze[c].nd(a)){b=!0;break}return b}});w.pa.Yn=w.pa.Wd.extend({B:function(a){this.Oa=a},Tc:function(){if(!this.nf){for(var a=[Infinity,Infinity,-Infinity,-Infinity],b=0,c=this.Oa.length;b<c;b+=1)w.H.OC(a,this.Oa[b]);this.nf=a}return this.nf},TJ:function(){return this.Oa},ah:function(){return w.pa.Xd.dF},ir:function(){return this.Oa.length},Xt:function(a){return w.Qc.Ko(a,this.Oa)}});w.pa.XN=w.pa.Yn.extend({ah:function(){return w.pa.Xd.WN},$o:w.Qc.$o,nd:function(a){return w.Qc.nd(a,this.Oa)}});w.pa.Lv=w.pa.Wd.extend({B:function(a){var b=a.length;this.Ze=Array(b);for(var c=0;c<b;c+=1){var d=new w.pa.Yn(a[c]);this.Ze[c]=d}},pV:function(){return this.Ze},Tc:function(){if(!this.nf){for(var a=[Infinity,Infinity,-Infinity,-Infinity],b=this.Ze,c=0,d=b.length;c<d;c+=1)w.H.extend(a,b[c].Tc());this.nf=a}return this.nf},TJ:function(){return this.Oa},ah:function(){return w.pa.Xd.jF},ir:function(){return this.Oa.length},Xt:function(a){for(var b=Infinity,c=0,d=this.Ze.length;c<d;c+=1)b=Math.min(b,this.Ze[c].Xt(a)); return b}});w.D.Gb=w.D.Lg.extend({B:function(a,b){arguments.callee.oa.apply(this,arguments);this.x$=a;this.X("options",a);this.X("geodesic",a);this.X("path",a);this.X("noSelect",a);this.Nq();this.X("display",b);b.h("zoomend",this.Dl,this)},Ym:function(){if("3D"==this.map.J.view.type){var a=this.M;a&&(a=a.Z)&&(delete a.Ba,delete a.Tt)}},deltaPosChanged:function(){this.set("display")},geodesicChanged:function(){this.pathChanged()},np:function(a){var b=Math.pow(2,20-this.map.get("zoom")),c=this.get("path"),b=a.Vc(b), d=[],e,g,h;e=0;for(g=c.length;e<g;e+=1)h=this.map.Fb(c[e]).add(b),d.push(this.map.qe(h));0<d.length&&this.set("path",d);if(this.IH&&0<this.IH.length)for(e=0,c=this.IH.length;e<c;e+=1)this.IH[e].np(a);this.x$.r("movepoly",{Ku:b})},My:function(a,b,c){a=this.get("deltaPos")||[0,0];this.set("deltaPos",[c.x+a[0],c.y+a[1]])},rw:function(a){this.get("options");return this.c5()?this.S3(a):this.wG(a)},c5:function(){var a=this.get("options");return a&&!!a.geodesic},getStrokeWeight:function(){return this.get("options").strokeWeight}, S3:function(a){if(!a||!a.length)return[];var b,c=[],d,e,g=[],h,k=this.map.get("resolution"),l=this.get("options").geodesicInterpolatePixelWidth||17;c.push(a[0]);g.push(this.xG(a[0]));d=1;for(e=a.length;d<e;d+=1)h=this.xG(a[d]),b=Math.round(Math.abs(h[0]-g[g.length-1][0])/k),b=Math.min(31,Math.round(b/l),Math.round(Math.abs(a[d-1].P-a[d].P))),"3D"==this.map.J.view.type&&(b=Math.round(b/1.2)),b=w.U.Mca(a[d-1],a[d],b),c.push.apply(c,b),g.push.apply(g,this.wG(b)),c.push(a[d]),g.push(h);return g},nC:function(a){var b= [],c=[],d,e,g,h,k,l,m=a.Z;m instanceof w.pa.Yn?l=[m]:m instanceof w.pa.Lv&&(l=m.Ze);m=[];a=a.Ka.rotation;b=this.map.get("size");d=Math.PI*a/180;a=(Math.abs(b.width*Math.cos(d))+Math.abs(b.height*Math.sin(d)))/2;var n=(Math.abs(b.width*Math.sin(d))+Math.abs(b.height*Math.cos(d)))/2;d=0;for(e=l.length;d<e;d+=1)if(g=l[d].Oa,g.length)for(h=0,k=g.length;h<k;h+=1)if(b=g[h],b=this.cf(b),b[0]=Math.round(b[0]+a),b[1]=Math.round(b[1]+n),0===h)c[0]=NaN,c[1]=NaN,m.push("M"+b[0]+" "+b[1]);else if(b[0]!==c[0]|| b[1]!==c[1])m.push("L"+b[0]+" "+b[1]),c[0]=b[0],c[1]=b[1];return m},Nq:function(){if(this.map&&!this.M){var a=this.map,b=this.get("path"),b=this.M=new w.Ig({sG:this.Bc.ZA,name:"polyline-"+w.a.Jb(this),zIndex:this.get("options").zIndex||1,map:a,Z:new w.pa.Yn(this.rw(b)),style:this.get("options")});b.po=this;this.X("resolution",a);this.X("center",a);this.X("coords",b);this.X("style",b);b.he("noSelect visible zIndex strokeWeight isOutline deltaPos".split(" "),this)}},pathChanged:function(){this.Ym(); var a=this.M,b=this.get("path");a&&(this.set("coords",this.rw(b)),a.Yg=!0,"c"!==this.map.get("overlayRender")&&a.Ka?(b=this.nC(a),w.l.dm||b.push("e"),b=b.join(" "),0===b.length&&a.Ka?(a.Ka.af.parentNode.removeChild(a.Ka.af),a.Ka.Xb.parentNode&&a.Ka.Xb.parentNode.removeChild(a.Ka.Xb),a.Ka=null):w.l.dm?(a.Ka.af.setAttribute("d",b),a.Ka.Xb&&a.Ka.Xb.setAttribute("d",b)):(a.Ka.af.path=b,a.Ka.Xb&&(a.Ka.Xb.path=b))):this.set("display"))},Dl:function(){},visibleChanged:function(){this.M&&(this.M.Ka?this.get("visible")? (this.M.Ka.af.style.display="block",this.M.Ka.Xb&&(this.M.Ka.Xb.style.display="block")):(this.M.Ka.af.style.display="none",this.M.Ka.Xb&&(this.M.Ka.Xb.style.display="none")):this.set("display"))},optionsChanged:function(){this.Ym();this.M&&(this.M.style=this.get("options"),this.M.zIndex=this.get("options").zIndex,this.M.No(),this.M.Ka&&(this.M.Ka.af.parentNode&&this.M.Ka.af.parentNode.removeChild(this.M.Ka.af),this.M.Ka.Xb&&this.M.Ka.Xb.parentNode&&this.M.Ka.Xb.parentNode.removeChild(this.M.Ka.Xb))); this.set("display")}});w.D.Bv=w.D.Gb.extend({B:function(a,b){this.w$=a;arguments.callee.oa.apply(this,arguments);this.X("tolerance",a);b.h("zoomend",this.Dl,this)},wG:function(a){var b=Math.pow(2,20-Math.round(this.map.get("zoom")));return w.EN.zV(a,this.map.cn,b,this.w$.F)},toleranceChanged:function(){this.pathChanged()},Dl:function(){this.pathChanged()}});w.D.dc=w.D.Lg.extend({B:function(a,b){arguments.callee.oa.apply(this,arguments);this.JT=a;this.X("options",a);this.X("path",a);this.Nq();this.X("display",b)},Ym:function(){if("3D"==this.map.J.view.type){var a=this.M;a&&(a=a.Z.get("rings"))&&w.a.isArray(a)&&a.forEach(function(a){delete a.Ba;delete a.Tt})}},deltaPosChanged:function(){this.set("display")},np:function(a){var b=Math.pow(2,20-this.map.get("zoom")),c=this.get("path");a=a.Vc(b);var b=[],d,e;c.length&&c[0]instanceof w.U&&(c=[c],e=!0);for(var g= 0,h=c.length;g<h;g+=1){for(var k=c[g],l=[],m=0,n=k.length;m<n;m+=1)d=this.map.Fb(k[m]).add(a),l.push(this.map.qe(d));b.push(l)}0<b.length&&this.set("path",e?b[0]:b);this.JT.r("movepoly",{Ku:a})},My:function(a,b,c){a=this.get("deltaPos")||[0,0];this.set("deltaPos",[c.x+a[0],c.y+a[1]]);this.JT.r("movepoly",{Ku:c})},rw:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];a.length&&a[0]instanceof w.U&&(a=[a]);for(var b,c,d=[],e,g=this.map,h=0;h<a.length;h+=1){var k=a[h];e=[];b=0; for(c=k.length;b<c;b+=1){var l=g.Fb(k[b]);e.push([l.x,l.y])}d.push(e)}return d},Nq:function(){if(this.map&&!this.M){var a=this.map,b=this.get("path"),b=this.M=new w.Ig({sG:this.Bc.ZA,name:"polygon-"+w.a.Jb(this),zIndex:this.get("options").zIndex||1,map:a,Z:new w.pa.dc(this.rw(b)),style:this.get("options")});b.po=this;this.X("resolution",a);this.X("center",a);this.X("coords",b);this.X("style",b);b.he(["visible","zIndex","strokeWeight","deltaPos"],this)}},pathChanged:function(){var a=this.M,b=this.get("path"); this.Ym();a&&(this.set("coords",this.rw(b)),a.Yg=!0,"c"!==this.map.get("overlayRender")&&a.ea?(b=this.oC(a),0===b.length?(a.ea.parentNode.removeChild(a.ea),a.ea=null):w.l.dm?a.ea.setAttribute("d",b.join(" ")):(b.push("e"),a.ea.path=b.join(" "))):this.set("display"))},getStrokeWeight:function(){return this.get("options").strokeWeight},visibleChanged:function(){this.M&&(this.M.ea?this.get("visible")?this.M.ea.style.display="block":this.M.ea.style.display="none":this.set("display"))},optionsChanged:function(){this.Ym(); this.M&&(this.M.style=this.get("options"),this.M.zIndex=this.get("options").zIndex,this.M.No());this.set("display")},oC:function(a){var b=[NaN,NaN,0],c=[NaN,NaN],d,e,g,h,k,l,m,n=a.ea.rotation,p=this.map.get("size");e=Math.PI*n/180;n=(Math.abs(p.width*Math.cos(e))+Math.abs(p.height*Math.sin(e)))/2;p=(Math.abs(p.width*Math.sin(e))+Math.abs(p.height*Math.cos(e)))/2;a=a.Z;a instanceof w.pa.dc?d=[a]:a instanceof w.pa.Gs&&(d=a.Ze);var q=[];a=0;for(e=d.length;a<e;a+=1)if(b=d[a],g=b.Of,h=g.length,0<h)for(var s= 0;s<h;s+=1){var r;k=g[s].Oa;l=0;for(m=k.length;l<m;l+=1)if(b=k[l],b=this.cf(b),b[0]=Math.ceil(b[0]+n),b[1]=Math.ceil(b[1]+p),0===l)c[0]=NaN,c[1]=NaN,r=b,q.push("M"+b[0]+" "+b[1]);else if(b[0]!==c[0]||b[1]!==c[1])q.push("L"+b[0]+" "+b[1]),c=b;r&&q.push("L"+r[0]+" "+r[1])}return q}});w.D.Sf=w.D.Lg.extend({B:function(a,b){arguments.callee.oa.apply(this,arguments);this.X("center",a);this.X("draggable",a);this.X("unit",a,!0);this.X("radius",a);this.X("options",a);this.Nq();this.X("display",b)},np:function(a){var b=this.get("center");a=a.Vc(Math.pow(2,20-this.map.get("zoom")));var c=this.map.Fb(b).add(a);b instanceof w.U?this.set("center",this.map.qe(c)):this.set("center",c);this.Bc.r("movepoly",{Ku:a})},My:function(a,b,c){a=this.get("deltaPos")||[0,0];this.set("deltaPos",[c.x+a[0], c.y+a[1]])},Nq:function(){if(this.map&&!this.M){var a=this.map,b=a.Fb(this.get("center")),c="px"===this.get("unit"),b=this.M=new w.Ig({Aw:!0,sG:this.Bc.ZA,name:"circle-"+w.a.Jb(this),zIndex:this.get("options").zIndex||1,map:a,Z:new w.pa.Tf([b.x,b.y]),style:this.get("options")});b.zr=c;b.po=this;this.X("resolution",a);this.X("coords",b);this.X("style",b);b.X("visible",this,!0);b.he("radius center unit resolution zIndex strokeWeight deltaPos".split(" "),this)}},Ym:function(){if("3D"==this.map.J.view.type){var a= this.M;a&&(a=a.Z)&&(delete a.Ba,delete a.Tt,delete a.o_)}},deltaPosChanged:function(){this.set("display")},getStrokeWeight:function(){return this.get("options").strokeWeight},centerChanged:function(){var a=this.M,b=this.map.Fb(this.get("center"));a&&(a.Z.Oa=[b.x,b.y],this.Ym(),this.set("coords",[b.x,b.y]),this.Yg=!0,a.ea?this.nY():this.set("display"))},visibleChanged:function(){this.M&&(this.M.ea?this.get("visible")?this.M.ea.style.display="block":this.M.ea.style.display="none":this.set("display"))}, optionsChanged:function(){this.Ym();this.M&&(this.M.style=this.get("options"),this.M.zIndex=this.get("options").zIndex,this.M.No(),this.M.Yg=!0,this.set("display"))},JI:function(a){var b=[],c=[],d,c=a.Z;c instanceof w.pa.Tf&&(d=[c]);var c=this.map.get("resolution",Math.floor(this.map.get("zoom"))),e=a.ea.rotation,b=this.map.get("size"),g=Math.PI*e/180,e=(Math.abs(b.width*Math.cos(g))+Math.abs(b.height*Math.sin(g)))/2,g=(Math.abs(b.width*Math.sin(g))+Math.abs(b.height*Math.cos(g)))/2,b=this.cf(d[0].Oa); b[0]=Math.round(b[0]+e);b[1]=Math.round(b[1]+g);a=a.get("remain")?5.23:a.zr?this.get("radius"):this.get("radius")/(c*Math.cos(Math.PI*this.get("center").O/180));return c=["M",b[0],b[1]-a,"A",a,a,0,1,1,b[0]-0.01,b[1]-a,"Z"].join(" ")},nY:function(){var a=this.M,b=this.get("radius");if("c"!==this.map.get("overlayRender")&&a.ea)if(w.l.dm)b=this.JI(a),a.ea.setAttribute("d",b);else{b=this.map.get("resolution",Math.floor(this.map.get("zoom")));b=a.zr?this.get("radius"):this.get("radius")/(b*Math.cos(Math.PI* this.get("center").O/180));a.ea.style.width=Math.round(2*b);a.ea.style.height=Math.round(2*b);var c=this.map.get("size").width/2,d=this.map.get("size").height/2,e=this.cf(a.Z.Oa);e[0]=Math.round(e[0]+c);e[1]=Math.round(e[1]+d);a.ea.style.top=Math.round(e[1]-b);a.ea.style.left=Math.round(e[0]-b)}else this.set("display")},radiusChanged:function(){var a=this.M,b=this.get("radius");a&&(this.Ym(),a.Yg=!0,a.r("rad",{target:a,hj:b}),this.nY())}}); ')
_jsload_('wgl', '(function(){if(w.l.rm){var a=function(a){function c(a,b,c,d,g,h,k){var l=a.Ba;c=[];d=a.ti;var m=null,n=null,p;a.Ba=[];h=h&&16<b;for(var q=[],t=[],x=[],y=1,Y=l.length;y<Y;y+=1){var ca=l[y],R=ca[1].split("&"),m=s(B?B:R[0]),n=s(R[4]);p=ca[2];var da=ca[0],U=ca[3]*Math.pow(2,2)*k,V=ca[4],X={},Q=ca[5],ca=[];if(Q&&Q.length)for(var S=0,O=Q.length;S<O;S+=1){var P=Q[S].split("-"),R=P[1].split("^");ca[P[0]]=R;for(var P=0,ba=R.length;P<ba;P+=1)-1===e(c,R[P])&&c.push(R[P])}if(V&&V.length)for(Q=0,O=V.length;Q< O;Q+=1){P=V[Q].split("-");ba=parseInt(P[0]);X[ba]={};for(var R=1,ga=P.length;R<ga;R+=1)X[ba][parseInt(P[R])]=!0}Q=0;for(V=da.length;Q<V;Q+=1){R=da[Q];z||(q=[],x=[],t=[]);for(var R=u(R,v,b),O=r(R,d,g,!0),R=O[1],P=[],S=ga=ba=0,la=R.length-1;S<la;S+=1){var ja=R[S],pa=R[S+1],ba=ba+ja[0],ga=ga+pa[1];if(!X[Q]||!X[Q][S])if(h){var va=pa[0]-ja[0],ta=pa[1]-ja[1],ya=5E3+va+(5E3+ta)/1E4,ta=Math.sqrt(Math.pow(va,2)+Math.pow(ta,2)),va=Math.round(U/64),ta=Math.ceil(ta/64);va?t.push(0,0,ta,va,0,va,0,0,ta,0,ta,va): t.push(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1);q.push(ja[0],ja[1],-U,ya);q.push(pa[0],pa[1],0,ya);q.push(ja[0],ja[1],0,ya);q.push(ja[0],ja[1],-U,ya);q.push(pa[0],pa[1],-U,ya);q.push(pa[0],pa[1],0,ya)}else x.push(ja[0],ja[1],0,-1,pa[0],pa[1],0,-1);P.push([ja[0],ja[1]])}S=R.length-1;ba=[ba/S+215440491,ga/S+106744817];P=G.Gp(h?P:R,[],0,1);ga=0;for(S=P.length;ga<S;ga+=1)for(R=0;3>R;R+=1)la=-U,h||(la=0),t.push(-1,-1),q.push(P[ga][R][0],P[ga][R][1],la,0);!z&&q.length&&(R=[m,n,p],O=[new Float32Array(q),new Float32Array(t), new Float32Array(x),R,O[1],ba],ca[Q]&&(O.nda=ca[Q]),a.Ba.push(O))}}z&&q.length&&(b=256*Math.pow(2,20-d.z),ba=[d.x*b+128,d.y*b+128],O=[new Float32Array(q),new Float32Array(t),new Float32Array(x),[m,n,p],null,ba],a.Ba.push(O));a.Xk=c;return a}function d(a,b,c,d,g,h){c=a.Ba;d=[];for(var k=a.ti,l=null,m=null,n={},p=1,q=c.length;p<q;p+=1){var t=c[p],x=t[1].split("&"),l=s(B?B:x[0]),m=s(x[2]),y=x[0]+x[2];n[y]||(n[y]={XZ:[],MY:[],gp:[],Ih:[],Vba:l,borderColor:m,Ub:t[2]});var l=n[y].XZ,m=n[y].MY,x=n[y].gp, y=n[y].Ih,z=t[0],ca=t[3]*Math.pow(2,2),R=t[4],da={};if((t=t[5])&&t.length)for(var U=0,V=t.length;U<V;U+=1)for(var X=t[U].split("-")[1].split("^"),Q=0,S=X.length;Q<S;Q+=1)-1===e(d,X[Q])&&d.push(X[Q]);if(R&&R.length)for(t=0,V=R.length;t<V;t+=1)for(X=R[t].split("-"),Q=parseInt(X[0]),da[Q]={},U=1,S=X.length;U<S;U+=1)da[Q][parseInt(X[U])]=!0;t=0;for(R=z.length;t<R;t+=1){for(var O=z[t],O=u(O,v,b),O=r(O,k,g,!0)[1],U=[],V=0,X=O.length-1;V<X;V+=1){var Q=O[V],S=O[V+1],P=[Q[0]-0*ca,Q[1]-0.3*ca],ba=[S[0]-0*ca, S[1]-0.3*ca];da[t]&&da[t][V]||(h?((S[0]-Q[0])*(P[1]-Q[1])<(P[0]-Q[0])*(S[1]-Q[1])&&(l.push(P[0],P[1],2),l.push(S[0],S[1],-1),l.push(Q[0],Q[1],-1),l.push(P[0],P[1],2),l.push(ba[0],ba[1],2),l.push(S[0],S[1],-1),y.push([Q,S,ba,P])),x.push(P[0],P[1],-1,ba[0],ba[1],-1)):x.push(Q[0],Q[1],-1,S[0],S[1],2));U.push([P[0],P[1]])}O.pop();V=G.Gp(h?U:O,[],0,1);y.push(h?U:O);O=0;for(X=V.length;O<X;O+=1)for(U=0;3>U;U+=1)m.push(V[O][U][0],V[O][U][1],3)}}a.Ba=[];for(O in n)n.hasOwnProperty(O)&&(x=[n[O].Vba,n[O].borderColor, n[O].Ub],a.Ba.push([new Float32Array(n[O].XZ),new Float32Array(n[O].MY),new Float32Array(n[O].gp),x,n[O].Ih]));a.Xk=d;return a}function e(a,b){if(a&&!a.length)return-1;if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return-1}function g(a,b){for(var c=a.Ba,d=[],e={0:"ffde0000",1:"ffffcc00",2:"ff33b100",3:"ff8c0e0e",4:"ffadadad"},g=0,h=c.length;g<h;g++){for(var k=[],l=0,n=c[g].length;l<n;l++){var p=[],q=[];m(p,q,c[g][l][1],a.ma,b);p.forEach(function(a,b){k.push([a, q[b]])})}if(k.length){var r=[[],[],{width:0.75*c[g][0][0],borderColor:s(e[g])}];k.forEach(function(a){var b=r[0].length/9;b&&(a[1]=a[1].map(function(a){return a+b}));r[0]=r[0].concat(a[0]);r[1]=r[1].concat(a[1])});r[0]=new Float32Array(r[0]);r[1]=new Uint16Array(r[1]);d.push(r)}}a.Ba=d;return a}function h(a){var b=[],c=[],d=[];a=r(a,{x:0,y:0},1);c.push.apply(c,a[2]);if(2<a[1].length){var e=G.Gp(a[1],[],0);e.length&&(b.push.apply(b,a[0]),d.push.apply(d,e))}return[new Float32Array(b),new Uint16Array(d), {},c]}function k(a,b,c,d,e){for(var g="solid solid_roundcap solid_squarecap dash railway dash_crewel".split(" "),h=a.Ba.slice(1),k=h.length-1;0<=k;k--)h[k].nW=k;h.sort(function(a,b){return a[2]>b[2]?1:a.nW>b.nW?1:-1});for(var m={},k=0,n=h.length;k<n;k+=1){var p=h[k],q=p[1].split("&"),r,u,v,x,y;r=u=v=x=y=null;var B,z,G,V,X=null,Q=!1;B=z=G=V=null;q[1]&&(r=s(q[1]));u=parseInt(q[0]);v=q[2];v!==g[0]&&(v===g[1]?B="round":v===g[2]?B="square":0===v.indexOf(g[5])?(X=!0,G=[3,2]):0===v.indexOf(g[3])?(G=v.substring(5).split(")")[0].split(","), G.forEach(function(a,b){G[b]*=e})):0===v.indexOf(g[4])&&(x=r,r=q[4]?s(q[4]):[1,1,1,r[3]],G=[12,12],Q=!0,y=3,u=1));q[3]&&q[4]&&3<q.length&&(y=u+parseInt(q[3]),x=s(q[4]),v=q[5],v!==g[0]&&(v===g[1]?z="round":v===g[2]?z="square":0!==v.indexOf(g[5])&&0===v.indexOf(g[3])&&(y+=1,V=v.substring(5).split(")")[0].split(","),V.forEach(function(a,b){V[b]*=e}))));if(c){if(G)for(q=G.length-1;0<=q;q-=1)G[q]*=e;if(V)for(q=V.length-1;0<=q;q-=1)V[q]*=e}v=[];v.$f=0;var S=[],O=[];l(v,O,S,p[0],a.ti,b,c,d,e,B);"app"=== t&&(u/=4,y/=4);q=[u,r,G,y,x,V,X,Q,B,z,p[3],p[4]];q.mna=!0;p=p[2];m[p]||(m[p]=[]);m[p].push([new Float32Array(v),new Uint16Array(O),q,S])}a.Ba=m;return a}function l(a,b,c,d,e,g,h,k,l,m){for(var n=0,p=d.length;n<p;n+=1){var q=a.length/11,s=q+6,t=u(d[n],v,g),x=r(t,e,k);if(1<x[1].length){for(var t=x[0],y=x[2],B=0,x=x[1].length;B<x;B+=1){if(0<B){var z=t[2*B]-t[2*B-2],G=t[2*B+1]-t[2*B-1];a.$f+=Math.sqrt(z*z+G*G)*(h?l:1)}var z=t[2*B],G=t[2*B+1],V=y[B][0],X=y[B][1],Q,S;B===x-1?(Q=t[2*x-2],S=t[2*x-1]):(Q= t[2*B+2],S=t[2*B+3]);var O,P;0===B?(O=z,P=G):(O=t[2*B-2],P=t[2*B-1]);if(0!==B){var ba=B===x-1?0:-1;a.push(z,G,V,X,1,O,P,ba,Q,S,a.$f);a.push(z,G,V,X,-1,O,P,ba,Q,S,a.$f)}else a.push(z,G,V,X,0,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,1,Q,S,a.$f),a.push(z,G,V,X,0,O,P,1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,0,Q,S,a.$f),m&&(b.push(q+2,q+0,q+3),b.push(q+2,q+1,q+0),b.push(q+3,q+0,q+4),b.push(q+4,q+0,q+5));B!==x-1?(ba=0===B?0:1,a.push(z,G,V,X,1,O,P, ba,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,ba,Q,S,a.$f)):(a.push(z,G,V,X,0,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,0,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,0,Q,S,a.$f));B!==x-1?(b.push(s+4*B,s+4*B+3,s+4*B+1),b.push(s+4*B,s+4*B+2,s+4*B+3)):m&&(z=s+4*(x-1),b.push(z+1,z+2,z+0),b.push(z+2,z+3,z+0),b.push(z+0,z+4,z+5),b.push(z+0,z+3,z+4))}c.push(y)}}}function m(a,b,c,d,e){for(var g=[],h=0,k=c.length;h<k;h+=1){var l=[], m=[],n=u(c[h]),p=r(n,d,e);g.push(p[2]);if(1<p[1].length){var q=p[1].length;p[1].forEach(function(a,b,c){var d=c[b-1];c=c[b+1];0===b?d=a:b===q-1&&(c=a);l.push(a[0],a[1],p[2][b][0],p[2][b][1],1,d[0],d[1],c[0],c[1]);l.push(a[0],a[1],p[2][b][0],p[2][b][1],-1,d[0],d[1],c[0],c[1]);0===b?m.push(0,1,2):b!=q-1?(m.push(2*(b-1)+1,2*b+1,2*b),m.push(2*b,2*b+1,2*(b+1))):m.push(2*(b-1)+1,2*b+1,2*b)});a.push(l);b.push(m)}}}function n(a,b,c,d,e,g,h,k){for(var l=0,m=d.length;l<m;l+=1){var n=a.length/2,p=r(u(d[l],v, g),e,h);if(2<p[1].length&&(n=G.Gp(p[1],[],n),n.length&&(a.push.apply(a,p[0]),b.push.apply(b,n),c.push(p[2]),k)))for(var n=0,q=p[2].length;n<q;n+=1){var s=p[2][n][0]/512,t=p[2][n][1]/512;1==e.x%2&&(s+=0.5);1==e.y%2&&(t+=0.5);k.push(s,t)}}}function p(a,b,c){function d(a,b){for(var c=0,e=a.length;c<e;c++)a[c]+=b;return a}var e=a.Ba,g=[],h=[],k=[],l=[];q(a,h,k,c);for(var m=[[[0,0],[255,0],[255,255],[0,255]]],p=[[0,0],[255,0],[0,255],[255,255]],r=a.ti,u=0,t=p.length;u<t;u+=1){var v=p[u][0]/512,x=p[u][1]/ 512;1==r.x%2&&(v+=0.5);1==r.y%2&&(x+=0.5);l.push(v,x)}g.push([h,k,s("ff"+a.EI.substr(1)),"regions:land",m,l]);e.sort(function(a,b){return"string"===typeof a?-1:"string"===typeof b?1:a[2]>b[2]?1:a[2]<b[2]?-1:0});p=1;for(r=e.length;p<r;p+=1)u=e[p],h=[],k=[],m=[],l=[],t=s(u[1].split("&")[0]),n(h,k,m,u[0],a.ti,b,c,l),g.push([h,k,t,u[3],m,l]);b={Tp:[],gs:[],Ia:[],Nh:[],Lp:[]};h=e=c=0;for(k=g.length;h<k;h++)l=g[h],b.Ia.push.apply(b.Ia,l[0]),b.Nh.push.apply(b.Nh,d(l[1],c)),b.Lp.push.apply(b.Lp,l[5]),b.gs.push([l[2], l[3]]),b.Tp.push([l[1].length,e]),e+=l[1].length,c+=l[0].length/2,delete l[0],delete l[1],delete l[5];b.Ia=new Float32Array(b.Ia);b.Nh=new Uint16Array(b.Nh);b.Lp=new Float32Array(b.Lp);g.buffer=b;a.Ba=g;return a}function q(a,b,c,d){var e=a.ti;a=256*e.x*d-215440491;e=256*e.y*d-106744817;b.push(a,e);var g=256*d;d=a+g;b.push(d,e);e+=g;b.push(a,e);b.push(d,e);c.push(0,1,2,1,3,2)}function s(a){for(var b=[],c=0,d=a.length;c<d;c+=2)b.push(parseInt(a.substr(c,2),16)/255);b.push(b.shift());return b}function r(a, b,c,d){var e=0,g=0,e=256*b.x,g=256*b.y;b=[];for(var h=[],k=[],l=0,m=a.length;l<m;l+=2){var n=(e+a[l])*c-215440491,p=(g+a[l+1])*c-106744817,q=k.length;if(d||0===b.length)k.push(n),k.push(p),b.push([n,p]),h.push([a[l],a[l+1]]);else if(n!==k[q-2]||p!==k[q-1])n===k[q-2]&&n===k[q-4]?(k[q-1]=p,b[b.length-1][1]=p,h[b.length-1][1]=a[l+1]):p===k[q-1]&&p===k[q-3]?(k[q-2]=n,b[b.length-1][0]=n,h[b.length-1][0]=a[l]):(k.push(n),k.push(p),b.push([n,p]),h.push([a[l],a[l+1]]))}return[k,b,h]}function u(a,b,c){var d= "ASDFGHJKLQWERTYUIO!sdfghjkleiu3~yr5-P&mq9`%zCN*b=8@^xpVM";b=b||"v5";var e,g;"v5"<b?(e=d.length,g=512):(e=27,d=d.substr(0,27),g=333);var h,k,l,m,n;k=[];l=NaN;m=0;for(n=a.length;m<n;m++)h=a[m],h=d.indexOf(h),isNaN(l)?l=h*e:(h=l+h-g,18===c&&"v5"<b&&(h/=4),k.push(h),l=NaN);return k}var v,x=Number.EPSILON||2E-16,t,y=!1,B=null,z=!0,G={Df:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d][0]*a[e][1]-a[e][0]*a[d][1];return 0.5*c},ZM:function(){return function(a,b){var c=a.length;if(3>c)return null; var d=[],e=[],g=[],h,k,l;if(0<G.Df(a))for(k=0;k<c;k++)e[k]=k;else for(k=0;k<c;k++)e[k]=c-1-k;var m=2*c;for(k=c-1;2<c&&!(0>=m--);){h=k;c<=h&&(h=0);k=h+1;c<=k&&(k=0);l=k+1;c<=l&&(l=0);var n;a:{var p=n=void 0,q=void 0,r=void 0,s=void 0,u=void 0,t=void 0,v=void 0,y=void 0,p=a[e[h]][0],q=a[e[h]][1],r=a[e[k]][0],s=a[e[k]][1],u=a[e[l]][0],t=a[e[l]][1];if(x>(r-p)*(t-q)-(s-q)*(u-p))n=!1;else{var B=void 0,z=void 0,X=void 0,Q=void 0,S=void 0,O=void 0,P=void 0,ba=void 0,ga=void 0,la=void 0,ga=ba=P=y=v=void 0, B=u-r,z=t-s,X=p-u,Q=q-t,S=r-p,O=s-q;for(n=0;n<c;n++)if(v=a[e[n]][0],y=a[e[n]][1],!(v===p&&y===q||v===r&&y===s||v===u&&y===t)&&(P=v-p,ba=y-q,ga=v-r,la=y-s,v-=u,y-=t,ga=B*la-z*ga,P=S*ba-O*P,ba=X*y-Q*v,ga>=-x&&ba>=-x&&P>=-x)){n=!1;break a}n=!0}}if(n){d.push([a[e[h]],a[e[k]],a[e[l]]]);g.push([e[h],e[k],e[l]]);h=k;for(l=k+1;l<c;h++,l++)e[h]=e[l];c--;m=2*c}}return b?g:d}}(),Gp:function(a,b,c,d){var e,g,h,k={};b=0;for(e=a.length;b<e;b++)h=a[b][0]+":"+a[b][1],k[h]=b;a=G.ZM(a,!1);if(!a)return[];if(d)return a; var l=[];b=0;for(e=a.length;b<e;b++)for(g=a[b],d=0;3>d;d++)h=g[d][0]+":"+g[d][1],h=k[h],l.push(h+c);return l},Qda:function(a){return 0>G.Df(a)}};return{RX:function(e,g){function h(a){var b=a.Ba;q&&b&&1<b.length&&b.slice(1).forEach(function(b){if(b&&null===b[1]){var c=b[b.length-1],d=q[c];b[1]=d.browserStyle[d.levelStyleMapping[m]];"road"===a.Wc&&(b[1]=b[1][0],b[4]=d,b[4].id=c)}})}v=e.Ed;y=e.Mda;t=e.mode;z=e.Ky;var l=y?c:d,m=e.uu,n=e.Vu,q=null;B=e.pC;var r=e.Y,s=[],u=Math.pow(2,20-m);e.Lc&&(q=e.Lc.stylemaps); for(var x=0,G=e.Uc.length;x<G;x+=1){var T=e.Uc[x],W=T.Wc;h(T);switch(W){case "region":s.push(p(T,m,u));break;case "road":s.push(k(T,m,n,u,e.KY));break;case "building":s.push(l(T,m,n,r,u,e.Y$,e.mu))}}delete e.Lc;e.Uc=s;if(a){l=[];x=0;for(G=s.length;x<G;x++)if((n=s[x].Ba)&&n.length)for(r=0,u=n.length;r<u;r++)n[r].buffer&&n[r].buffer instanceof ArrayBuffer&&l.push(n[r].buffer);a.vx(l)}g(null,{data:e})},aga:function(a,b){for(var c=a.Uc,d=Math.pow(2,20-a.nc),e=[],h=0,k=c.length;h<k;h++)e.push(g(c[h],d)); a.Uc=e;b(null,{data:a})},TX:function(a,b){var c=a.Nr.reduce(function(a,b){return a.concat(b)},[]),c=h(c);b(null,{data:c})},PX:function(a,b){var c=a.ib,d=a.hj,e=0,g=Math.PI/180*6,h=[],k=[];h.push(c[0],c[1]);for(var l=0;60>l;l++)h.push(c[0]+d*Math.cos(e),c[1]+d*Math.sin(e)),e+=g,0<l&&k.push(0,l,l+1),59==l&&k.push(0,l+1,1);b(null,{data:[h,k]})},Pna:function(){}}};w.s_=a();w.WE=new w.Os(a,{lazy:"untilCall"});w.l.Br&&w.kf.Zj(null,a)}})(w);(function(){function a(){function a(b,c,d,e,g,k){var l=[0,0,0,0,0],n=d.slice(0,4).concat(l),p=[],s=Math.PI/180*6,A=void 0,I=void 0,A=d.slice(0,2),D=m(e),F=m(g),I=q.normalize(h(D).fg(h(A))),C=q.normalize(h(F).fg(h(A)));q.OK(I,k)?(A=q.oD(I),I=q.oD(C)):(A=q.oD(C),I=q.oD(I),k=[F,D],D=k[0],F=k[1],g=[g,e],e=g[0],g=g[1]);D=Math.ceil(Math.abs(I-A)/s);30<=D&&(D=60-D);for(k=0;k<D;k++)0===k?(n.push.apply(n,e.slice(0,4)),n.push.apply(n,l)):(F=(k*s+A)%(2*Math.PI),n.push.apply(n,d.slice(0,2).concat([0,0])),n.push(1* Math.cos(F),1*Math.sin(F),0,0,0)),0<k&&p.push(0,k,k+1);n.push.apply(n,g.slice(0,4));n.push.apply(n,l);p.push(0,D,D+1);var H=b.length/9;b.push.apply(b,n);c.push.apply(c,p.map(function(a){return a+H}));return n.length/9}function c(c,d,e,g,k,l){function n(a,b,c,d,e){var g=void 0;a.NC(b)||q.AW(a,b)?g=b:c&&d&&e?g=a:c&&!d&&e?g=b:c||d||e?c||!d||e?(g=q.normalize(a.mi(b)),I=q.cos(g,a),g=g.oJ(I)):g=a:g=b;return g}function p(a,b,c){if(void 0===c||!0===c)d.push(a[0],a[1]),d.push(-b.y,b.x,0,0),d.push(A,0,0),l.push(a[2]); if(void 0===c||!1===c)d.push(a[0],a[1]),d.push(b.y,-b.x,0,0),d.push(A,0,0),l.push(a[2])}var s=c.length,E=0,A=0,I=void 0,D=void 0;k&&(g="bevel");c.forEach(function(c,r,H){var K=H[r-1];H=H[r+1];var L=void 0;K&&(A+=q.Fd(c,K));if(0===r||r===s-1)0===r?(void 0===H&&(H=c),L=q.normalize(h(H[0]-c[0],H[1]-c[1])),e.push(0,1,2)):(L=q.normalize(h(c[0]-K[0],c[1]-K[1])),r=d.length/9+2,4===r?e.push(3,2,1):e.push(r-3-E,r-1,r-2)),p(c,L);else{var J=q.normalize(h(c[0]-K[0],c[1]-K[1])),N=q.normalize(h(H[0]-c[0],H[1]- c[1])),L=q.normalize(J.multiply(-1).mi(N));D=q.OK(L,J);I=q.cos(L,J);p(c,n(J,N,D,!0,!0),!0);p(c,n(J,N,D,!0,!1),!1);p(c,n(J,N,D,!1,!0),!0);p(c,n(J,N,D,!1,!1),!1);r=d.length/9;K=r-4;H=K+2;var M=9*K,T=M+9,W=T+9,Z=W+9;D?(W=m(d.slice(T,W)),M=m(d.slice(M,T)),M=q.normalize(h(W).fg(h(M))),M=Math.abs(q.cos(J,M)/q.sin(J,M)*2),d[T+7]=-M,d[Z+7]=M):(Z=m(d.slice(M,T)),T=m(d.slice(T,W)),T=q.normalize(h(Z).fg(h(T))),T=Math.abs(q.cos(T,J)/q.sin(T,J)*2),d[M+7]=-T,d[W+7]=T);q.AW(J,N)?e.push(K,K+1,K-2-E):e.push(K,K-1- E,K+1);"miter"==g&&(D?p(c,n(J,N,0,!0,!0),!0):p(c,n(J,N,0,!0,!0),!1),E=1);if("round"===g){M=N=J=void 0;D?(J=d.slice(9*(K+1),9*(K+2)),N=d.slice(9*K,9*(K+1)),M=d.slice(9*H,9*(H+1))):(J=d.slice(9*K,9*(K+1)),N=d.slice(9*(K+1),9*(K+2)),M=d.slice(9*(H+1),9*(H+2)));L=a(d,e,J,N,M,L.multiply(-1));if(l)for(;0<L--;)l.push(c[2]);E=d.length/9-r}e.push(H,H+1,H+2+E);k||"bevel"!=g&&"miter"!=g||(D?e.push(H,K,K+1):e.push(H,H-1,H+1),"miter"==g&&(D?e.push(H+2,H-2,H):e.push(H+2,H+1,H-1)))}})}function d(a,b,c,d){function e(a, b){var c=void 0;if(a.NC(b))c=b;else{var c=q.normalize(a.mi(b)),d=q.cos(c,a);d>Math.sqrt(3)/2&&(d=Math.sqrt(3)/2);c=c.oJ(d)}return c}function g(a,c,e){if(void 0===e||!0===e)b.push(a[0],a[1]),b.push(-c.y,c.x,0,0),b.push(m,0,0),d.push(a[2]);if(void 0===e||!1===e)b.push(a[0],a[1]),b.push(c.y,-c.x,0,0),b.push(m,0,0),d.push(a[2])}for(var k=a[0],l=a[a.length-1],m=0,n=void 0;k[0]===l[0]&&k[1]===l[1]&&k!==l;)a.pop(),l=a[a.length-1];a.push(k);a.push(a[1]);a.unshift(l);var p=a.length;a.forEach(function(a,d, k){var l=k[d-1];k=k[d+1];var r=void 0;l&&(m+=q.Fd(a,l));if(0===d||d===p-1)0===d?(r=q.normalize(h(k[0]-a[0],k[1]-a[1])),c.push(0,1,2)):(r=q.normalize(h(a[0]-l[0],a[1]-l[1])),d=b.length/9+2,c.push(d-3,d-1,d-2)),g(a,r);else{d=q.normalize(h(a[0]-l[0],a[1]-l[1]));k=q.normalize(h(k[0]-a[0],k[1]-a[1]));l=q.normalize(d.multiply(-1).mi(k));n=q.OK(l,d);g(a,e(d,k),!0);g(a,e(d,k),!1);g(a,e(d,k),!0);g(a,e(d,k),!1);a=b.length/9-4;k=a+2;var r=9*a,s=r+9,x=s+9,B=x+9;d=Math.abs(q.cos(d,l)/q.sin(d,l));n?(b[r+7]=d,b[s+ 7]=-d,b[x+7]=-d,b[B+7]=d):(b[r+7]=-d,b[s+7]=d,b[x+7]=d,b[B+7]=-d);c.push(a,a-1,a+1);c.push(k,k+1,k+2)}})}function e(c,d,e){function g(a,b){if(p)for(;0<a--;)p.push(b)}function m(a,b){E.push.apply(E,a.slice(0,k));E.push(b.x,b.y);E.push.apply(E,a.slice(l));E.push.apply(E,a)}var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"butt",p=arguments[4],s=c.length-1,G=d.length,E=[],A=[],I=[d.slice(0,9),d.slice(9,18)],D=[d.slice(G-9,G),d.slice(G-18,G-9)];"square"===n?(n=q.normalize(h(c[0]).fg(h(c[1]))), m(I[0],n),m(I[1],n),n=q.normalize(h(c[s]).fg(h(c[s-1]))),m(D[0],n),m(D[1],n),A.push(0,2,3,3,1,0),A.push(6,7,4,4,7,5),p&&(p.push(c[0][2]),p.push(c[s][2]))):"round"===n&&(n=I[0].slice(0,2).concat(0,0,0,0).concat(I[0].slice(l)),I=a(d,e,n,I[0],I[1],q.normalize(h(c[0]).fg(h(c[1])))),g(I,c[0][2]),n=D[0].slice(0,2).concat(0,0,0,0).concat(D[0].slice(l)),I=a(d,e,n,D[0],D[1],q.normalize(h(c[s]).fg(h(c[s-1])))),g(I,c[s][2]));d.push.apply(d,E);e.push.apply(e,A.map(function(a){return a+G/9}))}function g(a,b){var c= [];a.forEach(function(a){var d=a[0],e=a[1];a=a[2];b&&(d-=p[0],e-=p[1]);var g=c.length-1;if(-1===g)c.push([d,e,a]);else if(d!==c[g][0]||e!==c[g][1]||a!==c[g][2])if(1<=g){var k=q.normalize(h(d-c[g][0],e-c[g][1])),l=q.normalize(h(c[g][0]-c[g-1][0],c[g][1]-c[g-1][1]));k.NC(l)&&a===c[g][2]?c[g]=[d,e,a]:c.push([d,e,a])}else c.push([d,e,a])});return c}function h(a,b){"object"===typeof a&&a.length&&(b=a[1],a=a[0]);return w.a.create(s,{x:{value:a},y:{value:b}})}var k,l;function m(a){return[a[0]+n*a[2],a[1]+ n*a[3]]}var n=1;k=4;l=6;var p=[215440491,106744817],q={normalize:function(a){var b=this.length(a);return a.oJ(b)},Qj:function(a,b){return a.multiply(b)},gJ:function(a,b){return a.x*b.y-a.y*b.x},length:function(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))},sin:function(a,b){return this.gJ(a,b)/(this.length(a)*this.length(b))},cos:function(a,b){return this.Qj(a,b)/(this.length(a)*this.length(b))},OK:function(a,b){return 0<this.gJ(a,b)},Fd:function(a,b){return Math.sqrt(Math.pow(b[0]-a[0],2)+ Math.pow(b[1]-a[1],2))},AW:function(a,b){return a.multiply(-1).NC(b)},oD:function(a){a=Math.atan2(a.y,a.x);0>=a&&(a+=2*Math.PI);return a}},s={mi:function(a){return h(this.x+a.x,this.y+a.y)},fg:function(a){return h(this.x-a.x,this.y-a.y)},multiply:function(a){return"number"===typeof a?h(this.x*a,this.y*a):this.x*a.x+this.y*a.y},oJ:function(a){return h(this.x/a,this.y/a)},NC:function(a){var b=a.y;return this.x===a.x&&this.y===b}};return{parse:function(a,b){var h=a.lineJoin,h=void 0===h?"bevel":h,k= a.lineCap,k=void 0===k?"butt":k,l=a.Zda,l=void 0===l?!1:l,m=a.tn,n=void 0===m?!1:m,p=a.LX,m=a.Iia,q=void 0===m?!0:m,m=a.Sda,s=[],A=[],I=g(a.Nr,void 0===p?!0:p),p=[];l?(d(I,s,A,p),h=s.length,[0,1,2,h/9-1,h/9-2].forEach(function(a){s[9*a+8]=-1})):(c(I,s,A,h,n,p),e(I,s,A,k,p));q&&(s=new Float32Array(s),A=65535<A.length?new Uint32Array(A):new Uint16Array(A));h=[s,A];m&&h.push(p);if(b)b(null,{data:h});else return h}}}w.uN=a();w.Jja=new w.Os(a,{})})();w.pk={Jda:function(a,b,c){b=w.pk.createProgram(a,b,c);if(!b)return console.log("Failed to create program"),!1;a.useProgram(b);a.ab=b;return!0},createProgram:function(a,b,c){b=w.pk.bX(a,a.VERTEX_SHADER,b);c=w.pk.bX(a,a.FRAGMENT_SHADER,c);if(!b||!c)return null;var d=a.createProgram();if(!d)return null;a.attachShader(d,b);a.attachShader(d,c);a.bindAttribLocation(d,0,"a_Position");a.linkProgram(d);return a.getProgramParameter(d,a.LINK_STATUS)?d:(console.log("Failed to link program: "+a.getProgramInfoLog(d)), a.deleteProgram(d),a.deleteShader(c),a.deleteShader(b),null)},bX:function(a,b,c){b=a.createShader(b);if(null===b)return console.log("unable to create shader"),null;a.shaderSource(b,c);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(console.log("Failed to compile shader: "+a.getShaderInfoLog(b)),a.deleteShader(b),null)},Pe:function(a,b,c,d){var e=d,g=!1;"number"!==typeof d&&(e=d.toString(),g=!0);if(c.uT!==e){var h="uniform"+b;if(g&&2===b.length)a[h].apply(a,[c].concat(d));else a[h](c, d);c.uT=e}},Mx:function(a){a.length||(a=[a]);for(var b=0,c=a.length;b<c;b++)delete a[b].uT}};w.Q.uf.Yc=w.Q.Gd.zi.extend({ga:[w.Ls],B:function(a,b){this.Ni=20;this.kb=Math.min(2,window.devicePixelRatio||1);this.qp=1;arguments.callee.oa.apply(this,arguments);this.X("mapStyle",a.g);this.X("style",a.g);this.bg=this.ji=!0;a.g.J.vn&&this.Ax(a,b);this.Cm=0;this.Jj={};this.nD()||this.set("reload")},R0:"precision highp float;attribute vec4 a_Position;attribute vec3 a_op,a_Next,a_Previous;attribute float a_Tags;uniform float u_xDelta,u_width;uniform lowp int u_type;uniform mat4 u_othMatrix,u_zoomMatrix,u_modelMatrix;uniform float u_scale;varying float v_distance;varying vec2 v_op;varying float v_TB;varying float v_cap;varying lowp float v_Tags;void main() {vec4 position=a_Position;position.x+=u_xDelta;if (u_type==0) {gl_Position=u_othMatrix*u_zoomMatrix*u_modelMatrix*position;}else if(u_type>1) {v_op=a_op.xy;v_TB=a_op.z;vec3 curPos=position.xyz;v_distance=a_Next.z;float ddis=0.0;vec3 previous=vec3(a_Previous.x+u_xDelta,a_Previous.y,0);vec3 next=vec3(a_Next.x+u_xDelta,a_Next.y,0);vec4 up,dir;v_distance *= u_scale;if(previous==curPos){ dir= vec4(normalize(next-curPos).xy,0,0);}else if(next==curPos){dir= -vec4(normalize(previous-curPos).xy,0,0);}else {vec3 dir0=previous-curPos;vec3 dir1=next-curPos;vec3 dir2=normalize(dir0);vec3 dir3=normalize(dir1);float f0=dir0.x*dir1.y-dir1.x*dir0.y;dir = vec4(0); v_cap=1.0;if(f0==0.0){up = vec4(dir3.y,-dir3.x,0,0); }else{vec3 dir4=normalize(dir2+dir3);float sinA=length(cross(dir4,dir2));float cosA=dot(dir4,dir2);if(sinA<0.5){sinA=0.5;}up= vec4(dir4,0)/sinA;ddis=abs(length(up)*cosA*u_width*0.5);if(f0<0.0){up=-up;ddis=-ddis;}v_distance += v_TB*a_Previous.z*ddis;}}if(previous==curPos||next==curPos){ up = vec4(dir.y,-dir.x,0,0); if(u_type==4){v_cap=sqrt(v_TB*v_TB+a_Previous.z*a_Previous.z);}else if(u_type==3){v_cap=1.0;}else{dir = vec4(0);}}vec4 pos=u_zoomMatrix*u_modelMatrix*position;pos=pos+(up*v_TB-dir*a_Previous.z)*u_width*0.5;gl_Position=u_othMatrix*pos;}else if (u_type==1) {v_Tags=a_Tags;gl_Position=u_othMatrix*u_zoomMatrix*u_modelMatrix*position;}}", S_:"precision lowp float;uniform vec4 u_FragColor,u_FragColor2;varying lowp float v_distance,v_TB;varying vec2 v_op;varying lowp float v_Tags;varying float v_cap;uniform lowp int u_type;uniform int u_isDash,u_onlyBorder;uniform vec4 u_dash;void main() {vec4 color=u_FragColor;if (u_type==0) {}else if(u_type>1) {if(v_op.x<-0.2||v_op.x>256.2||v_op.y<-0.2||v_op.y>256.2){discard;}if(v_cap>1.0){discard;}if(u_isDash==1){float all = u_dash[0] + u_dash[1] + u_dash[2] + u_dash[3];float off = mod(v_distance - u_dash[0], all);if(off> u_dash[0]&&off<=(u_dash[0]+u_dash[1])||off>(all-u_dash[3])){discard;}}if(u_onlyBorder==1&&v_TB<=0.7&&v_TB>=-0.7){discard;}}else if(u_type==1) {color=v_Tags==3.0?u_FragColor2:vec4((u_FragColor+(u_FragColor2-u_FragColor)*v_Tags/3.0).xyzw);}gl_FragColor=color;}", reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.Qa&&this.Qa.parentNode&&this.Qa.parentNode.removeChild(this.Qa);this.set("display")},Fu:function(a){if(this.q&&a.XK===this.q.Ac)for(var b=0,c=a.Uc.length;b<c;b+=1)this.Qy(a.Uc[b],a.uu,a.Vu,a.Y)},cM:function(a){for(var b=this.Pa,c=a.buffer,d=0,e=a.length;d<e;d+=1){var g=a[d];this.g.jk&&g[3]&&!this.g.ec&&(g[2]=this.T.Ro(g[2],g[3]),c.gs[d][0]=g[2])}c.Ia=this.wf(b.ARRAY_BUFFER,c.Ia);c.Nh=this.wf(b.ELEMENT_ARRAY_BUFFER,c.Nh)},mM:function(a){for(var b= 0,c=a.length;b<c;b+=1){var d=a[b];d.Kf=d[1].length;d[0]=this.wf(this.Pa.ARRAY_BUFFER,d[0]);d[1]=this.wf(this.Pa.ELEMENT_ARRAY_BUFFER,d[1]);this.g.jk&&d[2][10]&&!this.g.ec&&(d[2][1]=this.T.Uj(d[2][1],d[2][10],1),d[2][4]=this.T.Uj(d[2][4],d[2][10],0))}},OI:function(a){for(var b=0,c=a.length;b<c;b+=1){var d=a[b];d.Ny=d[0].length/3;d[0]=this.wf(this.Pa.ARRAY_BUFFER,d[0]);d.GD=d[1].length/3;d[1]=this.wf(this.Pa.ARRAY_BUFFER,d[1]);d.Oy=d[2].length/3;d[2]=this.wf(this.Pa.ARRAY_BUFFER,d[2]);if(this.g.jk&& d[3][2]&&!this.g.ec){var e=this.T.gr(d[3][0],d[3][1],d[3][2]);d[3][0]=e[0];d[3][1]=e[1]}}},wf:function(a,b){if(b.length){var c=this.Pa,d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,b,c.STATIC_DRAW);return d}},jV:function(a){var b=a.ma,c=b.x,d=b.y,e=b.z,g=Math.pow(2,e),h=(c+g)%g,k=h+g,l=h-g,m=null;h!==c&&(m=this.qr(e,h,d));m||l===c||(m=this.qr(e,l,d));m||k===c||(m=this.qr(e,k,d));return m?(a.status=m.status,a.qa=m.qa,a.hc=m.hc,a.Pc=m.Pc,a.Ga={building:m.Ga.building,region:m.Ga.region,road:m.Ga.road, en:(b.x-m.ma.x)/g+m.Ga.en},!0):!1},qr:function(a,b,c){if((a=this.wa.get(a+"/"+b+"/"+c))&&a.Ga)return a},Qy:function(a){var b=a.Wc,c=this.wa.get(a.ll);if(c){c.Ga||(c.Ga={en:0});c.Ga[b]=a.Ba;if("region"===b)this.cM(a.Ba);else if("road"===b)for(var d in a.Ba)a.Ba.hasOwnProperty(d)&&this.mM(a.Ba[d]);else"building"===b&&(this.OI(a.Ba),a.Xk&&a.Xk.length&&!c.Te&&(c.Te={},c.Te.je=a.Xk,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:c})));b===this.q.xa[this.q.xa.length-1]&&(c.qa=!0,this.set("display"))}},ld:function(){if(this.rg&& !this.q.ta){var a=this.q;this.g.Ey||w.Yd.ue.end({key:"rb",index:2,id:this.g.J.id});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.ia("complete"))}},kc:function(a,b){!window.wa&&this.wa&&(window.wa=this.wa);this.rk=a.rk;this.mm(a,b);this.ld();a.kD||(a.G$=this.rg,this.Tu(a,b),this.ep=this.gb,this.pi&&this.set("display",0))},gi:function(){return this.Qa},Py:function(){w.Q.uf.Yc.Go+=1;this.Qa&&w.C.I(this.Qa,"webglcontextlost",this.Py,this);this.Qa.parentNode&&this.Qa.parentNode.removeChild(this.Qa);if(1< w.Q.uf.Yc.Go)this.OD();else{var a=this.Qa.className;this.Qa=document.createElement("canvas");this.Qa.className=a;this.nD()}this.set("reload");new w.Sa.fb(w.A.Rb+"://webapi.amap.com/count?"+["type=glfail","c="+w.Q.uf.Yc.Go,"crd="+w.l.qK,"k="+w.A.key,"u="+w.A.Sm,"m="+(w.l.Y?1:0),"pf="+w.l.Pr,"dpr="+window.devicePixelRatio,"scale="+(w.l.SE||0),"detect="+w.l.ja].join("&"))},OD:function(){w.l.Je=!1;this.q&&this.q.g.J&&(this.q.g.set("baseRender",w.l.SU?"dv":"d"),this.q.g.J.fL(),this.q.Q=null,this.q.fa.up(), this.q=null);this.Qa=this.T=null},Ef:function(a){this.Qa=document.createElement("canvas");this.Qa.className=a||"amap-layer"},nD:function(){if(1<w.Q.uf.Yc.Go)return this.OD(),!1;var a=this.Pa=this.Qa.getContext(w.l.q_,w.l.r_);if(a)w.C.h(this.Qa,"webglcontextlost",this.Py,this);else return this.OD(),!1;w.pk.Jda(a,this.R0,this.S_);this.mN=a.getUniformLocation(a.ab,"u_xDelta");this.d_=a.getUniformLocation(a.ab,"u_othMatrix");this.g_=a.getUniformLocation(a.ab,"u_zoomMatrix");this.c_=a.getUniformLocation(a.ab, "u_modelMatrix");this.mf=a.getAttribLocation(a.ab,"a_Position");this.Lj=a.getAttribLocation(a.ab,"a_op");this.Kj=a.getAttribLocation(a.ab,"a_Previous");this.xh=a.getAttribLocation(a.ab,"a_Next");this.Gt=a.getAttribLocation(a.ab,"a_Tags");a.enableVertexAttribArray(this.mf);this.Sh=a.getUniformLocation(a.ab,"u_FragColor");this.mv=a.getUniformLocation(a.ab,"u_FragColor2");this.ui=a.getUniformLocation(a.ab,"u_type");this.os=a.getUniformLocation(a.ab,"u_width");this.eN=a.getUniformLocation(a.ab,"u_isDash"); this.fN=a.getUniformLocation(a.ab,"u_onlyBorder");this.bN=a.getUniformLocation(a.ab,"u_dash");this.jN=a.getUniformLocation(a.ab,"u_scale");a.enable(a.BLEND);a.enable(a.CULL_FACE);a.cullFace(a.FRONT);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.clearColor(0,0,0,0);this.Hu=this.St=this.tn=void 0;this.qk=0;return!0},Ur:function(a){var b=Math.pow(2,a.W.zoom-this.re),c=a.W.gb.Ua(this.ep).wc(this.qi);this.transform={translate:this.transform[0].translate.add(c), scale:b,rotate:0};this.gb=a.W.gb},Tu:function(a,b){var c=this.DI(a,b),d=this.Pa;d.clear(d.COLOR_BUFFER_BIT);var e=this.q.ja?this.kb:this.qp,g=0,h=0;0!==a.W.rotation?(g=2*Math.floor(a.W.Aa.Vb.x)*e,h=2*Math.floor(a.W.Aa.Vb.y)*e):(g=a.size.width*e,h=a.size.height*e);g&&h&&(this.Qa.width=g,this.Qa.height=h,d.viewport(0,0,this.Qa.width,this.Qa.height),this.vp.apply(this,c),this.Qe(a))},zp:256*Math.pow(2,20),tJ:function(a,b){w.pk.Mx([this.Sh]);for(var c=0,d=b.length;c<d;c++){var e=b[c],g=e.Ga.region;if(g&& g.length){this.Xm(e.Ga.en*this.zp);e=g.buffer;a.bindBuffer(a.ARRAY_BUFFER,e.Ia);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e.Nh);for(var h=0,k=e.Tp.length;h<k;h++){var l=e.gs[h],m=l[0];(l=l[1])&&this.g.ec&&(m=this.T.Ro(m,l),g[h].ed=m);m&&(a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,8,0),a.uniform4f(this.Sh,m[0],m[1],m[2],m[3]),a.drawElements(a.TRIANGLES,e.Tp[h][0],a.UNSIGNED_SHORT,2*e.Tp[h][1]))}}}},uJ:function(a,b){var c=w.pk,d=this.q.ja?this.kb:this.qp;c.Mx([this.Sh,this.ui,this.os]);for(var e in b)if(b.hasOwnProperty(e)){for(var g= b[e],h=0;h<g.length;h+=1){var k=g[h],l=k[2],m=l[4],n=l[10];n&&this.g.ec&&(m=this.T.Uj(m,n,0),k.ed=m);if(m){n="square"===k[2][9]?3:"round"===k[2][9]?4:2;c.Pe(a,"1i",this.ui,n);var p=this.uw(l)[1];p&&(this.Xm(k.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,k[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(this.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(this.Kj,3,a.FLOAT,!1,44,20),a.vertexAttribPointer(this.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,k[1]),k=k.Kf, c.Pe(a,"1f",this.os,p*d),c.Pe(a,"4f",this.Sh,m),this.Wm(l[5]?1:0,l[5],0),a.drawElements(a.TRIANGLES,k,a.UNSIGNED_SHORT,0))}}for(h=0;h<g.length;h+=1)if(k=g[h],l=k[2],m=this.uw(l)[0])p=l[1],(n=l[10])&&this.g.ec&&(p=this.T.Uj(p,n,1),k.ed=p),p&&(n="square"===k[2][8]?3:"round"===k[2][8]?4:2,c.Pe(a,"1i",this.ui,n),this.Xm(k.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,k[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(this.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(this.Kj,3,a.FLOAT, !1,44,20),a.vertexAttribPointer(this.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,k[1]),k=k.Kf,c.Pe(a,"1f",this.os,m*d),c.Pe(a,"4f",this.Sh,p),this.Wm(l[2]?1:0,l[2],l[6]?1:0),a.drawElements(a.TRIANGLES,k,a.UNSIGNED_SHORT,0))}},fc:new w.G(215440491,106744817),vp:function(a,b,c){if(a.length){this.hc+=1;b=this.Qa.width;c=this.Qa.height;var d=this.Pa;b=(new w.ge).dZ(-b/2,b/2,c/2,-c/2,0);c=Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:this.qp);c=(new w.ge).scale(c,c,1);var e=this.gb.wc(this.S/ Math.pow(2,this.Ni-this.zoom)).Ua(this.fc),e=(new w.ge).translate(-e.x,-e.y,0);d.uniformMatrix4fv(this.d_,!1,b.elements);d.uniformMatrix4fv(this.g_,!1,c.elements);d.uniformMatrix4fv(this.c_,!1,e.elements);d.uniform1f(this.jN,Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:1));b=this.Fm=[];for(c=a.length-1;0<=c;c-=1){e=a[c];d.disableVertexAttribArray(this.Lj);d.disableVertexAttribArray(this.Kj);d.disableVertexAttribArray(this.xh);d.disableVertexAttribArray(this.Gt);this.Wm(0,void 0,void 0);d.uniform1i(this.ui, 0);this.Xm(0);for(var g=0,h=e.length;g<h;g+=1){var k=e[g];e[g].Ga&&(k.hc=this.hc,b.push(k))}this.tJ(d,e);d.enableVertexAttribArray(this.Lj);d.enableVertexAttribArray(this.Kj);d.enableVertexAttribArray(this.xh);d.disableVertexAttribArray(this.Gt);if(e.length){for(var l={},g=0,h=e.length;g<h;g+=1){var k=e[g],m=k.Ga.road;if(m)for(var n in m)if(m.hasOwnProperty(n)){l[n]||(l[n]=[]);for(var p=0,q=m[n].length;p<q;p+=1)m[n][p].qk=k.Ga.en,l[n].push(m[n][p])}}this.uJ(d,l,e[0].ma.z)}if(!(14>this.zoom))for(d.uniform1i(this.ui, 1),this.Wm(0,void 0,void 0),d.disableVertexAttribArray(this.Lj),d.disableVertexAttribArray(this.Kj),d.disableVertexAttribArray(this.xh),d.enableVertexAttribArray(this.Gt),g=0,h=e.length;g<h;g+=1)k=e[g],k.Ga.building&&this.KC(d,k)}}},KC:function(a,b){for(var c=b.Ga.building,d=0;d<c.length;d+=1){var e=c[d],g=e[3][0],h=e[3][1];if(!e||!g)break;var k=e[3][2];k&&this.g.ec&&(h=this.T.gr(g,h,k),g=h[0],h=h[1],e.ed=g);if(g||h)g||(g=[0,0,0,0]),h||(h=[0,0,0,0]),a.uniform4f(this.mv,g[0],g[1],g[2],g[3]),a.uniform4f(this.Sh, h[0],h[1],h[2],h[3]),e.Ny&&(a.bindBuffer(a.ARRAY_BUFFER,e[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8),a.drawArrays(a.TRIANGLES,0,e.Ny)),e.Oy&&(a.bindBuffer(a.ARRAY_BUFFER,e[2]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8),a.drawArrays(a.LINES,0,e.Oy)),e.GD&&(a.bindBuffer(a.ARRAY_BUFFER,e[1]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8), a.drawArrays(a.TRIANGLES,0,e.GD))}},Wm:function(a,b,c){var d=this.Pa;a!==this.tn&&(d.uniform1i(this.eN,a),this.tn=a);a&&b!==this.St&&(this.St=b,d.uniform4f(this.bN,b[0],b[1],b[2]||0,b[3]||0));c!==this.Hu&&(d.uniform1i(this.fN,c),this.Hu=c)},Xm:function(a){a!==this.qk&&(this.Pa.uniform1f(this.mN,a),this.qk=a)},Qe:function(){this.transform={translate:{x:this.Qa.width/2,y:this.Qa.height/2},scale:this.q.ja?1/this.kb:1/this.qp,rotate:0}},oI:function(a,b,c){var d=null;if(a.length&&c)d=a[11].id+"-"+c,this.Jj[d]&& (a[0]=this.Jj[d][0],a[3]=this.Jj[d][3]);else return c=[],b&&b[0]&&(c=b[0].split("&")),(b=c[2])&&0===b.indexOf("railway")?(a[0]=1,a[3]=3):a[0]=parseInt(c[0])||0,c[3]&&c[4]&&3<c.length?(a[3]=a[0]+parseInt(c[3]),0===w.a.indexOf(c[5],"dash")&&(a[3]+=1)):a[3]=0,d&&void 0===this.Jj[d]&&(this.Jj[d]=[a[0],0,0,a[3]]),a},uw:function(a){function b(a,b,c){var d;a&&b?d=a+c%1*(b-a):0===a&&b?d=Math.max(0,c%1-0.5)/0.5*b:0===a&&0===b?d=0:0!==a&&0===b&&(d=0);return w.a.Sc(d,3)}var c=a[11].browserStyle,d=a[11].levelStyleMapping; if(18<this.zoom){var e=this.Fi(a,18,c,d);a=Math.pow(2,this.zoom-18);return[e[0]*a,e[3]*a]}if(w.a.zW(this.zoom))return e=this.Fi(a,this.zoom,c,d),[e[0],e[3]];e=this.Fi(a,Math.floor(this.zoom),c,d);c=this.Fi(a,Math.ceil(this.zoom),c,d);a=b(e[0],c[0],this.zoom);e=b(e[3],c[3],this.zoom);return[a,e]},Fi:function(a,b,c,d){a=a[11].id+"-"+b;this.Jj[a]||(this.Jj[a]=this.oI([],c[d[b]]));return this.Jj[a]}});w.Q.uf.Yc.Go=0; ')
_jsload_('vectorlayer', '(function(a){a.lL||(a.lL=function(){function a(b,c,d){for(var e=0,g=d.length;e<g;e++){var h=d.charCodeAt(e);if(128>h)b.setUint8(c++,h>>>0&127|0);else if(2048>h)b.setUint8(c++,h>>>6&31|192),b.setUint8(c++,h>>>0&63|128);else if(65536>h)b.setUint8(c++,h>>>12&15|224),b.setUint8(c++,h>>>6&63|128),b.setUint8(c++,h>>>0&63|128);else if(1114112>h)b.setUint8(c++,h>>>18&7|240),b.setUint8(c++,h>>>12&63|128),b.setUint8(c++,h>>>6&63|128),b.setUint8(c++,h>>>0&63|128);else throw Error("bad codepoint "+h);}}function c(a, b,c){var d="",e=b;for(b+=c;e<b;e++)if(c=a.getUint8(e),0===(c&128))d+=String.fromCharCode(c);else if(192===(c&224))d+=String.fromCharCode((c&15)<<6|a.getUint8(++e)&63);else if(224===(c&240))d+=String.fromCharCode((c&15)<<12|(a.getUint8(++e)&63)<<6|(a.getUint8(++e)&63)<<0);else if(240===(c&248))d+=String.fromCharCode((c&7)<<18|(a.getUint8(++e)&63)<<12|(a.getUint8(++e)&63)<<6|(a.getUint8(++e)&63)<<0);else throw Error("Invalid byte "+c.toString(16));return d}function d(a){for(var b=0,c=0,d=a.length;c< d;c++){var e=a.charCodeAt(c);if(128>e)b+=1;else if(2048>e)b+=2;else if(65536>e)b+=3;else if(1114112>e)b+=4;else throw Error("bad codepoint "+e);}return b}function e(a,b){this.offset=b||0;this.view=a}function g(c,e,h){var k=typeof c;if("string"===k){var q=d(c);if(32>q)return e.setUint8(h,q|160),a(e,h+1,c),1+q;if(256>q)return e.setUint8(h,217),e.setUint8(h+1,q),a(e,h+2,c),2+q;if(65536>q)return e.setUint8(h,218),e.setUint16(h+1,q),a(e,h+3,c),3+q;if(4294967296>q)return e.setUint8(h,219),e.setUint32(h+ 1,q),a(e,h+5,c),5+q}if(c instanceof ArrayBuffer){q=c.byteLength;if(256>q)return e.setUint8(h,196),e.setUint8(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+2),2+q;if(65536>q)return e.setUint8(h,197),e.setUint16(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+3),3+q;if(4294967296>q)return e.setUint8(h,198),e.setUint32(h+1,q),(new Uint8Array(e.buffer)).set(new Uint8Array(c),h+5),5+q}if("number"===k){if(c<<0!==c)return e.setUint8(h,203),e.setFloat64(h+1,c),9;if(0<=c){if(128>c)return e.setUint8(h, c),1;if(256>c)return e.setUint8(h,204),e.setUint8(h+1,c),2;if(65536>c)return e.setUint8(h,205),e.setUint16(h+1,c),3;if(4294967296>c)return e.setUint8(h,206),e.setUint32(h+1,c),5;throw Error("Number too big 0x"+c.toString(16));}if(-32<=c)return e.setInt8(h,c),1;if(-128<=c)return e.setUint8(h,208),e.setInt8(h+1,c),2;if(-32768<=c)return e.setUint8(h,209),e.setInt16(h+1,c),3;if(-2147483648<=c)return e.setUint8(h,210),e.setInt32(h+1,c),5;throw Error("Number too small -0x"+(-c).toString(16).substr(1)); }if("undefined"===k)return e.setUint8(h,212),e.setUint8(h+1,0),e.setUint8(h+2,0),3;if(null===c)return e.setUint8(h,192),1;if("boolean"===k)return e.setUint8(h,c?195:194),1;if("object"===k){var k=0,s=Array.isArray(c),r=null;s?q=c.length:(r=Object.keys(c),q=r.length);16>q?(e.setUint8(h,q|(s?144:128)),k=1):65536>q?(e.setUint8(h,s?220:222),e.setUint16(h+1,q),k=3):4294967296>q&&(e.setUint8(h,s?221:223),e.setUint32(h+1,q),k=5);if(s)for(s=0;s<q;s++)k+=g(c[s],e,h+k);else for(s=0;s<q;s++)var u=r[s],k=k+g(u, e,h+k),k=k+g(c[u],e,h+k);return k}throw Error("Unknown type "+k);}function h(a){var b=typeof a;if("string"===b){var c=d(a);if(32>c)return 1+c;if(256>c)return 2+c;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if(a instanceof ArrayBuffer){c=a.byteLength;if(256>c)return 2+c;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if("number"===b){if(a<<0!==a)return 9;if(0<=a){if(128>a)return 1;if(256>a)return 2;if(65536>a)return 3;if(4294967296>a)return 5;if(1.8446744073709552E19>a)return 9;throw Error("Number too big 0x"+ a.toString(16));}if(-32<=a)return 1;if(-128<=a)return 2;if(-32768<=a)return 3;if(-2147483648<=a)return 5;if(-9223372036854775E3<=a)return 9;throw Error("Number too small -0x"+a.toString(16).substr(1));}if("undefined"===b)return 3;if("boolean"===b||null===a)return 1;if("object"===b){b=0;if(Array.isArray(a))for(var c=a.length,e=0;e<c;e++)b+=h(a[e]);else for(var g=Object.keys(a),c=g.length,e=0;e<c;e++)var k=g[e],b=b+(h(k)+h(a[k]));if(16>c)return 1+b;if(65536>c)return 3+b;if(4294967296>c)return 5+b;throw Error("Array or object too long 0x"+ c.toString(16));}throw Error("Unknown type "+b);}var k={};k.Roa=a;k.Qoa=c;k.Poa=d;e.prototype.map=function(a){for(var b={},c=0;c<a;c++){var d=this.parse();b[d]=this.parse()}return b};e.prototype.FI=function(a){var b=new ArrayBuffer(a);(new Uint8Array(b)).set(new Uint8Array(this.view.buffer,this.offset,a),0);this.offset+=a;return b};e.prototype.yE=function(a){var b=c(this.view,this.offset,a);this.offset+=a;return b};e.prototype.vI=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=this.parse();return b}; e.prototype.parse=function(){var a=this.view.getUint8(this.offset);if(160===(a&224))return this.offset++,this.yE(a&31);if(128===(a&240))return this.offset++,this.map(a&15);if(144===(a&240))return this.offset++,this.vI(a&15);if(0===(a&128))return this.offset++,a;if(224===(a&224))return a=this.view.getInt8(this.offset),this.offset++,a;if(212===a&&0===this.view.getUint8(this.offset+1))this.offset+=3;else{switch(a){case 217:return a=this.view.getUint8(this.offset+1),this.offset+=2,this.yE(a);case 218:return a= this.view.getUint16(this.offset+1),this.offset+=3,this.yE(a);case 219:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.yE(a);case 196:return a=this.view.getUint8(this.offset+1),this.offset+=2,this.FI(a);case 197:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.FI(a);case 198:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.FI(a);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 204:return a=this.view.getUint8(this.offset+ 1),this.offset+=2,a;case 205:return a=this.view.getUint16(this.offset+1),this.offset+=3,a;case 206:return a=this.view.getUint32(this.offset+1),this.offset+=5,a;case 207:var a=this.view.getUint32(this.offset+1),b=this.view.getUint32(this.offset+5);this.offset+=9;return 4294967296*a+b;case 208:return a=this.view.getInt8(this.offset+1),this.offset+=2,a;case 209:return a=this.view.getInt16(this.offset+1),this.offset+=3,a;case 210:return a=this.view.getInt32(this.offset+1),this.offset+=5,a;case 211:return a= this.view.getInt32(this.offset+1),b=this.view.getUint32(this.offset+5),this.offset+=9,4294967296*a+b;case 222:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.map(a);case 223:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.map(a);case 220:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.vI(a);case 221:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.vI(a);case 202:return a=this.view.getFloat32(this.offset+1),this.offset+=5,a;case 203:return a= this.view.getFloat64(this.offset+1),this.offset+=9,a}throw Error("Unknown type 0x"+a.toString(16));}};k.Pj=function(a){var b=new DataView(a),b=new e(b),c=b.parse();if(b.offset!==a.byteLength)throw Error(a.byteLength-b.offset+" trailing bytes");return c};k.BJ=function(a){var b=new ArrayBuffer(h(a)),c=new DataView(b);g(a,c,0);return b};return{TU:function(a,b){b(null,{pu:a.pu,Wc:a.Wc,Ba:k.BJ(a.Ba)})},EU:function(a,b){b(null,{pu:a.pu,Wc:a.Wc,Ba:k.Pj(a.Ba)})}}},a.zu=a.l.vn?new a.Os(a.lL,{hostWorker:a.fD, clientId:"msg",lazy:"untilCall"}):new a.Os(function(){},{hostWorker:a.fD,clientId:"msg",lazy:"untilCall"}))})(w);!w.rF&&w.l.vn&&(w.rF=function(){function a(a,b){return a.bind?a.bind(b):function(){a.apply(b,arguments)}}function b(){v="unsupport";p.length=0;c();this.r("disable")}function c(){r&&(clearTimeout(r.Oaa),r.onopen=r.onmessage=r.onerror=null,3!==r.readyState&&r.close(),r=null)}function d(){B=!0;this.flush();this.r("open")}function e(){B?(v="closed",c()):b.call(this)}function g(a,b){if("unsupport"===v)return!1;"connected"===v?h.call(this,a):("closed"===v&&this.Naa(),p.push({data:a,jz:b}));x+=1}function h(a){var c= this;r.readyState===WebSocket.OPEN&&(r.send(a),t&&clearTimeout(t),t=setTimeout(function(){b.call(c);t=null},5E3),y&&clearTimeout(y),y=setTimeout(function(){c.close();y=null},1E4))}var k=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,l={},m="undefined"===typeof window||!k,n=null,p=[],q=[],s=+new Date,r=null,u=1,v="closed",x=0,t=null,y=null,B=!1;m||(l.Dea=function(){if(q.length){var a=w.A.Rb+"://webapi.amap.com/count?",b=["type=v","k="+w.A.key,"u="+w.A.Sm,"m="+(w.l.Y?1:0),"pf="+w.l.Pr,"frq="+ q.join(",")];new w.Sa.fb(a+b.join("&"))}},w.extend(l,w.ka),w.event.V(window,"beforeunload",l.Dea,l));l.tfa=function(a){if("encode"===a.Wc)g.call(this,a.Ba);else if("decode"===a.Wc)if(a=a.Ba,"ack"===a.type)switch(a.command){case "tiles":this.r("ack",a);break;case "retain":v="connected";this.flush();break;case "close":b.call(this)}else 0===a.content.errcode&&("tiles"===a.type?this.r("tiles",a):"traffic"===a.type&&this.r("traffic",a))};l.Jha=function(a){x=a};l.ir=function(){return x};l.close=function(){r&& (v="closed",r.close())};l.Naa=function(){var c=this;"closed"===v&&(null===n&&(n=m?this.A.yN+"://"+this.A.vv:w.A.yN+"://"+w.A.vv),r=new WebSocket(n),r.binaryType="arraybuffer",v="connecting",r.onopen=a(d,this),r.onclose=a(e,this),r.onerror=a(b,this),r.ontimeout=a(b,this),r.onmessage=a(this.ufa,this),r.Oaa=setTimeout(function(){r.readyState!==WebSocket.OPEN&&b.call(c)},1200))};l.wy=function(){return"connected"===v};l.Rda=function(){return"closed"===v};l.flush=function(){if("connected"===v){for(var a= 0,b=p.length;a<b;a++)h.call(this,p[a].data);p.length=0}};l.SK=function(){return"unsupport"!==v};l.send=function(a){var b=this,c=u++;a={Wc:"encode",Ba:a,pu:s};var d=this.TU;m||(d=w.zu.TU);d(a,function(a,d){a||g.call(b,d.Ba,c)});return c};l.QU=function(a){for(var b=0,c=p.length;b<c;b++)if(p[b].jz===a)return p.splice(b,1),!0;return!1};l.p$=function(a){q.push(a)};l.ufa=function(a){var b=this;t&&(clearTimeout(t),t=null);var c=this.EU,d=self.vx;m||(c=w.zu.EU,d=w.zu.vx);d([a.data]);c({pu:s,Wc:"decode",Ba:a.data}, function(a,c){a||b.tfa(c)})};return l});w.Mh={ZZ:function(){0===w.Da.be&&w.Mh.aW()},Ooa:function(a,b){if(!a)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]&&a[c].Tn===b)return!0},raa:function(a,b){var c="limg-"+a.key+"-"+b.q.Ac;w.Da[c]&&delete w.Da[c]},mV:function(a){return w.Da[a.Tn?a.Tn:a]},$k:function(a){var b=null,c=null,d=!1;a.Tn?(b=a,c=b.Tn,(a=b.url)&&(d=!0)):c=a;var e=w.Da[c];d&&e&&e.src!==a&&(e=w.Da[c]=null);if(!e&&a){d="data:"===a.substr(0,5);e=document.createElement("img");d||(e.crossOrigin="Anonymous");w.Da[c]=e;e.loaded=!1; w.Da.be+=1;w.C.h(e,"load",this.jD,this);w.C.h(e,"error",this.$V,this);var g=this;e.iv=setTimeout(function(){e.loaded||g.aW()},300);e.src=a;b&&(e.jla=c,b.url=null)}},aW:function(){for(var a=0;a<w.Da.Np.length;a+=1)w.Da.Np[a].set("display")},jU:function(a){w.C.I(a,"load",this.jD,this);w.C.I(a,"error",this.$V,this)},jD:function(a){a=a.target;a.loaded=!0;w.Da.be-=1;this.jU(a);this.ZZ();a.iv&&(clearTimeout(a.iv),a.iv=null)},$V:function(a){a=a.target;a.loaded=!1;w.Da.be-=1;this.jU(a);this.ZZ();a.iv&&(clearTimeout(a.iv), a.iv=null)}};w.w.vk=w.w.qc.extend({B:function(a,b,c){this.bC=c;w.Da.Np.push(this);this.Ac=w.a.wV("layer");this.kb=2;a.get("textRatio");this.MN=25;this.X("tiles",a);this.yja=a.get("vdataUrl")||b.J.get("vdataUrl")||w.A.vv;this.ji=!0;this.fa=a;this.tj=w.l.Y?!1:!0;this.g=b;this.ai=this.$h=!0;this.he("zoom center centerCoords resolution coordsBound styleID iconsID businessIconsID forceBig mode display".split(" "),b);this.he("zooms detectRetina visible merge sort zIndex textIndex watermark opacity".split(" "),a);this.X("lang", b,!0);this.get("watermark")&&(this.xv=new Image,this.xv.src=this.get("watermark"));this.Soa="v4";this.wa={};this.fi={};this.ee=256;this.Ir=[];this.Ge=this.df=0;this.ja=w.l.ja&&this.get("detectRetina");this.ee=256*(this.ja?2:1);this.X("mapStyle",b);this.X("style",b);this.dn=0;this.X("features",b);this.De=18;this.X("reload",a)},mapStyleChanged:function(){this.get("mapStyle");this.td=!1;if(this.g.get("styleUrl")||"normal"===this.get("mapStyle"))this.td=!!this.g.get("showBuildingBlock");this.featuresChanged()}, featuresChanged:function(){this.set("reload")},langChanged:function(){this.set("reload");this.fa.up()},Q9:function(){var a=!1,b=this.iQ();if(b){if(this.qh){var c="active"===this.qh.ww;b.aw(this.qh);c&&(b.hq(this.qh,"active"),a=!0)}w.l.maa&&!a&&b.NB()}},Vv:function(){this.Q9()},Az:function(a,b){var c=!0;if("hotspotout"===a)this.g.J.set("optimalCursor",null);else if("hotspotover"===a)this.g.J.set("optimalCursor","pointer");else if("mouseup"===a||"mousedown"===a)c=!1;var d=this.iQ();if(d)switch(a){case "hotspotout":d.SB(b); break;case "hotspotover":d.hq(b,"hover");break;case "mouseup":d.hq(b,"hoverup");break;case "mousedown":d.hq(b,"active")}c&&(c=b.Oa,c=new w.G(c[0],c[1]),c=this.g.qe(c,3),this.g.J.r(a,{name:b.name,lnglat:c,id:b.gl,isIndoorPOI:b.PK}))},iQ:function(){if(!w.l.iW){var a=this.Q||this.pm;if(!a)return null;var b=this.g?this.g.J.get("hotspotOptions"):{},b=w.extend({},b);if(b.disableHighlight)return null;this.gx||(this.gx=new w.w.vk.I0(a));return this.gx}},jo:function(a){(a=this.FV(a))&&this.Az("hotspotclick", a)},rt:function(a){var b="mousemove"===a.type;if(!this.g.Vf||!b){var c=this.FV(a);switch(a.type){case "mousemove":case "mouseup":case "mousedown":c&&this.qh!==c&&(this.qh&&this.Az("hotspotout",this.qh),this.Az("hotspotover",c)),!c&&this.qh&&this.Az("hotspotout",this.qh),c&&!b&&this.Az(a.type,c)}this.qh=c}},textIndexChanged:function(){this.set("display")},yfa:function(){this.g.h("click",this.jo,this);this.g.h("mousemove",this.rt,this);this.g.h("mousedown",this.rt,this);this.g.h("mouseup",this.rt,this)}, YI:function(){this.g.I("click",this.jo,this);this.g.I("mousemove",this.rt,this);this.g.I("mousedown",this.rt,this);this.g.I("mouseup",this.rt,this)},Tl:function(){return null},mn:function(){var a=this.yr?null:this.g.J.get("forceZooms");return{ji:!0,ee:256,visible:this.get("visible"),gd:a||this.get("zooms"),kC:this.tj&&this.ta,$h:!this.g.FE,ai:!this.g.FE,opacity:this.get("opacity"),qd:!1}},Jl:function(a){if(w.Q.canvas.vk)return new w.Q.canvas.vk(this,a)},Cx:function(a){0===a.indexOf("amap://styles/")&& (a="normal");var b=this.get("forceBig")||w.l.Y&&!this.ja?"6":"5";this.url=w.A.Rb+"://"+this.yja+"/tiles?mapType="+a+"&v="+(w.Lc?3:2)+"&style="+b;this.url+=this.ja?"&rd=2":"&rd=1";this.url+="&flds="+this.xa;this.url+="&t="},styleChanged:function(){this.g.ec||this.featuresChanged()}}); w.w.Yc=w.w.vk.extend({Jl:function(a){var b=this;if(!b.xv&&w.l.Je&&"vw"===b.g.get("baseRender")){var c=["wgl"];this.g.ec&&c.push("wgl2");if(w.hb.yy(c))return new w.Q.uf.Yc(b,a)}else if(c=["cmng","cgl"],this.g.ec&&c.push("cgl2"),w.hb.yy(c))return new w.Q.canvas.Yc(b,a);w.hb.eg(c,function(){b.set("display")})},featuresChanged:function(){var a=this.get("features"),b=[];"all"===a?b=this.bC:a&&(-1!==w.a.indexOf(a,"bg")&&-1!==w.a.indexOf(this.bC,"region")&&b.push("region"),-1!==w.a.indexOf(a,"building")&& -1!==w.a.indexOf(this.bC,"building")&&b.push("building"),-1!==w.a.indexOf(a,"road")&&-1!==w.a.indexOf(this.bC,"road")&&b.push("road"));this.xa=b;this.Cx(this.get("mapStyle")||"normal");this.set("reload")}});w.w.T0=w.w.Yc.extend({B:function(){this.kl(arguments);this.De=this.hm=17;this.xa=["building"];this.td=!0;this.Cx(this.get("mapStyle")||"normal");this.yr=!0},featuresChanged:function(){},mapStyleChanged:function(){}}); w.w.Wh=w.w.vk.extend({Jl:function(a){var b=this;if(this.FK()){if(this.rv=!0,w.Q.canvas.uF)return this.XT(),a=new w.Q.canvas.uF(this,a),a.h("afterLabelRender",this.Vv,this),a}else{b.rv=!1;if(w.Q.canvas.tF)return a=new w.Q.canvas.tF(this,a),a.h("afterLabelRender",this.Vv,this),a;a=["cmng","labelcanvas"];w.l.vJ&&a.push("labelDir");w.hb.eg(a,function(){b.set("display")})}},FK:function(){var a=this.get("mapStyle");return"normal"!==a&&"amap://styles/normal"!==a||this.g.get("nolimg")?!1:w.l.rv?!0:!1},Ada:function(){var a= this.get("mapStyle");return"normal"!==a&&"amap://styles/normal"!==a||this.g.get("nolimg")||w.l.qd||w.l.Y?!1:!0},featuresChanged:function(){var a=this.get("features"),b=this.get("mapStyle"),c=[];"all"===a?c=["roadlabel","poilabel"]:a&&(-1!==w.a.indexOf(a,"road")&&c.push("roadlabel"),-1!==w.a.indexOf(a,"point")&&c.push("poilabel"));a=this.FK();c.length&&(a||this.Ada())&&c.unshift("limg");this.xa=c;this.Cx(b);this.set("reload");(b=this.Q||this.pm)&&a^this.rv&&(this.gx&&(this.gx=this.gx.Q=null),b.I("afterLabelRender", this.Vv,this),b.Vt(),this.pm=this.Q=null)},XT:function(){this.Cr=w.A.Rb+"://"+(this.fa.get("vdataUrl")||this.g.J.get("vdataUrl")||w.A.vv)+"/limg?";var a=this.ja?2:1;this.Cr+="&font="+(w.l.Y&&!this.ja?"big":"small");this.Cr+="&scl="+a;this.Cr+="&t="},FV:function(a){return a.tf?(a=this.sV(this.g.bc(a.tf,20),!0))?a[0]:null:null},sV:function(a,b){var c=this.g.XC();if(c&&(c=c.nr(this)))return c.eu(a,b)}});w.w.vk.I0=w.aa.extend({B:function(a){this.w9(a)},w9:function(a){this.Q=a},SB:function(a){if(a.ww){a.ww=!1;var b=this.Q;b&&b.SB.apply(b,arguments)}},aw:function(a){a.ww=!1;var b=this.Q;b&&b.aw.apply(b,arguments)},hq:function(a,b){b||(console.warn("hlStyle is required, e.g. hover, active.."),b="hover");if(a.ww!==b){a.ww=b;var c=this.Q;c&&c.hq.apply(c,arguments)}},NB:function(){var a=this.Q;a&&a.NB()}});w.Ls={Ax:function(a,b){this.zf={};this.zf.pu=w.a.Jb(this.zf);b.Ic||(b.Ic=w.rF());this.Ic=b.Ic;this.Ic.h("tiles",this.RD,this);this.Ic.h("ack",this.QD,this);this.Ic.h("disable",this.PD,this)},xT:function(){if(this.eh&&!this.ak&&w.Uh.Bja||this.ak&&w.Uh.hea||!this.ak&&!this.eh&&this.ji&&w.kf.Eda)return!0},Yw:function(a){this.Cf=w.a.Ut(this.Cf,a)},qo:function(){return w.a.keys(this.Af).length?!0:!1},aB:function(a){w.a.Pb(a,function(a){w.Mh.$k(a)})},fA:function(){for(var a=this.Cf.length-1;0<=a;a--){var b= this.Cf[a];b.aq||b.abort()}this.Cf.splice(0,this.Cf.length)},Fu:function(a){if(this.q&&a.XK===this.q.Ac){this.Se||this.If?this.MH([this.q,"groupcomplete",null,null,"allbase"]):(this.Ri(),this.wq.AC(this.q,"groupcomplete",null,null,"allbase"));for(var b=0,c=a.Uc.length;b<c;b+=1)this.Qy(a.Uc[b],a.uu,a.Vu,a.Y)}},Qy:function(a,b){var c=a.Wc,d=this.wa.get(a.ll);if(d){var e=this.q.xa;d.xa||(d.Ga={},d.xa=[]);var g="";(this.g.jk&&!this.g.ec||this.Nda&&this.g.ec)&&this.KJ(c,a.Ba);"poilabel"===c||"roadlabel"=== c?(a.Qd||(g=a.Ba,a.Qd=null),d.xa.push.apply(d.xa,a.Ba),c===this.q.xa[this.q.xa.length-1]&&(d.Qd=null)):d.Ga[c]=a.Ba;"building"!==c&&"poilabel"!==c||!a.Xk||d.Te||(d.Te={},d.Te.je=a.Xk,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:d}));if("roadlabel"!==c&&"poilabel"!==c||this.sW||!w.l.vJ&&!this.g.ec)this.Se||this.If?this.MH([this.q,g,d,b,c]):(this.Ri(),this.wq.AC(this.q,g,d,b,c));c===e[e.length-1]&&(c="roadlabel"===c||"poilabel"===c?"labels":"allbase",this.Se||this.If?this.MH([this.q,"tileComplete",d, b,c]):(this.Ri(),this.wq.AC(this.q,"tileComplete",d,b,c)))}},nA:function(){if(this.g){var a=this.g.J.getMapStyle();this.jp=a;this.i5(a);this.Ic&&this.Ic.SK()&&(-1!==a.indexOf("amap://styles")&&(a="normal"),a={command:"status",payload:{mapType:a,style:w.l.Y&&!this.q.ja?"6":"5",rd:this.q.ja?2:1}},this.g.J.get("workerMode")&&this.xT()?(w.kf.caa(a,w.a.pp),this.Ic.Rda()||this.Ic.close()):this.Ic.send(a))}},mapStyleChanged:function(){this.nA()},styleChanged:function(){this.nA()},PD:function(){for(var a in this.zf)this.zf.hasOwnProperty(a)&& this.zf[a].Nb&&(this.yk(this.zf[a].Nb,this.zf[a].nc),delete this.zf[a],delete this.Af[a]);this.Ic=null;this.mj("mapStyle");this.set("display",1)},QD:function(a){var b=a.reqId;this.zf[b]&&(!a.content.status&&this.zf[b]&&this.yk(this.zf[b].Nb,this.zf[b].nc),delete this.zf[b],delete this.Af[b])},RD:function(a){var b=a.reqId;if((!/-1$/.test(b)||!this.qo())&&this.zf[b]){var c=a.content.opt,d=this.zf[b].Nb[0];c!==this.Ta&&!d.xg||d.xg&&2<(this.qo()||Math.abs(c-this.Ta))?this.yk(this.zf[b].Nb,this.zf[b].nc): this.Lr(a.content.data,c)}},sI:function(a,b){var c=a.ze,d=null;!this.bg&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&18>=c.nc&&(b?d={Qd:!0,data:a.cba,url:this.kn(a.nc,[]),w:this.q,"x-vd-v":c.Ed,tv:c.rf,bgc:this.g.vd,vdataVersion:c.Ud,td:this.g.J.get("showBuildingBlock")}:this.ME||(d={Uc:a.data.Uc,"x-vd-v":c.Ed,tv:c.rf,bgc:this.g.vd,vdataVersion:c.Ud,Je:!!this.bg,url:this.kn(a.nc,[]),w:this.q,td:this.g.J.get("showBuildingBlock")}));d&&w.ym.set(d)},cL:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]? arguments[2]:!1;if(a.length)if(this.wY)this.tX=!0;else{void 0===this.Cf&&(this.Cf=[]);c||this.fA();void 0===this.Af&&(this.Af={});var d=1,e=[],g=this;18<b&&(d=Math.pow(2,b-18));for(var h=Math.pow(2,20-a[0].ma.z),k=0;k<a.length;k+=1){var l=a[k],m=l.ma;l.nc=b;m.S=h;if(18<b&&!this.bg){for(var n=0;n<d;n+=1)for(var p=0;p<d;p+=1){var q=new w.Xa(new w.uk(b,d*m.x+n,d*m.y+p));this.wa.Fc(q.key)||(this.wa.set(q.key,q),q.status="loading")}this.wa.set(l.key+"/"+b,l)}else this.wa.set(l.key,l),this.bg&&10>m.z&& this.jV(l)?this.set("display",0):l.status="loading"}this.B8(a,b,w.a.bind(function(a,d){var g=this;if(d.length){for(var h=0,k=d.length;h<k;h++){var l=d[h].ma,m=l.x,n=l.y,l=l.z;if(10>l){var p=Math.pow(2,l);if(m>=p||0>m)m=(m+p)%p}m=w.a.LC(m,n,l).join(",");w.a.ga(e,m)||e.push(m)}h=this.I3({Fia:d,xg:c,nc:b,$M:e});if(this.g.J.get("workerMode")&&this.xT())if(this.eh)w.Uh.aj(h,function(a,c){null!==c.data&&g.g&&(void 0===w.Uh.Wv&&(w.Uh.Wv=!0),c.GW?g.yk(c.Nb,b):(c.bk&&g.EB(),g.ak?(w.a.Pb(c.Nb,function(a){this.wa.set(a.key, a);a.Qd&&!a.Qd.loaded&&(w.Mh.$k(a.Qd,!0),a.Qd.loaded=!0);a.M&&a.M.Da&&this.aB(a.M.Da);a.Te&&a.Te.je&&w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:a})},g),g.set("display"),g.sI(c,!0)):(w.a.Pb(c.Nb,function(a){var b=this.wa.get(a.key);b&&(b.status=a.status,a.M&&a.M.Da&&this.aB(a.M.Da))},g),g.sI(c),c.data&&g.Fu(c.data))))});else{var q=w.kf.aX;if(!this.g.J.ta||w.kf.rba)q=w.kf.aj;this.nA();q(h,function(a,c){if(g.g){void 0===w.kf.Wv&&(w.kf.Wv=!0);c.GW&&g.yk(c.Nb,b);if(q===w.kf.aX){if(c.disabled){w.kf.rba= !0;g.set("display");return}if(c.d$)return}c.bk&&g.EB();c.data&&(g.g.vd!==c.Mq&&(g.g.vd=c.Mq),w.a.Pb(c.Nb,function(a){var b=this.wa.get(a.key);b&&(b.status=a.status,a.M&&a.M.Da&&this.aB(a.M.Da))},g),g.aB(c.icons),g.sI(c),c.data&&g.Fu(c.data))}})}else!this.eh&&this.Ic&&this.Ic.SK()?this.g.J.get("workerMode")?this.bB(d,b,e,c):(1>this.Ic.ir()||3<this.Bq?this.bB(d,b,e,c):((2===this.Ic.ir()||this.Ic.wy())&&this.nA(),this.A5(d,b,e,c)),this.Ic.Jha(this.Ic.ir()+1),this.Ic.TW&&this.Ic.p$(Math.ceil((new Date- this.Ic.TW)/1E3)),this.Ic.TW=new Date):this.bB(d,b,e,c)}},this));window.renderDelay&&(this.wY=setTimeout(function(){g.tX&&g.set("display",!1);g.tX=!1;g.wY=null},window.renderDelay))}},i5:function(a){a&&"normal"!==a&&0!==a.indexOf("amap://styles/")?this.ME=!0:this.ME=!1},B8:function(a,b,c){if(!this.bg&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&(this.ak||!this.ME)&&18>=b){var d=w.ym,e=this,g=this.g,h=g.J;g.Ey||void 0!==g.AD||("dv"===h.get("baseRender")?g.AD=1:g.AD=2);d.get({type:h.ta?"NFS":"FS",td:this.q.yr|| this.q.td,Bia:a,Je:!!this.bg,w:this.q,url:this.kn(b,[]),timeout:500},function(d,h){if(e.q){if(!d&&h.DK.length){h.DK.length===a.length&&(g.Ey||g.AD--,e.EB());if(h.Uc){e.Ed=h.ze["x-vd-v"];e.rf=h.ze.tv;var m=h.ze.bgc;e.g.vd!==m&&(e.g.vd=m);h.DK.forEach(function(a){a.status="loaded"});m=e.EG(b,h.Uc);e.Fu(m)}else h.iea.forEach(function(a){e.Du(a,b,[],h.ze["x-vd-v"],!0)}),e.set("display");a=h.Oea}c(null,a)}})}else c(null,a)},A5:function(a,b,c,d){if(!d||!this.qo()){var e=[(new Date).getTime(),this.Ic.ir()+ 1&65535,d?1:0].join("-");d||(this.Af[e]=1);var g={command:"tiles",reqId:e,payload:{t:c,opt:b,cs:{level:b,flds:this.q.xa.join(","),v:w.Lc?"3":"2"}}},h;if(!this.Ic.wy()){var k=this;setTimeout(function(){k.Ic&&!k.Ic.wy()&&(k.Bq?k.Bq++:k.Bq=1,k.Ic.QU(h)&&(delete k.zf[e],delete k.Af[e],k.bB(a,b,c,d)))},300)}h=this.Ic.send(g);this.zf[e]={Nb:a,nc:b}}},wL:function(a){if(!a.ta||a.xg)a.status="",a.ta=void 0,a.qa=null,a.tc=null,a.Jc&&(a.Jc.tc=null,a.Jc.Jc=null,a.Jc=null),this.wa.Sn(a.key)},I3:function(a){var b= a.Fia,c=a.nc,d=a.$M;a=a.xg;var e=+new Date,g=this.eh&&w.Uh&&!w.Uh.Wv||!this.eh&&w.kf&&!w.kf.Wv;return{Ac:e,Mq:this.g.vd,eh:this.eh,ak:this.ak,td:this.q.td,Oda:!!w.Lc,Je:this.bg,WK:this.q.Ac,xa:this.q.xa,qd:this.q.ja,kb:this.q.kb,sK:Math.ceil(this.Mf.gD),Nb:w.a.filter(b,function(a){return"loaded"!==a.status}),nc:c,$M:d,xg:a,url:this.kn(c,d,b)+"&_id="+e,de:this.EG(c,[],g)}},EG:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;w.Lc&&1<w.Lc.length&&(w.Lc=w.Lc[this.q.get("forceBig")|| w.l.Y&&!this.q.ja?1:0]);var d=w.Lc||null,e={Mda:"3D"===this.q.g.J.view.type,Y$:this.q.td,pC:w.A.pC||null,wla:this.q.get("businessIconsID"),Ed:this.Ed,rf:this.rf,Mma:this.q.get("iconsID"),XK:this.q.Ac,uu:a,mu:this.q.mu,Ky:this.q.fa.get("merge"),Uc:b,Y:this.q.get("forceBig")||w.l.Y,mode:this.q.get("mode"),vga:w.A.Rb,KY:this.q.get("forceBig")?1:this.q.kb,Vu:this.q.get("forceBig")?!1:this.q.ja};c&&(e.Lc=d);return e},gw:function(a){a=a.split(";");for(var b=0,c=a.length;b<c;b+=1){a[b]=a[b].split(",");for(var d= 0,e=a[b].length;d<e;d+=1)a[b][d]=parseInt(a[b][d],36)}return a},Lr:function(a,b,c){if(this.q){for(var d=[],e=0,g=a.length;e<g;e+=1){var h=a[e];h&&(c&&(h=JSON.parse(h)),h["x-vd-v"]?(this.Ed=h["x-vd-v"],this.rf=h.tv,this.Ud=[h.tv,h.vdv].join("-"),h.bgc&&(h="#"+h.bgc.substring(2),this.g.vd!==h&&(this.g.vd=h))):this.Du(h,b,d))}if(d.length){var k=this;a=null;var l;this.bg?(a=w.WE,l=a.RX):(a=w.zu,l=this.eh?a["label:parseLabel"]:a["base:parseDataToVector"]);(function(){l(k.EG(b,d),function(a,c){if(k.q&& !a){var d=c.icons;if(d)for(var e=0;e<d.length;e+=1)w.Mh.$k(d[e]);!this.bg&&(w.l.gf||w.l.bj&&!k.g.J.ta)&&(k.ak||!k.ME)&&18>=b&&w.ym.set({Uc:c.data.Uc,"x-vd-v":k.Ed,tv:k.rf,bgc:k.g.vd,Ud:k.Ud,Je:!!k.bg,url:k.kn(10,[]),w:k.q,td:k.q.td},function(){});c.data&&k.Fu(c.data)}})})()}}},Du:function(a,b,c){function d(d,e,g){e=[g,d,e].join("/");18<b&&!l.bg&&(e+="/"+b);if((d=l.wa.get(e))&&"loaded"!==d.status)if(l.PZ(d,p)||d.xg){if(-1!==n.indexOf(m))if("limg"===m){if(e=a[1],d.Qd=e,"string"===typeof e.b&&(e.b=l.gw(e.b)), g="",g="object"===typeof e.u?e.u.url:e.u)d={url:g,Tn:"limg-"+d.key+"-"+l.q.Ac},e.u=d,w.Mh.$k(d,!0)}else{e={ti:d.ma,ll:e,Ba:a,Wc:m,mu:l.q.mu,EI:l.g.vd,NK:"building"===m,dh:"poilabel"===m||"roadlabel"===m||"building"===m&&l.q.td};if("poilabel"===m||"roadlabel"===m)e.Qd=d.Qd;m===n[n.length-1]&&(d.status="loaded");c.push(e)}}else l.yM(b,d,p,w.a.bind(l.wL,l)),18<b&&l.wa.Sn(e)}var e=a[0].split("-"),g=parseInt(e[1]),h=parseInt(e[2]),k=parseInt(e[0]),l=this,m=e[3],n=this.q.xa,p=18<b?Math.pow(2,b-18):1,e= l.Mf.gD,q=Math.pow(2,k);10>k&&(g<=e&&d(g+q,h,k),g>=q-e&&d(g-q,h,k));d(g,h,k)},MH:function(a){this.Iq||(this.Iq=[]);this.Iq.push(a)},Ri:function(){if(this.Iq&&this.Iq.length){for(var a=0,b=this.Iq.length;a<b;a+=1)this.wq.AC.apply(this.wq,this.Iq[a]);this.Iq=[]}},yk:function(a,b){for(var c=18<b?Math.pow(2,b-18):1,d=0;d<a.length;d+=1){var e=a[d];this.yM(b,e,c,w.a.bind(this.wL,this));18<b&&this.wa.Sn(e.key+"/"+b)}w.l.gf&&w.ym.Sn({Nb:a,url:this.kn(b,[]),w:this.q,Je:!!this.bg,td:this.q.td})},kn:function(a, b,c){return this.q.url+b.join(";")+"&lv="+a+"&preload="+(c&&c[0]&&c[0].xg?1:0)},j4:function(){var a=this.q.url,b="rb";if(/\\/limg/.test(a)||/flds=[^&]+label/.test(a))b="rl";return b},EB:function(){this.g.Ey||w.Yd.ue.end({key:this.j4(),index:0,id:this.g.J.id})},bB:function(a,b,c){function d(a,c){var d=a.split("|");d[0]=c+d[0];var e=d,g="";d[d.length-1]&&(g=d[d.length-1],e=d.splice(0,d.length-1));l.Lr(e,b,!0);return g}var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,g=new XMLHttpRequest; g.wp=[(new Date).getTime(),e?1:0].join("-");e||(this.Af[g.wp]=1);var h=this.kn(b,c,a),k=0,l=this;g.En="";g.onreadystatechange=function(){if(l.q&&!(2>g.readyState)){var c=4===g.readyState&&0===g.status;(b!==l.Ta&&!a[0].xg||a[0].xg&&(b>l.Ta||2<l.Ta-b)||c)&&!g.aq?(g.aq=!0,l.yk(a,b),g.onreadystatechange="",c||g.abort(),e?l.Yw(g):delete l.Af[g.wp]):g.aq||(3===g.readyState?(c=g.responseText.substring(k),g.En=d(c,g.En),k=g.responseText.length):4===g.readyState&&(l.EB(),delete l.Af[g.wp],c=g.responseText.substring(k), l.eh&&(c+="|"),d(c,g.En),g.En="",l.g.J.ta||w.Yd.ue.push({id:l.g.J.id,key:"ds",Un:g.responseText.length/2}),e&&l.Yw(g)))}};g.onerror=function(){};this.yK||(this.yK=1);g.open("GET",h,!0);g.send();e&&this.Cf.push(g)},PZ:function(a,b){var c=this.tm||this.Mf,d=a.ma.x,e=a.ma.y;return d>Math.floor(c.Sd/b)||d<Math.floor(c.pe/b)||e>Math.floor(c.yd/b)||e<Math.floor(c.zd/b)?!1:!0},yM:function(a,b,c,d){if(18<a){b=b.ma;for(var e=0;e<c;e+=1)for(var g=0;g<c;g+=1){var h=new w.uk(a,c*b.x+e,c*b.y+g)+"";(h=this.wa.get(h))&& d(h)}}else d(b),b.Jc&&d(b.Jc)}};w.Q.canvas.Wh=w.Q.zi.extend({ga:[w.Ls],B:function(a,b){arguments.callee.oa.apply(this,arguments);this.Ac=w.a.Jb(this);this.Cm=300;this.De=a.De;this.eh=this.ji=!0;this.X("mapStyle",a.g);this.X("style",a.g);this.ak=!0;this.zt=1;var c=this;this.wQ=function(){c.Yea=!0;c.set("display",0)};this.Ef();this.aL(a)},aL:function(a){a=w.l.Y||a.ja?"big":"small";var b=w.A.Rb+"://vdata.amap.com/style_icon/icon-biz-"+a+".png";w.Mh.$k(w.A.Rb+"://vdata.amap.com/style_icon/icon-normal-"+a+".png",!0);w.Mh.$k(b,!0)},hw:function(a){w.Mh.raa(a, this);var b=w.Q.canvas.Wh.rc.hw;b&&b.apply(this,arguments)},Ef:function(){this.Ck=document.createElement("canvas");this.Ck.className="amap-labels";this.Ck.draggable=!1;this.Ck.BW=!0;this.zj=this.Ck.getContext("2d",{alpha:!0});this.ny=[];this.Cy=[];this.Uo=this.q.ja?16:8},Ur:function(a){var b=Math.pow(2,a.W.zoom-this.ce),c=this.q.ja?this.q.kb:1,d=a.W.gb.Ua(this.ep).wc(this.bf);this.transform={translate:this.transform.translate.add(d.Vc(c)),scale:b/c,rotate:0};this.gb=a.W.gb},Tu:function(a,b){if(!this.ra|| 3E4<Math.abs(this.gb.x-this.ra.x)/this.S||3E4<Math.abs(this.gb.y-this.ra.y)/this.S)this.ra=this.gb;this.re=this.ce;this.qi=this.bf;this.pi=!1;this.currentTime=+new Date;this.qN=b.qN;this.Cd=[this.Aa.Lb.x,this.Aa.Lb.y];this.tj=b.kC;var c=this.lj;this.Se=this.zoom<<0!==this.zoom;var d=this.gb.Ua(this.ra);d.x<-w.a.Za/2&&(d.x+=w.a.Za);d.x>w.a.Za/2&&(d.x-=w.a.Za);this.TI=d.wc(this.bf);for(d=c.length-1;0<=d;d-=1){var e=c[d];if(e.length){var g=e[0].ma.z,h=!1;!e.rg||w.Da.be||!(g<=this.zoom&&"in"===this.Gu|| g>=this.zoom&&"out"===this.Gu)&&this.Gu||this.labels&&this.labels.length&&!a.ck&&this.$D(this.labels.hv,this.Mf)||(h=!0,this.labels&&this.labels.Zk?(this.fp=this.labels.Zk,this.fp.zoom=this.labels.zoom):(this.fp=[],this.fp.zoom=null),this.labels=[],this.labels.zoom=g,this.labels.hv=this.Mf);if(h){for(g=e.length-1;0<=g;g-=1){var k=e[g],h=!1,l=k.xa;!l&&k.Jc&&k.Jc.xa&&(l=k.Jc.xa,h=!0);if(l){for(var k=0,m=l.length;k<m;k+=1)l[k].reverse=h;Array.prototype.push.apply(this.labels,l)}}this.labels.sort(function(a, b){return a.hl>b.hl?-1:a.le>=b.le?-1:1})}}}if(this.gaa(a)){this.ld();if(!this.g.J.ta)return;this.iM(a);this.hn=this.labels}this.Yea=!1;this.Qe(a)},ld:function(){if(this.rg&&!this.q.ta){var a=this.q;w.Yd.ue.end({id:this.g.J.id,key:"rl",index:2});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.ia("complete"))}},kc:function(a,b){this.jp=a.jp;this.rk=a.rk;this.mm(a,b);this.Se||this.Ri();this.ep&&(a.UZ||a.WM&&w.l.Mj||a.If&&!a.Se&&a.L$)?this.Ur(a,b):this.Tu(a,b);this.ep=this.gb;this.pi&&this.set("display", 0)},Qe:function(a){var b=this.gb.Ua(this.ra);b.x<-w.a.Za/2&&(b.x+=w.a.Za);b.x>w.a.Za/2&&(b.x-=w.a.Za);this.transform={translate:new w.G(a.W.Aa.Vb.x*(this.q.ja?this.q.kb:1),a.W.Aa.Vb.y*(this.q.ja?this.q.kb:1)),scale:1/(this.q.ja?this.q.kb:1),rotate:0}},$D:function(a,b){return a.zd===b.zd&&a.pe===b.pe&&a.yd===b.yd&&a.Sd===b.Sd},eu:function(a,b){var c;if(this.zoom){var d=a.wc(Math.pow(2,20-this.zoom));this.labels&&(c=this.Gca(d,b))&&(c.PK=!1);!c&&this.Hb&&(c=this.Fca(d))&&(c.PK=!0)}return c?[c]:[]}, Gca:function(a,b){for(var c=a.x,d=a.y,e=this.labels.Zk||this.labels,g=e.length-1;0<=g;g-=1){var h=e[g],k=h.Oa[0]/this.S,l=h.Oa[1]/this.S;if((h.gl||!b)&&this.vW(h,c,d,k,l))return h}},Fca:function(a){var b=a.x;a=a.y;for(var c=this.Hb.length-1;0<=c;c-=1){var d=this.Hb[c],e=d.Oa[0]/this.S,g=d.Oa[1]/this.S;if(d.gl&&this.vW(d,b,a,e,g))return d}},vW:function(a,b,c,d,e){for(var g=0;g<a.wb.length;g+=1){var h=a.wb[g][2],k=a.wb[g][3],l=a.wb[g][0],m=a.wb[g][1];this.q.ja&&(h/=this.q.kb,k/=this.q.kb,l/=this.q.kb, m/=this.q.kb);if(b>=d+l-1&&b<=d+l+h+1&&c>=e+m-1&&c<=e+m+k+1)return!0}return!1},reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.labels=[];this.ny=[];this.Cy=[];this.yb&&this.yb.parentNode&&this.yb.parentNode.removeChild(this.yb);this.Ck&&this.Ck.parentNode&&this.Ck.parentNode.removeChild(this.Ck);this.set("display")},gi:function(){return this.Ck},KJ:function(a,b){if("roadlabel"===a||"poilabel"===a)for(var c=0;c<b.length;c+=1){var d=b[c];if(d.Ub){var e="",g="",h="";d.Td&&(h=d.Td[0], e=h[3],g=h[4],h=d.Yi?"":h[7]);if(e=this.T.du&&this.T.du(e,g,h,d.Ub,d.Xq))d.visible=e[4],d.ik=e[3];if(d.Td)for(g=0;g<d.Td.length;g+=1)h=d.Td[g],h[3]=e[0],h[4]=e[1],d.un&&(h[7]=e[2])}}}});w.vF={kn:function(a,b,c){return this.q.Cr+b.join(";")+"&lv="+a+"&preload="+(c&&c[0]&&c[0].xg?1:0)},Lr:function(a,b){if(this.q){for(var c=[],d=[],e=0,g=a.length;e<g;e+=1){var h=a[e];h&&(h=JSON.parse(h),h["x-vd-v"]?(this.Ed=h["x-vd-v"],this.Ud=[h.tv||"",h.vdv].join("-"),this.rf=h.tv,this.g.vd="#"+h.bgc.substring(2)):(this.Du(h,b,c,this.Ed||"v4"),d.push(h)))}d.length&&(w.l.gf||w.l.bj&&!this.g.J.ta)&&18>=b&&w.ym.set({Qd:!0,data:d,url:this.kn(b,[]),w:this.q,vdataVersion:this.Ud,"x-vd-v":this.Ed,tv:this.rf, bgc:this.g.vd,td:this.g.J.get("showBuildingBlock")});this.set("display")}},Nu:function(a,b){var c=0,d=0,e=1,c=256*b.x,d=256*b.y,e=b.S;return[(c+a[0])*e,(d+a[1])*e]},Du:function(a,b,c,d,e){function g(c,g,l){c=[l,c,g].join("/");if(c=p.wa.get(c)){g=c.ma;var m=w.A.Rb+"://vdata.amap.com/icons/"+(h||k?"b":"n")+(10>g.z?"39":"18")+"/1/";if(c&&"loaded"!==c.status)if(p.PZ(c,r)||c.xg){if(-1!==s.indexOf(q))if("limg"===q)a[1]&&(c.Qd={url:"data:image/png;base64,"+a[1],Tn:"limg-"+c.key+"-"+p.q.Ac},w.Mh.$k(c.Qd, !0));else{if("roadlabel"===q)for(var n=1;n<a.length;n+=1){var v=a[n];v.qz=v[0];var E=w.a.qs(v[1],d);if(!(0>E[0]||256<=E[0]||0>E[1]||256<=E[1])){var A=p.Nu(E,g),E={Oa:A,name:v[0],Yi:!0,Bd:E,Da:[],wb:[],visible:!0,ik:!0},I=E.name;E.Xr=15>v[2]%90||75<v[2]%90?90*Math.floor((v[2]+15)/90):v[2];A=v[3];0<=v[8]&&(E.zB={name:v[6],KZ:v[7],dir:v[8]});var D=A[2];l=A[3];var F=-Math.floor(l/2);if(v[4])if("v5"<=d){var C=v[5].split(":"),H=C[1],H=parseInt(H)-1,C=w.A.Rb+"://vdata.amap.com/style_icon/icon-normal-"+(h|| k?"big":"small")+".png";E.Da.push(C);var C=Math.floor(H/10),K=H%10,L=0,J=0,N=0;k?(L=48,N=J=40):h?(L=J=40,N=36):(L=J=24,N=20);var M=L*Math.max(D+2,N)/N,C=[-M/2,-L/2,M,L,J*K,J*C,J,J];E.le=7;E.wb.push(C)}else{F=!1;H=parseInt(v[5]);153===H&&(0===I.indexOf("G")?(H="153g",F=!0):0===I.indexOf("S")&&(H="153s",F=!0));if(151===H||150===H)F=!1,0===I.indexOf("G")&&(H=150,F=!0),0===I.indexOf("S")&&(H=151,F=!0);152===H&&(H=151);!0===F&&(m=w.A.Rb+"://webapi.amap.com/theme/v1.3/icons/"+(h||k?"b/":"n/"));C=m+H+".png"; w.Mh.$k(C);E.Da.push(C);M=v[4][0]*u;v=v[4][1]*u;C=[-M/2,-v/2,M,v];E.wb.push(C);D=Math.min(M-3,D);l=Math.min(v,l);F=-Math.floor(l/2)+(k?3:1)}E.Da.push(c.Qd);E.le=11;E.wb.push([-Math.floor(D/2),F,D,l,A[0],A[1],A[2],A[3]]);c.xa||(c.xa=[]);c.xa.push(E)}}else if("poilabel"===q){I=[];for(n=1;n<a.length;n+=1)if(v=a[n],v.qz=v[0],E=w.a.qs(v[1],d),!(0>E[0]||256<=E[0]||0>E[1]||256<=E[1])){A=p.Nu(E,g);E={Oa:A,name:v[0].replace("^",""),un:!0,Bd:E,Da:[],wb:[],visible:!0,ik:!0};H=0;E.hl=v[8];v[6]&&("v5"<=d?(C=v[6].split(":"), H=C[1],F=Math.floor((parseInt(C[0].split("_")[1])-28)/2)):H=v[6]);if(H&&v[3]){if("v5"<=d){C=w.A.Rb+"://vdata.amap.com/style_icon/icon-"+(1===F?"biz-":"normal-")+(h||k?"big":"small")+".png";E.Da.push(C);H=parseInt(H)-1;C=Math.floor(H/10);K=H%10;k?(L=48,J=40,N=28):h?(L=J=40,N=28):(L=J=24,N=20);M=L;if(151===H||152===H||153===H)N-=4,D=v[7][0][2],M=L*Math.max(D+2,N)/N;C=[-M/2,-L/2,M,L,J*K,J*C,J,J]}else C=m+H+".png",w.Mh.$k(C),E.Da.push(C),C=[-Math.round(v[3][0]/2),-Math.round(v[3][1]/2),v[3][0],v[3][1]], k&&!e&&(C[0]*=u,C[1]*=u,C[2]*=u,C[3]*=u);E.wb.push(C)}if(v[2]&&v[7])for(D=v[2],C=0;C<v[2].length;C+=1){E.Da.push(c.Qd);A=v[7][C];k&&!e&&(D[C][0]=Math.round(D[C][0]*u),D[C][1]=Math.round(D[C][1]*u),D[C][2]=Math.round(D[C][2]*u),D[C][3]=Math.round(D[C][3]*u));M=D[C][0];K=D[C][1]-(k?4:2);L=A[3];J=A[2];M<-J&&H&&v[3]&&(M=-J+E.wb[0][0]);if("v5">d){if("375"===H||"3751"===H)J=Math.min(D[C][2],k?24:14),M=-Math.floor(J/2),K=-Math.floor(L/2)}else M-=2;E.le=L-4;4===l&&"\\u5317\\u4eac"===E.name&&(K=k?-50:-26);E.wb.push([M, K,J,A[3],A[0],A[1],A[2],A[3]])}E.Xl=v[5];E.Xl&&I.push(E.Xl);E.gl=v[4];E.im=v[9];E.iL=v[10];E.$e=H;E.vr=F;c.xa||(c.xa=[]);c.xa.push(E)}c.Te||(c.Te={},c.Te.je=I,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:c}))}q===s[s.length-1]&&(c.status="loaded",c.ta=c.qa=!0,c.Jc&&(c.Jc.ta=c.Jc.qa=!0))}}else p.yM(b,c,r,w.a.bind(p.wL,p))}}var h=w.l.Y,k=this.q.ja,l=a[0].split("-");1===l.length&&(l=a[0].split("_"));c=parseInt(l[1]);var m=parseInt(l[2]),n=parseInt(l[0]),p=this,q=l[3],s=this.q.xa,r=18<b?Math.pow(2,b-18): 1,l=Math.ceil(p.Mf.gD),u=this.q.ja?this.q.kb:1,v=Math.pow(2,n);10>n&&(c<=l&&g(c+v,m,n),c>=v-l&&g(c-v,m,n));g(c,m,n)}};w.Q.canvas.uF=w.Q.canvas.Wh.extend({ga:[w.vF]});w.Q.canvas.Wh.ob({iM:function(a){this.zt++;var b=this.Ck,c=this.zj;this.ju={};var d=this.q.ja?this.q.kb:1,e;0!==a.W.rotation?(e=2*Math.floor(a.W.Aa.Vb.x)*d,d*=2*Math.floor(a.W.Aa.Vb.y)):(e=a.size.width*d,d*=a.size.height);w.j.qm(b,e,d,!0);w.l.naa&&b.parentNode&&b.parentNode.appendChild(b);c.textBaseline="bottom";this.bW=0;a.Hb&&(this.eY(a.Hb,1,a.Hb),0===a.Hb.length&&this.labels&&this.labels.Zk&&this.labels.zoom===this.zoom&&this.labels.Zk.length!==this.labels.length&&(this.labels.Zk=null));this.labels&& this.eY(this.labels,0,a.Hb);!w.l.Y&&this.fp&&this.fp.length&&this.Eca(a);this.ny=this.ny&&this.yY(c,this.ny,480);this.Cy=this.Cy&&this.yY(c,this.Cy,200);a.Hb&&this.BY(a.Hb,c,w.oh.yV(this.g.J),this.hc,e,d);this.labels&&this.BY(this.labels,c,w.oh.yV(this.g.J),this.hc,e,d);this.fp=[];this.labels&&(this.labels.Uu=this.zoom,this.labels.Ru=this.gb,this.labels.fz=this.rotation,this.labels.DY=this.q.ja,this.labels.size=a.size);a.Hb&&(this.Hb=a.Hb);this.Hb&&(this.Hb.Uu=this.zoom,this.Hb.Ru=this.gb,this.Hb.fz= this.rotation,this.Hb.size=a.size);this.r("afterLabelRender")},zY:function(a,b,c){var d=void 0===b.ik?!0:b.ik,e=1,g=void 0===b.visible?!0:b.visible,h=null;if(b.Ub&&this.g.ec){var k=h="",l="";b.Td&&this.rJ&&(l=b.Td[0],h=l[3],k=l[4],l=b.Yi?"":l[7]);if(h=this.T.du&&this.T.du(h,k,l,b.Ub,b.Xq))g=h[4],d=h[3],e=h[5]}if(g){if(this.zj.globalAlpha!==c||e)this.zj.globalAlpha=c||e;g=0;for(k=b.Da.length;g<k;g+=1)(d||"CANVAS"===b.Da[g].tagName)&&this.Cba(a,b.Da[g],b.wb[g],b.Xr,c||e);this.zj.globalAlpha!==c&&(this.zj.globalAlpha= c);b.Td&&this.rJ&&this.rJ(a,b,h)}},Cba:function(a,b,c,d){var e=this.zj;b=this.Ql(b);if(!b)return 1;var g=c[2],h=c[3],k=c[0],l=c[1];d=(d||0)%360*-Math.PI/180;if(0!==d){var m=Math.cos(d),n=Math.sin(d),p=a[0],q=a[1];e.transform(m,n,-n,m,(1-m)*p+n*q,(1-m)*q-n*p)}k=a[0]+k;a=a[1]+l;4===c.length?b.loaded&&e.drawImage(b,k,a,g,h):e.drawImage(b,c[4],c[5],c[6],c[7],k,a,g,h);0!==d&&e.setTransform(1,0,0,1,0,0)},Ql:function(a){if(!a)return null;if("IMG"===a.tagName||"CANVAS"===a.tagName||(a=w.Mh.mV(a))&&a.loaded)return a}, bD:function(a){var b=a.Oa,c=b[0];a.reverse&&(c>w.a.Za/2?c-=w.a.Za:c<-w.a.Za/2&&(c+=w.a.Za));return this.Ho(c,b[1])},Ho:function(a,b){var c=this.q.ja?this.q.kb:1,d=this.S,e=0,g=0,e=(a-this.Cd[0])/d,g=(b-this.Cd[1])/d;return[Math.round(e*c),Math.round(g*c)]},Lca:function(a){var b=a.Oa,c=b[0];a.reverse&&(c>w.a.Za/2?c-=w.a.Za:c<w.a.Za/2&&(c+=w.a.Za));return[c/this.S,b[1]/this.S]},dea:function(a,b){var c=a.Oa;return c[0]>b.od.x||c[1]>b.od.y||c[0]<b.Lb.x||c[1]<b.Lb.y?!1:!0},Eca:function(a){var b=this.fp; if(this.fp.zoom!==this.labels.zoom)for(var c=0,d=b.length;c<d;c+=1){var e=b[c];e.un&&this.dea(e,a.W.Aa)&&(this.Cy.push(e),e.zoom=b.zoom,e.BK=new Date)}},eY:function(a,b,c){var d=!(!c||!c.length),e=a.zoom-this.zoom,g=a.Zk||a;if(0<e||d){a.Zk=[];for(var h=0,k=g.length;h<k;h+=1){var l=g[h],m=this.Lca(l);l.un||b?l.Xl&&d&&c.sX&&-1!==w.a.indexOf(c.sX,l.Xl)||(5>e&&this.yda(m,l,0<e,b,d)?a.Zk.push(l):w.l.Y||0===e&&!b||(this.ny.push(l),l.zoom=this.labels?this.labels.zoom:this.ce,l.BK=new Date)):l.Yi&&a.Zk.push(l)}}else a.Zk= a;return!1},yY:function(a,b,c,d,e){a=new Date;for(var g=[],h=0,k=b.length;h<k;h+=1){var l=b[h],m=Math.max(0,Math.abs(l.zoom-this.zoom)),m=Math.max(0,1-(a-l.BK)/(1/Math.pow(1.3,m)*c));if(0<m){g.push(l);var n=this.bD(l);-20>n[0]||n[0]>d+20||-20>n[1]||n[1]>e+20||this.zY(n,l,m)}else l.BK=void 0}g.length&&(this.bW=this.pi=1);return g},BY:function(a,b,c,d,e,g){d=a.zoom!==this.zoom;18===a.zoom&&18<this.zoom&&(d=!1);b.globalAlpha=1;a=a.Zk;b=0;for(var h=a.length;b<h;b+=1){var k=a[b];if(!(d&&k.Yi||k.Dm&&c&& 0<=c.indexOf(k.Dm))){var l=this.bD(k);-20>l[0]||l[0]>e+20||-20>l[1]||l[1]>g+20||this.zY(l,k)}}},gaa:function(a){this.hn&&this.hn.DY!==this.q.ja&&this.q.set("reload");if(this.bW)return!0;if(a.Hb&&a.Hb.length)if(this.Hb&&this.Hb.length){if(this.Hb!==a.Hb||this.Hb.Uu!==this.zoom||this.Hb.Ru!==this.gb||this.Hb.fz!==this.rotation||!this.Hb.size.qb(a.size))return!0}else return!0;else if(this.Hb&&this.Hb.length)return!0;return!this.labels||!this.g.dV&&this.labels===this.hn&&this.hn&&this.hn.Uu===this.zoom&& this.hn.Ru===this.gb&&!a.ck&&this.hn.fz===this.rotation&&this.hn.DY===this.q.ja&&this.hn.size.qb(a.size)?!1:!0},yda:function(a,b,c,d,e){if(!e&&!c&&!d)return!0;var g;e=b.Da.length;if(b.im>this.zoom)g=!0;else if(!c&&d)g=!1;else for(var h=0;h<e;h+=1){var k=b.wb[h],l=k[2],m=k[3],n=k[0],k=k[1],n=a[0]+n,k=a[1]+k;this.zda(n,k,l,m)||(g=!0)}if(!g&&(c||d))for(h=0;h<e;h+=1)for(k=b.wb[h],l=k[2],m=k[3],n=k[0],k=k[1],n=a[0]+n,k=a[1]+k,l=Math.ceil((n+l)/this.Uo),c=Math.ceil((k+m)/this.Uo),n=Math.floor(n/this.Uo), k=Math.floor(k/this.Uo),d=0,m=l-n;d<=m;d+=1)for(var l=0,p=c-k;l<=p;l+=1)this.ju[n+d]||(this.ju[n+d]={}),this.ju[n+d][k+l]=1;return!g},zda:function(a,b,c,d){var e=Math.ceil((a+c)/this.Uo);d=Math.ceil((b+d)/this.Uo);a=Math.floor(a/this.Uo);b=Math.floor(b/this.Uo);c=0;for(e-=a;c<=e;c+=1)if(this.ju[a+c])for(var g=0,h=d-b;g<=h;g+=1){if(1===this.ju[a+c][b+g])return!1}else this.ju[a+c]={};return!0}});w.Q.canvas.Wh.$_=w.aa.extend({B:function(a){this.Q=a},v9:function(a){this.jp=a;return this.XH([0,0,0])?!0:this.jp=!1},OQ:function(){return this.Q.Se?!1:!0},C4:function(a){if(a){var b=Array.prototype.slice.call(arguments,0);switch(a.type){case "icon":return this.F4.apply(this,b);case "label":return this.G4.apply(this,b);default:console.error("Unknown type",a)}}},bQ:function(a,b,c){a=null;try{a=b.getImageData.apply(b,c)}catch(d){console.error(d),a=null}return a},P9:function(a){return 0>a?0:255<a?255: Math.round(a)},nT:function(a,b){for(var c=0;4>c;c++)a[b+c]=this.P9(a[b+c]);return a},WH:function(a,b){var c=259*(b+255)/(255*(259-b));return[c*(a[0]-128)+128,c*(a[1]-128)+128,c*(a[2]-128)+128]},m9:function(a){return[255-a[0],255-a[1],255-a[2]]},XH:function(a,b){isNaN(b)&&(b=20);var c=Math.max(0,0.299*a[0]+0.587*a[1]+0.114*a[2]-b);switch(this.jp){case "amap://styles/normal":case "normal":return[1*c,1.2*c,255];case "amap://styles/light":case "light":return[1*c,1*c,255];case "amap://styles/fresh":case "fresh":return[1* c,1*c,220];case "amap://styles/grey":case "amap://styles/dark":case "insight":case "dark":return[1.5*a[0],1.5*a[1],1*a[2]];case "amap://styles/blue":case "amap://styles/darkblue":case "blue_night":case "mapv":return[2*a[0],1.5*a[1],1*a[2]]}return!1},H4:function(a,b){var c=20,d=10;switch(b.Vl){case "active":c+=20,d+=20}return this.WH(this.XH(a,c),d)},uQ:function(a,b){var c=-110;switch(b.Vl){case "active":c+=30}return this.WH(this.XH(this.m9(a),c),50)},E4:function(a){return this.WH(a,20)},tQ:function(a, b,c,d,e,g){var h=a[b],k=a[b+1],l=a[b+2];a=a[b+3];0<a?(e=e.call(this,[h,k,l,a],g),c[d]=e[0],c[d+1]=e[1],c[d+2]=e[2]):(c[d]=h,c[d+1]=k,c[d+2]=l);c[d+3]=a;this.nT(c,d)},V3:function(a){var b=a.data,c=a.width;a=a.height;for(var d=0,e=0,g=[Infinity,Infinity],h=[-Infinity,-Infinity],k=0;k<c;k++)for(var l=0;l<a;l++){var m=4*this.AG(k,l,c,a);if(!(76.5>b[m+3])){e++;k<g[0]&&(g[0]=k);l<g[1]&&(g[1]=l);k>h[0]&&(h[0]=k);l>h[1]&&(h[1]=l);for(var n=!0,p=0;4>p;p++)if(220>b[m+p]){n=!1;break}n&&d++}}return{Lja:0<e?d/ e:0,Haa:[g[0],g[1],h[0]-g[0]+1,h[1]-g[1]+1]}},AG:function(a,b,c){return b*c+a},LB:function(a,b,c,d,e,g,h){var k=this.AG(b,c,d,e);d=a[4*k+0];e=a[4*k+1];var l=a[4*k+2];a=a[4*k+3];if(a/255<h.mX||h.HZ&&!h.HZ.call(this,d,e,l,a))return!1;g.push([b,c]);return!0},r8:function(a,b){var c=Math.abs(a[0]-b[0]),d=Math.abs(a[1]-b[1]);return Math.sqrt(c*c+d*d)},st:function(a,b){return 0.1>Math.abs(a[0]-b[0])&&0.1>Math.abs(a[1]-b[1])},F9:function(a,b){for(var c=[a[0]],d=1,e=a.length;d<e;d++){var g=a[d];this.r8(g, c[c.length-1])<=b&&c.push(g)}return this.st(c[c.length-1],a[a.length-1])?c:null},cla:function(){},s2:function(a,b,c,d){d=w.extend({mX:0.2,iX:4},d);var e,g,h=[],k=[],l=[],m=[];for(e=0;e<c;e++){for(g=0;g<b&&!this.LB(a,g,e,b,c,h,d);g++);for(g=b-1;0<=g&&!this.LB(a,g,e,b,c,k,d);g--);}if(!h.length||!k.length)return null;for(g=0;g<b;g++){var n;e=h[0][0];n=k[0][0];if(g>=e&&g<=n)for(e=0;e<c&&!this.LB(a,g,e,b,c,l,d);e++);e=h[h.length-1][0];n=k[k.length-1][0];if(g>=e&&g<=n)for(e=c-1;0<=e&&!this.LB(a,g,e,b,c, m,d);e--);}if(!l.length||!m.length)return null;m.reverse();h.reverse();if(this.st(l[l.length-1],k[0])&&this.st(k[k.length-1],m[0])&&this.st(m[m.length-1],h[0])&&this.st(h[h.length-1],l[0])){b=[m,h,l,k];e=0;for(a=b.length;e<a;e++)if(!(2>b[e].length||(b[e]=this.F9(b[e],d.iX),b[e])))return null;return[].concat(b[0]).concat(b[1].slice(1)).concat(b[2].slice(1)).concat(b[3].slice(1))}return null},D3:function(a){for(var b=[Infinity,Infinity],c=[-Infinity,-Infinity],d=0,e=a.length;d<e;d++){var g=a[d][0], h=a[d][1];b[0]>g&&(b[0]=g);b[1]>h&&(b[1]=h);c[0]<g&&(c[0]=g);c[1]<h&&(c[1]=h)}return b.concat([c[0]-b[0]+1,c[1]-b[1]+1])},jQ:function(a,b){this.eT||(this.eT=document.createElement("canvas"));var c=this.eT;c.width=a;c.height=b;return c},b4:function(a){switch(a.length){case 2:return"lineTo";case 4:return"quadraticCurveTo"}return null},HP:function(a){switch(a.length){case 2:return[a[0]+0.5,a[1]+0.5];case 4:return[a[0]+0.5,a[1]+0.5,a[2]+0.5,a[3]+0.5]}return a},SO:function(a,b){a.beginPath();for(var c= 0,d=b.length;c<d;c++){var e=b[c];0===c?(2<e.length&&(4===e.length?e=e.slice(-2):console.error("Unknown start point: ",b)),a.moveTo.apply(a,this.HP(e))):a[this.b4(e)].apply(a,this.HP(e))}},J3:function(a){a=this.uQ([255,255,255],{Vl:a.Vl});this.nT(a,0);return"rgba("+a.slice(0,3).join(",")+", 0.8)"},D4:function(a,b,c){function d(a){return[Math.round((a[0]-n)*q+n-m[0]),Math.round((a[1]-p)*s+p-m[1])]}c=w.extend({Vl:"hover",HT:!0,padding:[1.5,1.5]},c);var e=a.width,g=a.height,h=this.jQ(2*e+10,g),k=h.getContext("2d"), l=this.D3(b),m=c.padding;w.l.qd&&(m[0]+=2.5,m[1]+=2.5);for(var n=l[0],p=l[1],q=(l[2]+2*m[0])/l[2],s=(l[3]+2*m[1])/l[3],l=0,r=b.length;l<r;l++)switch(b[l].length){case 2:b[l]=d(b[l]);break;case 4:b[l]=d(b[l]).concat(d(b[l].slice(2)));break;default:console.error("Unknown point: ",b[l])}k.save();this.SO(k,b);k.closePath();k.fillStyle=c.fillStyle||"rgba(255,255,255,0.85)";k.fill();k.putImageData(a,e+6,0);k.drawImage(h,e+6,0,e,g,0,0,e,g);a=c.HT&&10<b.length;var u=c.strokeStyle||this.J3(c);k.strokeStyle= a?"#fff":u;k.lineCap="butt";k.lineJoin="round";k.lineWidth=w.l.qd?2:1.2;k.stroke();k.restore();return{qa:h,Df:[0,0,e,g],ld:a?function(a,c){this.G9(a,c,b,u)}:null}},G9:function(a,b,c,d){this.w2();var e=this.Q.zt;this.KO(a,c,{duration:200,NL:0,startTime:Date.now(),Hha:function(a){a.strokeStyle=d;a.lineCap="butt";a.lineJoin="round";a.lineWidth=w.l.qd?2:1;a.translate(b[0],b[1])},Mja:function(){return this.Q.zt!==e}})},w2:function(){this.HF&&w.a.Wg(this.HF)},KO:function(a,b,c,d){this.OQ()?this.HF=w.a.pc(function(){this.HF= null;if(c.Mja.call(this))d&&d.call(this);else{var e=(Date.now()-c.startTime)/c.duration;1<e&&(e=1);var g=Math.round(b.length*e);if(c.NL<g){var h=1===e?b:b.slice(c.NL,g+1);h.length&&(a.save(),c.Hha.call(this,a,e),this.SO(a,h),a.stroke(),a.restore());c.NL=g}1>e?this.KO(a,b,c,d):d&&d.call(this)}},this):d&&d.call(this)},E2:function(a,b,c){a=a.createImageData(b.width,b.height);var d=a.data,e=a.width,g=a.height,h=c[0]+c[2],k=c[1],l=c[1]+c[3];for(c=c[0];c<h;c++)for(var m=k;m<l;m++)for(var n=4*this.AG(c, m,e,g),p=0;4>p;p++)d[n+p]=b.data[n+p];return a},u5:function(a,b,c){var d=a[1]+(b[1]-a[1])*c;return[Math.round(a[0]+(b[0]-a[0])*c),Math.round(d)]},a5:function(a,b,c){for(var d=1/c,e=[],g=1;g<c;g++){var h=this.u5(a,b,d*g);e.length&&this.st(h,e[e.length-1])||e.push(h)}return e},b5:function(a,b){for(var c=1,d=a.length;c<d;c++){var e=a[c-1],g=a[c];2===g.length&&(4===e.length&&(e=e.slice(2)),2===e.length&&(e=this.a5(e,g,b),a.splice.apply(a,[c,0].concat(e)),c+=e.length,d+=e.length))}},e4:function(a,b,c, d,e){e=Math.round(Math.min(c,d)*e);c--;d--;e?a=[[a+c,b+d-e],[a+c,b+d,a+c-e,b+d],[a+e,b+d],[a,b+d,a,b+d-e],[a,b+e],[a,b,a+e,b],[a+c-e,b],[a+c,b,a+c,b+e],[a+c,b+d-e]]:(e=[a+c,b+d],a=[e,[a,b+d],[a,b],[a+c,b],e]);this.b5(a,5);return a},F4:function(a,b,c,d,e,g){b=a.Df;var h=c?c.HK:this.bQ(d,e,b);if(h){var k=c?c.eW:null,l=h,m=a.padding,n=m?m[0]:0,p=m?m[1]:0;(m=0<n*p)&&(l=this.E2(e,l,[n,p,l.width-2*n,l.height-2*p]));d=l.data;b=l.width;var q=l.height;if(b&&q){c=(c=this.Q.g)&&c.J?c.J.get("hotspotOptions"): {};c=w.extend({borderAnimation:!0},c);l=this.V3(l);a=!a.Xda&&0.46<=l.Lja;var s=e.createImageData(b,q);e=s.data;for(var r=a?this.uQ:this.E4,u=0,v=d.length;u<v;u+=4)this.tQ(d,u,e,u,r,{Vl:g});if(m&&(e=a&&!w.l.qd?this.s2(d,b,q,{HZ:a?function(a,b,c){return!(220<a&&220<b&&220<c)}:null,mX:0.2,iX:4}):null,e||(e=l.Haa,e=this.e4(e[0],e[1],e[2],e[3],0.2)),e)){var x=this.D4(s,e,{Vl:g,fillStyle:"active"!==g?null:"#ddd",KD:h,HT:c.borderAnimation&&"hover"===g&&!k,padding:a?[1.5,1.5]:[2.5,2.5]}),s=null;return{KD:h, Su:function(a,b){k&&h&&a.putImageData(h,b[0],b[1]);a.drawImage(x.qa,x.Df[0],x.Df[1],x.Df[2],x.Df[3],b[0],b[1],b[2],b[3]);x.ld&&(x.ld.call(this,a,b),x.ld=null)}}}return{KD:h,Su:function(a,b){if(m){var c=this.jQ(s.width,s.height);c.getContext("2d").putImageData(s,0,0);a.clearRect(b[0]+n,b[1]+p,b[2]-2*n,b[3]-2*p);a.drawImage(c,0,0,c.width,c.height,b[0],b[1],b[2],b[3])}else a.putImageData(s,b[0],b[1]);s=null}}}}},G4:function(a,b,c,d,e,g){a=a.Df;if(c=c?c.HK:this.bQ(d,e,a))if(d=c.data,a=c.width,b=c.height, a&&b){var h=e.createImageData(a,b);e=h.data;a=0;for(b=d.length;a<b;a+=4)this.tQ(d,a,e,a,this.H4,{Vl:g});return{KD:c,Su:function(a,b){a.putImageData(h,b[0],b[1]);h=null}}}},lQ:function(a,b,c){var d=c[2],e=c[3],g=a[0]+c[0];a=a[1]+c[1];if(4===c.length||c.IQ){if((b=this.Q.Ql(b))&&b.loaded)return c=[4,4],w.l.qd&&(c[0]*=2,c[1]*=2),{type:"icon",Xda:b.src&&b.src.indexOf&&0<=b.src.indexOf("/indoor_icon/"),padding:c,Df:[g-c[0],a-c[1],d+2*c[0],e+2*c[1]]}}else return{type:"label",Df:[g,a,d,e]}}}); w.Q.canvas.Wh.ob({$P:function(){this.HG||(this.HG=new w.Q.canvas.Wh.$_(this));return!1===this.HG.v9(this.jp)?null:this.HG},hq:function(a,b){var c=this.$P();if(c&&c.OQ()&&a&&a.Da&&a.wb&&0===this.rotation){var d=this.zt,e=this.bD(a),g=[],h;a.mo||(a.mo=[]);var k=a.mo;for(h=a.wb.length-1;0<=h;h--){if(k[h]){if(k[h].rev!==d)continue;if(k[h].eW===b)continue}var l=c.lQ(e,a.Da[h],a.wb[h]);if(l){var m=c.C4(l,a,k[h],this.Ck,this.zj,b);m&&(k[h]={eW:b,rev:d,HK:m.KD},g.push({Su:m.Su,Df:l.Df,Xy:"icon"===l.type? 2:1}))}}g.sort(function(a,b){return a.Xy-b.Xy});h=0;for(d=g.length;h<d;h++)g[h].Su.call(c,this.zj,g[h].Df),g[h].Su=null}},aw:function(a){a.mo&&(a.mo.length=0,a.mo=null)},NB:function(){var a=this.zj;a&&a.putImageData&&a.putImageData(a.getImageData(0,0,1,1),0,0)},SB:function(a){if(a&&a.Da&&a.wb&&a.mo){var b=this.zj,c=this.$P();if(c){for(var d=this.zt,e=this.bD(a),g=a.mo,h=0,k=a.wb.length;h<k;h++){var l=g[h];if(l&&(g[h]=null,d===l.rev)){var m=c.lQ(e,a.Da[h],a.wb[h]);m&&m.Df&&b.putImageData(l.HK,m.Df[0], m.Df[1])}}a.mo=null;this.zt++}}}});w.Cs={h:function(a,b,c,d,e){if(this.Nd(a,b,c||this))return this;var g=this.ve=this.ve||{};g[a]=g[a]||[];e?g[a].unshift({jb:b,ke:c||this,dk:d}):g[a].push({jb:b,ke:c||this,dk:d});"complete"===a&&this.ta&&this.r(a);return this},Nd:function(a,b,c){var d=this.ve;if(b&&c){if(d&&a in d&&d[a])for(var e=0;e<d[a].length;e+=1)if(d[a][e].jb===b&&d[a][e].ke===c)return!0;return!1}return d&&a in d&&d[a]&&0<d[a].length},I:function(a,b,c){if(!this.Nd(a))return this;var d=this.ve;if(d&&d[a])for(var e=0;e<d[a].length;e+= 1)if(!(d[a][e].jb!==b&&"mv"!==b||c&&d[a][e].ke!==c)){d[a].splice(e,1);d[a].length||(d[a]=null);break}return this},JD:function(a,b){if(!this.Nd(a))return this;var c=this.ve;if(c&&c[a])for(var d=0;d<c[a].length;d+=1)if(!b||c[a][d].ke===b){c[a].splice(d,1);c[a].length||(c[a]=null);break}return this},r:function(a,b){function c(a){var b=Array.prototype.slice.call(arguments,1),c,d,e,g;d=0;for(e=b.length;d<e;d+=1)for(c in g=b[d]||{},g)Object.prototype.hasOwnProperty.call(g,c)&&(a[c]=g[c]);return a}if(!this.Nd(a))return this; var d={type:a};b||"string"!==typeof b&&"number"!==typeof b&&"boolean"!==typeof b?("object"===typeof HTMLElement?b instanceof HTMLElement:b&&"object"===typeof b&&1===b.nodeType&&"string"===typeof b.nodeName)?d.value=b:d=c(d,b):d.value=b;for(var e=[].concat(this.ve[a]),g=0;g<e.length;g+=1)e[g].jb&&(e[g].jb.call(e[g].ke||this,d),e[g]&&e[g].dk&&this.ve[a]&&this.ve[a].splice(g,1));return this},bi:function(a){a?this.ve&&this.ve[a]&&(this.ve[a]=null):this.ve=null;return this}};(function(){if(w.l.Br&&!w.Uh){w.Uh=w.$E();var a=w.a.dK({Nu:"posToCoord",gw:"_decodeBoundsList"});w.Uh.Zj(null,new Function("\\n    return {\\n      "+a.posToCoord+": "+w.vF.Nu.toString()+",\\n      "+a._decodeBoundsList+": "+w.Ls.gw.toString()+"\\n  }"));w.Uh.Zj(null,function(){return{Lr:function(a,c){a.ak?this.lfa.call(this,a,c):this.mfa.call(this,a,c)},mfa:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=0,k=d.length;h<k;h+=1){var l=d[h];l&&(a.tW&&(l=JSON.parse(l)),l["x-vd-v"]?(this.Ed=a.de.Ed=l["x-vd-v"], this.Ud=a.de.Ud=[l.tv||"",l.vdv].join("-"),this.rf=a.de.rf=l.tv):this.kfa(this.extend({},a,{Qx:l,Uc:g})))}g.length?this.parseLabel(this.extend({},a.de,{Uc:g}),function(d,g){var h=g.data,k=g.tda;c(d,{Ac:a.Ac,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),data:h,tda:k,bk:e,ze:{Ed:a.de.Ed,Ud:a.de.Ud,rf:a.de.rf,nc:a.nc}},{Jr:!e,jn:e})}):c(null,{Ac:a.Ac,data:null,bk:e},{Jr:!e,jn:e})},kfa:function(a){function c(a,b,c){var n=[c,a,b].join("/");18<h&&!m&&(n+="/"+h);if((a=d.filter(function(a){return a.key=== n})[0])&&"loaded"!==a.status&&-1!==l.indexOf(v))if("limg"===v)b=g[1],a.Qd=b,"string"===typeof b.b&&(b.b=u.gw(b.b)),c="",(c="object"===typeof b.u?b.u.url:b.u)&&(b.u={url:c,Tn:"limg-"+a.key+"-"+e});else{b={ti:a.ma,ll:n,Ba:g,Wc:v,NK:"building"===v,dh:"poilabel"===v||"roadlabel"===v||"building"===v&&p};if("poilabel"===v||"roadlabel"===v)b.Qd=a.Qd;v===l[l.length-1]&&(a.status="loaded");k.push(b)}}var d=a.Nb,e=a.WK,g=a.Qx,h=a.nc,k=a.Uc,l=a.xa,m=a.Je,n=a.sK,p=a.td,q=g[0].split("-");a=parseInt(q[1]);var s= parseInt(q[2]),r=parseInt(q[0]),u=this,v=q[3],q=Math.pow(2,r);10>r&&(a<=n&&c(a+q,s,r),a>=q-n&&c(a-q,s,r));c(a,s,r)},lfa:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=[],k=0,l=d.length;k<l;k+=1){var m=d[k];m&&(m=JSON.parse(m),m["x-vd-v"]?(this.Ed=a.de.Ed=m["x-vd-v"],this.Ud=a.de.Ud=[m.tv||"",m.vdv].join("-"),this.rf=a.de.rf=m.tv):(this.jfa(this.extend({},a,{Qx:m,Uc:g,Ed:this.Ed||"v4"})),h.push(m)))}c(null,{Ac:a.Ac,cba:h,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),bk:e,ze:{Ed:a.de.Ed,Ud:a.de.Ud, rf:a.de.rf,nc:a.nc}},{Jr:!e,jn:e})},jfa:function(a){function c(a,b,c,e){var k=[e,b,c].join("/");if(a=a.filter(function(a){return a.key===k})[0])if(b=a.ma,c=q.Rb+"://vdata.amap.com/icons/"+(s||g?"b":"n")+(10>b.z?"39":"18")+"/1/",a&&"loaded"!==a.status&&-1!==h.indexOf(t))if("limg"===t)n[1]&&(a.Qd={url:"data:image/png;base64,"+n[1],Tn:"limg-"+a.key+"-"+m});else{if("roadlabel"===t)for(var l=1;l<n.length;l+=1){var r=n[l];r.qz=r[0];var u=d.qs(r[1],p);if(!(0>u[0]||256<=u[0]||0>u[1]||256<=u[1])){var v=x.Nu(u, b),u={Oa:v,name:r[0],Yi:!0,Bd:u,Da:[],wb:[],visible:!0,ik:!0},H=u.name;u.Xr=15>r[2]%90||75<r[2]%90?90*Math.floor((r[2]+15)/90):r[2];v=r[3];0<=r[8]&&(u.zB={name:r[6],KZ:r[7],dir:r[8]});var K=v[2];e=v[3];var L=-Math.floor(e/2);if(r[4])if("v5"<=p){var J=r[5].split(":"),N=J[1],N=parseInt(N)-1,J=q.Rb+"://vdata.amap.com/style_icon/icon-normal-"+(s||g?"big":"small")+".png";u.Da.push(J);var J=Math.floor(N/10),M=N%10,T=0,W=0,Z=0;g?(T=48,Z=W=40):s?(T=W=40,Z=36):(T=W=24,Z=20);var Y=T*Math.max(K+2,Z)/Z,J=[-Y/ 2,-T/2,Y,T,W*M,W*J,W,W];u.le=7;u.wb.push(J)}else{L=!1;N=parseInt(r[5]);153===N&&(0===H.indexOf("G")?(N="153g",L=!0):0===H.indexOf("S")&&(N="153s",L=!0));if(151===N||150===N)L=!1,0===H.indexOf("G")&&(N=150,L=!0),0===H.indexOf("S")&&(N=151,L=!0);152===N&&(N=151);!0===L&&(c=q.Rb+"://webapi.amap.com/theme/v1.3/icons/"+(s||g?"b/":"n/"));J=c+N+".png";u.Da.push(J);Y=r[4][0]*y;r=r[4][1]*y;J=[-Y/2,-r/2,Y,r];u.wb.push(J);K=Math.min(Y-3,K);e=Math.min(r,e);L=-Math.floor(e/2)+(g?3:1)}u.Da.push(a.Qd);u.le=11;u.wb.push([-Math.floor(K/ 2),L,K,e,v[0],v[1],v[2],v[3]]);a.xa||(a.xa=[]);a.xa.push(u)}}else if("poilabel"===t){H=[];for(l=1;l<n.length;l+=1)if(r=n[l],r.qz=r[0],u=d.qs(r[1],p),!(0>u[0]||256<=u[0]||0>u[1]||256<=u[1])){v=x.Nu(u,b);u={Oa:v,name:r[0].replace("^",""),un:!0,Bd:u,Da:[],wb:[],visible:!0,ik:!0};N=0;u.hl=r[8];r[6]&&("v5"<=p?(J=r[6].split(":"),N=J[1],L=Math.floor((parseInt(J[0].split("_")[1])-28)/2)):N=r[6]);if(N&&r[3]){if("v5"<=p){J=q.Rb+"://vdata.amap.com/style_icon/icon-"+(1===L?"biz-":"normal-")+(s||g?"big":"small")+ ".png";u.Da.push(J);N=parseInt(N)-1;J=Math.floor(N/10);M=N%10;Z=W=T=0;g?(T=48,W=40,Z=28):s?(T=W=40,Z=28):(T=W=24,Z=20);Y=T;if(151===N||152===N||153===N)Z-=4,K=r[7][0][2],Y=T*Math.max(K+2,Z)/Z;J=[-Y/2,-T/2,Y,T,W*M,W*J,W,W]}else J=c+N+".png",u.Da.push(J),J=[-Math.round(r[3][0]/2),-Math.round(r[3][1]/2),r[3][0],r[3][1]],g&&(J[0]*=y,J[1]*=y,J[2]*=y,J[3]*=y);u.wb.push(J)}if(r[2]&&r[7])for(K=r[2],J=0;J<r[2].length;J+=1){u.Da.push(a.Qd);v=r[7][J];g&&(K[J][0]=Math.round(K[J][0]*y),K[J][1]=Math.round(K[J][1]* y),K[J][2]=Math.round(K[J][2]*y),K[J][3]=Math.round(K[J][3]*y));Y=K[J][0];M=K[J][1]-(g?4:2);T=v[3];W=v[2];Y<-W&&N&&r[3]&&(Y=-W+u.wb[0][0]);if("v5">p){if("375"===N||"3751"===N)W=Math.min(K[J][2],g?24:14),Y=-Math.floor(W/2),M=-Math.floor(T/2)}else Y-=2;u.le=T-4;4===e&&"\\u5317\\u4eac"===u.name&&(M=g?-50:-26);u.wb.push([Y,M,W,v[3],v[0],v[1],v[2],v[3]])}u.Xl=r[5];u.Xl&&H.push(u.Xl);u.gl=r[4];u.im=r[9];u.iL=r[10];u.$e=N;u.vr=L;a.xa||(a.xa=[]);a.xa.push(u)}a.Te||(a.Te={},a.Te.je=H)}t===h[h.length-1]&&(a.status= "loaded",a.ta=a.qa=!0,a.Jc&&(a.Jc.ta=a.Jc.qa=!0))}}var d=this,e=a.Nb,g=a.qd,h=a.xa,k=a.sK,l=a.kb,m=a.WK,n=a.Qx,p=a.Ed,q=this.A,s=this.l.Y,r=n[0].split("-");1===r.length&&(r=n[0].split("_"));a=parseInt(r[1]);var u=parseInt(r[2]),v=parseInt(r[0]),x=this,t=r[3],y=g?l:1,l=Math.pow(2,v);10>v&&(a<=k&&c(e,a+l,u,v),a>=l-k&&c(e,a-l,u,v));c(e,a,u,v)}}},function(a){a||(w.Uh.hea=!0)})}})();(function(){if(w.l.Br&&!w.kf){w.kf=w.$E();var a=w.a.dK({h:"on",Nd:"hasEvents",I:"off",JD:"offByContext",r:"emit",bi:"clearEvents"});w.kf.Zj(null,function(){return{aX:function(a,c){var d=this;if(3<this.Bq||this.disabled)return this.aj(a,c);var e=a.Nb,g=a.nc,h=a.xg,k=a.$M,l=a.Oda,m=a.xa;a.de.Lc?this.Lc=a.de.Lc:a.de.Lc=this.Lc;if(h&&this.qo())this.yk(e,c);else{var n=[(new Date).getTime(),this.ir()+1&65535,h?1:0].join("-");h||(this.Af[n]=1);var k={command:"tiles",reqId:n,payload:{t:k,opt:g,cs:{level:g, flds:m.join(","),v:l?"3":"2"}}},p=this.send(k);this.Qm[n]={Nb:e,nc:g,F:a,Cc:c,xg:h};this.wy()||setTimeout(function(){d.wy()||(d.Bq?d.Bq++:d.Bq=1,d.QU(p)&&(delete d.Qm[n],delete d.Af[n],d.aj(a,c)))},300);this.h("tiles",this.RD,this);this.h("ack",this.QD,this);this.h("disable",this.PD,this)}},caa:function(a){this.SK()&&this.send(a)},PD:function(){this.disabled=!0;this.close();for(var a in this.Qm)this.Qm.hasOwnProperty(a)&&this.rG(a)},rG:function(a){var c=this.Qm[a];c&&(this.yk(c.Nb,c.Cc),delete this.Qm[a], delete this.Af[a])},QD:function(a){var c=a.reqId,d=this.Qm[c];d&&(a.content.status?d.Cc&&(d.Cc(null,{Ac:d.F.Ac,d$:!0,bk:!0},{Jr:!1,jn:!0}),delete this.Qm[c],delete this.Af[c]):this.rG(c))},RD:function(a){var c=a.reqId,d=this.Qm[c];d&&(d.xg&&this.qo()?this.rG(c):this.Lr(this.extend({bk:!1},d.F,{LE:a.content.data,nc:a.content.opt}),d.Cc))},Lr:function(a,c){for(var d=a.LE,e=a.bk,g=[],h=0,k=d.length;h<k;h+=1){var l=d[h];l&&(a.tW&&(l=JSON.parse(l)),l["x-vd-v"]?(this.Ed=a.de.Ed=l["x-vd-v"],this.rf=a.de.rf= l.tv,this.Ud=a.Ud=[l.tv||"",l.vdv].join("-"),l.bgc&&(l="#"+l.bgc.substring(2),a.Mq!==l&&(a.Mq=l))):this.Du(this.extend({},a,{Qx:l,Uc:g})))}g.length?(d=this.extend({},a.de,{Uc:g}),(a.Je?this.RX:this.parseDataToVector)(d,function(d,g){c(d,{Ac:a.Ac,Nb:a.Nb.filter(function(a){return"loaded"===a.status}),data:g.data,Mq:a.Mq,bk:e,ze:{Ed:a.de.Ed,rf:a.de.rf,Ud:a.de.Ud,nc:a.nc}},{Jr:!e,jn:e})})):c(null,{Ac:a.Ac,Nb:[],data:null,bk:e},{Jr:!e,jn:e})}}});w.kf.Zj(null,w.lL);w.kf.Zj(null,new Function("\\n    return {\\n      "+ a.on+": "+w.Cs.h.toString()+",\\n      "+a.hasEvents+": "+w.Cs.Nd.toString()+",\\n      "+a.off+": "+w.Cs.I.toString()+",\\n      "+a.offByContext+": "+w.Cs.JD.toString()+",\\n      "+a.emit+": "+w.Cs.r.toString()+",\\n      "+a.clearEvents+": "+w.Cs.bi.toString()+"\\n    }\\n  "));w.kf.Zj(null,w.rF,function(a){a||(w.kf.Eda=!0)})}})(); ')
_jsload_('wgl', '(function(){if(w.l.rm){var a=function(a){function c(a,b,c,d,g,h,k){var l=a.Ba;c=[];d=a.ti;var m=null,n=null,p;a.Ba=[];h=h&&16<b;for(var q=[],t=[],x=[],y=1,Y=l.length;y<Y;y+=1){var ca=l[y],R=ca[1].split("&"),m=s(B?B:R[0]),n=s(R[4]);p=ca[2];var da=ca[0],U=ca[3]*Math.pow(2,2)*k,V=ca[4],X={},Q=ca[5],ca=[];if(Q&&Q.length)for(var S=0,O=Q.length;S<O;S+=1){var P=Q[S].split("-"),R=P[1].split("^");ca[P[0]]=R;for(var P=0,ba=R.length;P<ba;P+=1)-1===e(c,R[P])&&c.push(R[P])}if(V&&V.length)for(Q=0,O=V.length;Q< O;Q+=1){P=V[Q].split("-");ba=parseInt(P[0]);X[ba]={};for(var R=1,ga=P.length;R<ga;R+=1)X[ba][parseInt(P[R])]=!0}Q=0;for(V=da.length;Q<V;Q+=1){R=da[Q];z||(q=[],x=[],t=[]);for(var R=u(R,v,b),O=r(R,d,g,!0),R=O[1],P=[],S=ga=ba=0,la=R.length-1;S<la;S+=1){var ja=R[S],pa=R[S+1],ba=ba+ja[0],ga=ga+pa[1];if(!X[Q]||!X[Q][S])if(h){var va=pa[0]-ja[0],ta=pa[1]-ja[1],ya=5E3+va+(5E3+ta)/1E4,ta=Math.sqrt(Math.pow(va,2)+Math.pow(ta,2)),va=Math.round(U/64),ta=Math.ceil(ta/64);va?t.push(0,0,ta,va,0,va,0,0,ta,0,ta,va): t.push(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1);q.push(ja[0],ja[1],-U,ya);q.push(pa[0],pa[1],0,ya);q.push(ja[0],ja[1],0,ya);q.push(ja[0],ja[1],-U,ya);q.push(pa[0],pa[1],-U,ya);q.push(pa[0],pa[1],0,ya)}else x.push(ja[0],ja[1],0,-1,pa[0],pa[1],0,-1);P.push([ja[0],ja[1]])}S=R.length-1;ba=[ba/S+215440491,ga/S+106744817];P=G.Gp(h?P:R,[],0,1);ga=0;for(S=P.length;ga<S;ga+=1)for(R=0;3>R;R+=1)la=-U,h||(la=0),t.push(-1,-1),q.push(P[ga][R][0],P[ga][R][1],la,0);!z&&q.length&&(R=[m,n,p],O=[new Float32Array(q),new Float32Array(t), new Float32Array(x),R,O[1],ba],ca[Q]&&(O.nda=ca[Q]),a.Ba.push(O))}}z&&q.length&&(b=256*Math.pow(2,20-d.z),ba=[d.x*b+128,d.y*b+128],O=[new Float32Array(q),new Float32Array(t),new Float32Array(x),[m,n,p],null,ba],a.Ba.push(O));a.Xk=c;return a}function d(a,b,c,d,g,h){c=a.Ba;d=[];for(var k=a.ti,l=null,m=null,n={},p=1,q=c.length;p<q;p+=1){var t=c[p],x=t[1].split("&"),l=s(B?B:x[0]),m=s(x[2]),y=x[0]+x[2];n[y]||(n[y]={XZ:[],MY:[],gp:[],Ih:[],Vba:l,borderColor:m,Ub:t[2]});var l=n[y].XZ,m=n[y].MY,x=n[y].gp, y=n[y].Ih,z=t[0],ca=t[3]*Math.pow(2,2),R=t[4],da={};if((t=t[5])&&t.length)for(var U=0,V=t.length;U<V;U+=1)for(var X=t[U].split("-")[1].split("^"),Q=0,S=X.length;Q<S;Q+=1)-1===e(d,X[Q])&&d.push(X[Q]);if(R&&R.length)for(t=0,V=R.length;t<V;t+=1)for(X=R[t].split("-"),Q=parseInt(X[0]),da[Q]={},U=1,S=X.length;U<S;U+=1)da[Q][parseInt(X[U])]=!0;t=0;for(R=z.length;t<R;t+=1){for(var O=z[t],O=u(O,v,b),O=r(O,k,g,!0)[1],U=[],V=0,X=O.length-1;V<X;V+=1){var Q=O[V],S=O[V+1],P=[Q[0]-0*ca,Q[1]-0.3*ca],ba=[S[0]-0*ca, S[1]-0.3*ca];da[t]&&da[t][V]||(h?((S[0]-Q[0])*(P[1]-Q[1])<(P[0]-Q[0])*(S[1]-Q[1])&&(l.push(P[0],P[1],2),l.push(S[0],S[1],-1),l.push(Q[0],Q[1],-1),l.push(P[0],P[1],2),l.push(ba[0],ba[1],2),l.push(S[0],S[1],-1),y.push([Q,S,ba,P])),x.push(P[0],P[1],-1,ba[0],ba[1],-1)):x.push(Q[0],Q[1],-1,S[0],S[1],2));U.push([P[0],P[1]])}O.pop();V=G.Gp(h?U:O,[],0,1);y.push(h?U:O);O=0;for(X=V.length;O<X;O+=1)for(U=0;3>U;U+=1)m.push(V[O][U][0],V[O][U][1],3)}}a.Ba=[];for(O in n)n.hasOwnProperty(O)&&(x=[n[O].Vba,n[O].borderColor, n[O].Ub],a.Ba.push([new Float32Array(n[O].XZ),new Float32Array(n[O].MY),new Float32Array(n[O].gp),x,n[O].Ih]));a.Xk=d;return a}function e(a,b){if(a&&!a.length)return-1;if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return-1}function g(a,b){for(var c=a.Ba,d=[],e={0:"ffde0000",1:"ffffcc00",2:"ff33b100",3:"ff8c0e0e",4:"ffadadad"},g=0,h=c.length;g<h;g++){for(var k=[],l=0,n=c[g].length;l<n;l++){var p=[],q=[];m(p,q,c[g][l][1],a.ma,b);p.forEach(function(a,b){k.push([a, q[b]])})}if(k.length){var r=[[],[],{width:0.75*c[g][0][0],borderColor:s(e[g])}];k.forEach(function(a){var b=r[0].length/9;b&&(a[1]=a[1].map(function(a){return a+b}));r[0]=r[0].concat(a[0]);r[1]=r[1].concat(a[1])});r[0]=new Float32Array(r[0]);r[1]=new Uint16Array(r[1]);d.push(r)}}a.Ba=d;return a}function h(a){var b=[],c=[],d=[];a=r(a,{x:0,y:0},1);c.push.apply(c,a[2]);if(2<a[1].length){var e=G.Gp(a[1],[],0);e.length&&(b.push.apply(b,a[0]),d.push.apply(d,e))}return[new Float32Array(b),new Uint16Array(d), {},c]}function k(a,b,c,d,e){for(var g="solid solid_roundcap solid_squarecap dash railway dash_crewel".split(" "),h=a.Ba.slice(1),k=h.length-1;0<=k;k--)h[k].nW=k;h.sort(function(a,b){return a[2]>b[2]?1:a.nW>b.nW?1:-1});for(var m={},k=0,n=h.length;k<n;k+=1){var p=h[k],q=p[1].split("&"),r,u,v,x,y;r=u=v=x=y=null;var B,z,G,V,X=null,Q=!1;B=z=G=V=null;q[1]&&(r=s(q[1]));u=parseInt(q[0]);v=q[2];v!==g[0]&&(v===g[1]?B="round":v===g[2]?B="square":0===v.indexOf(g[5])?(X=!0,G=[3,2]):0===v.indexOf(g[3])?(G=v.substring(5).split(")")[0].split(","), G.forEach(function(a,b){G[b]*=e})):0===v.indexOf(g[4])&&(x=r,r=q[4]?s(q[4]):[1,1,1,r[3]],G=[12,12],Q=!0,y=3,u=1));q[3]&&q[4]&&3<q.length&&(y=u+parseInt(q[3]),x=s(q[4]),v=q[5],v!==g[0]&&(v===g[1]?z="round":v===g[2]?z="square":0!==v.indexOf(g[5])&&0===v.indexOf(g[3])&&(y+=1,V=v.substring(5).split(")")[0].split(","),V.forEach(function(a,b){V[b]*=e}))));if(c){if(G)for(q=G.length-1;0<=q;q-=1)G[q]*=e;if(V)for(q=V.length-1;0<=q;q-=1)V[q]*=e}v=[];v.$f=0;var S=[],O=[];l(v,O,S,p[0],a.ti,b,c,d,e,B);"app"=== t&&(u/=4,y/=4);q=[u,r,G,y,x,V,X,Q,B,z,p[3],p[4]];q.mna=!0;p=p[2];m[p]||(m[p]=[]);m[p].push([new Float32Array(v),new Uint16Array(O),q,S])}a.Ba=m;return a}function l(a,b,c,d,e,g,h,k,l,m){for(var n=0,p=d.length;n<p;n+=1){var q=a.length/11,s=q+6,t=u(d[n],v,g),x=r(t,e,k);if(1<x[1].length){for(var t=x[0],y=x[2],B=0,x=x[1].length;B<x;B+=1){if(0<B){var z=t[2*B]-t[2*B-2],G=t[2*B+1]-t[2*B-1];a.$f+=Math.sqrt(z*z+G*G)*(h?l:1)}var z=t[2*B],G=t[2*B+1],V=y[B][0],X=y[B][1],Q,S;B===x-1?(Q=t[2*x-2],S=t[2*x-1]):(Q= t[2*B+2],S=t[2*B+3]);var O,P;0===B?(O=z,P=G):(O=t[2*B-2],P=t[2*B-1]);if(0!==B){var ba=B===x-1?0:-1;a.push(z,G,V,X,1,O,P,ba,Q,S,a.$f);a.push(z,G,V,X,-1,O,P,ba,Q,S,a.$f)}else a.push(z,G,V,X,0,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,1,Q,S,a.$f),a.push(z,G,V,X,0,O,P,1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,0,Q,S,a.$f),m&&(b.push(q+2,q+0,q+3),b.push(q+2,q+1,q+0),b.push(q+3,q+0,q+4),b.push(q+4,q+0,q+5));B!==x-1?(ba=0===B?0:1,a.push(z,G,V,X,1,O,P, ba,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,ba,Q,S,a.$f)):(a.push(z,G,V,X,0,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,0,Q,S,a.$f),a.push(z,G,V,X,1,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,0,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,-1,Q,S,a.$f),a.push(z,G,V,X,-1,O,P,0,Q,S,a.$f));B!==x-1?(b.push(s+4*B,s+4*B+3,s+4*B+1),b.push(s+4*B,s+4*B+2,s+4*B+3)):m&&(z=s+4*(x-1),b.push(z+1,z+2,z+0),b.push(z+2,z+3,z+0),b.push(z+0,z+4,z+5),b.push(z+0,z+3,z+4))}c.push(y)}}}function m(a,b,c,d,e){for(var g=[],h=0,k=c.length;h<k;h+=1){var l=[], m=[],n=u(c[h]),p=r(n,d,e);g.push(p[2]);if(1<p[1].length){var q=p[1].length;p[1].forEach(function(a,b,c){var d=c[b-1];c=c[b+1];0===b?d=a:b===q-1&&(c=a);l.push(a[0],a[1],p[2][b][0],p[2][b][1],1,d[0],d[1],c[0],c[1]);l.push(a[0],a[1],p[2][b][0],p[2][b][1],-1,d[0],d[1],c[0],c[1]);0===b?m.push(0,1,2):b!=q-1?(m.push(2*(b-1)+1,2*b+1,2*b),m.push(2*b,2*b+1,2*(b+1))):m.push(2*(b-1)+1,2*b+1,2*b)});a.push(l);b.push(m)}}}function n(a,b,c,d,e,g,h,k){for(var l=0,m=d.length;l<m;l+=1){var n=a.length/2,p=r(u(d[l],v, g),e,h);if(2<p[1].length&&(n=G.Gp(p[1],[],n),n.length&&(a.push.apply(a,p[0]),b.push.apply(b,n),c.push(p[2]),k)))for(var n=0,q=p[2].length;n<q;n+=1){var s=p[2][n][0]/512,t=p[2][n][1]/512;1==e.x%2&&(s+=0.5);1==e.y%2&&(t+=0.5);k.push(s,t)}}}function p(a,b,c){function d(a,b){for(var c=0,e=a.length;c<e;c++)a[c]+=b;return a}var e=a.Ba,g=[],h=[],k=[],l=[];q(a,h,k,c);for(var m=[[[0,0],[255,0],[255,255],[0,255]]],p=[[0,0],[255,0],[0,255],[255,255]],r=a.ti,u=0,t=p.length;u<t;u+=1){var v=p[u][0]/512,x=p[u][1]/ 512;1==r.x%2&&(v+=0.5);1==r.y%2&&(x+=0.5);l.push(v,x)}g.push([h,k,s("ff"+a.EI.substr(1)),"regions:land",m,l]);e.sort(function(a,b){return"string"===typeof a?-1:"string"===typeof b?1:a[2]>b[2]?1:a[2]<b[2]?-1:0});p=1;for(r=e.length;p<r;p+=1)u=e[p],h=[],k=[],m=[],l=[],t=s(u[1].split("&")[0]),n(h,k,m,u[0],a.ti,b,c,l),g.push([h,k,t,u[3],m,l]);b={Tp:[],gs:[],Ia:[],Nh:[],Lp:[]};h=e=c=0;for(k=g.length;h<k;h++)l=g[h],b.Ia.push.apply(b.Ia,l[0]),b.Nh.push.apply(b.Nh,d(l[1],c)),b.Lp.push.apply(b.Lp,l[5]),b.gs.push([l[2], l[3]]),b.Tp.push([l[1].length,e]),e+=l[1].length,c+=l[0].length/2,delete l[0],delete l[1],delete l[5];b.Ia=new Float32Array(b.Ia);b.Nh=new Uint16Array(b.Nh);b.Lp=new Float32Array(b.Lp);g.buffer=b;a.Ba=g;return a}function q(a,b,c,d){var e=a.ti;a=256*e.x*d-215440491;e=256*e.y*d-106744817;b.push(a,e);var g=256*d;d=a+g;b.push(d,e);e+=g;b.push(a,e);b.push(d,e);c.push(0,1,2,1,3,2)}function s(a){for(var b=[],c=0,d=a.length;c<d;c+=2)b.push(parseInt(a.substr(c,2),16)/255);b.push(b.shift());return b}function r(a, b,c,d){var e=0,g=0,e=256*b.x,g=256*b.y;b=[];for(var h=[],k=[],l=0,m=a.length;l<m;l+=2){var n=(e+a[l])*c-215440491,p=(g+a[l+1])*c-106744817,q=k.length;if(d||0===b.length)k.push(n),k.push(p),b.push([n,p]),h.push([a[l],a[l+1]]);else if(n!==k[q-2]||p!==k[q-1])n===k[q-2]&&n===k[q-4]?(k[q-1]=p,b[b.length-1][1]=p,h[b.length-1][1]=a[l+1]):p===k[q-1]&&p===k[q-3]?(k[q-2]=n,b[b.length-1][0]=n,h[b.length-1][0]=a[l]):(k.push(n),k.push(p),b.push([n,p]),h.push([a[l],a[l+1]]))}return[k,b,h]}function u(a,b,c){var d= "ASDFGHJKLQWERTYUIO!sdfghjkleiu3~yr5-P&mq9`%zCN*b=8@^xpVM";b=b||"v5";var e,g;"v5"<b?(e=d.length,g=512):(e=27,d=d.substr(0,27),g=333);var h,k,l,m,n;k=[];l=NaN;m=0;for(n=a.length;m<n;m++)h=a[m],h=d.indexOf(h),isNaN(l)?l=h*e:(h=l+h-g,18===c&&"v5"<b&&(h/=4),k.push(h),l=NaN);return k}var v,x=Number.EPSILON||2E-16,t,y=!1,B=null,z=!0,G={Df:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d][0]*a[e][1]-a[e][0]*a[d][1];return 0.5*c},ZM:function(){return function(a,b){var c=a.length;if(3>c)return null; var d=[],e=[],g=[],h,k,l;if(0<G.Df(a))for(k=0;k<c;k++)e[k]=k;else for(k=0;k<c;k++)e[k]=c-1-k;var m=2*c;for(k=c-1;2<c&&!(0>=m--);){h=k;c<=h&&(h=0);k=h+1;c<=k&&(k=0);l=k+1;c<=l&&(l=0);var n;a:{var p=n=void 0,q=void 0,r=void 0,s=void 0,u=void 0,t=void 0,v=void 0,y=void 0,p=a[e[h]][0],q=a[e[h]][1],r=a[e[k]][0],s=a[e[k]][1],u=a[e[l]][0],t=a[e[l]][1];if(x>(r-p)*(t-q)-(s-q)*(u-p))n=!1;else{var B=void 0,z=void 0,X=void 0,Q=void 0,S=void 0,O=void 0,P=void 0,ba=void 0,ga=void 0,la=void 0,ga=ba=P=y=v=void 0, B=u-r,z=t-s,X=p-u,Q=q-t,S=r-p,O=s-q;for(n=0;n<c;n++)if(v=a[e[n]][0],y=a[e[n]][1],!(v===p&&y===q||v===r&&y===s||v===u&&y===t)&&(P=v-p,ba=y-q,ga=v-r,la=y-s,v-=u,y-=t,ga=B*la-z*ga,P=S*ba-O*P,ba=X*y-Q*v,ga>=-x&&ba>=-x&&P>=-x)){n=!1;break a}n=!0}}if(n){d.push([a[e[h]],a[e[k]],a[e[l]]]);g.push([e[h],e[k],e[l]]);h=k;for(l=k+1;l<c;h++,l++)e[h]=e[l];c--;m=2*c}}return b?g:d}}(),Gp:function(a,b,c,d){var e,g,h,k={};b=0;for(e=a.length;b<e;b++)h=a[b][0]+":"+a[b][1],k[h]=b;a=G.ZM(a,!1);if(!a)return[];if(d)return a; var l=[];b=0;for(e=a.length;b<e;b++)for(g=a[b],d=0;3>d;d++)h=g[d][0]+":"+g[d][1],h=k[h],l.push(h+c);return l},Qda:function(a){return 0>G.Df(a)}};return{RX:function(e,g){function h(a){var b=a.Ba;q&&b&&1<b.length&&b.slice(1).forEach(function(b){if(b&&null===b[1]){var c=b[b.length-1],d=q[c];b[1]=d.browserStyle[d.levelStyleMapping[m]];"road"===a.Wc&&(b[1]=b[1][0],b[4]=d,b[4].id=c)}})}v=e.Ed;y=e.Mda;t=e.mode;z=e.Ky;var l=y?c:d,m=e.uu,n=e.Vu,q=null;B=e.pC;var r=e.Y,s=[],u=Math.pow(2,20-m);e.Lc&&(q=e.Lc.stylemaps); for(var x=0,G=e.Uc.length;x<G;x+=1){var T=e.Uc[x],W=T.Wc;h(T);switch(W){case "region":s.push(p(T,m,u));break;case "road":s.push(k(T,m,n,u,e.KY));break;case "building":s.push(l(T,m,n,r,u,e.Y$,e.mu))}}delete e.Lc;e.Uc=s;if(a){l=[];x=0;for(G=s.length;x<G;x++)if((n=s[x].Ba)&&n.length)for(r=0,u=n.length;r<u;r++)n[r].buffer&&n[r].buffer instanceof ArrayBuffer&&l.push(n[r].buffer);a.vx(l)}g(null,{data:e})},aga:function(a,b){for(var c=a.Uc,d=Math.pow(2,20-a.nc),e=[],h=0,k=c.length;h<k;h++)e.push(g(c[h],d)); a.Uc=e;b(null,{data:a})},TX:function(a,b){var c=a.Nr.reduce(function(a,b){return a.concat(b)},[]),c=h(c);b(null,{data:c})},PX:function(a,b){var c=a.ib,d=a.hj,e=0,g=Math.PI/180*6,h=[],k=[];h.push(c[0],c[1]);for(var l=0;60>l;l++)h.push(c[0]+d*Math.cos(e),c[1]+d*Math.sin(e)),e+=g,0<l&&k.push(0,l,l+1),59==l&&k.push(0,l+1,1);b(null,{data:[h,k]})},Pna:function(){}}};w.s_=a();w.WE=new w.Os(a,{lazy:"untilCall"});w.l.Br&&w.kf.Zj(null,a)}})(w);(function(){function a(){function a(b,c,d,e,g,k){var l=[0,0,0,0,0],n=d.slice(0,4).concat(l),p=[],s=Math.PI/180*6,A=void 0,I=void 0,A=d.slice(0,2),D=m(e),F=m(g),I=q.normalize(h(D).fg(h(A))),C=q.normalize(h(F).fg(h(A)));q.OK(I,k)?(A=q.oD(I),I=q.oD(C)):(A=q.oD(C),I=q.oD(I),k=[F,D],D=k[0],F=k[1],g=[g,e],e=g[0],g=g[1]);D=Math.ceil(Math.abs(I-A)/s);30<=D&&(D=60-D);for(k=0;k<D;k++)0===k?(n.push.apply(n,e.slice(0,4)),n.push.apply(n,l)):(F=(k*s+A)%(2*Math.PI),n.push.apply(n,d.slice(0,2).concat([0,0])),n.push(1* Math.cos(F),1*Math.sin(F),0,0,0)),0<k&&p.push(0,k,k+1);n.push.apply(n,g.slice(0,4));n.push.apply(n,l);p.push(0,D,D+1);var H=b.length/9;b.push.apply(b,n);c.push.apply(c,p.map(function(a){return a+H}));return n.length/9}function c(c,d,e,g,k,l){function n(a,b,c,d,e){var g=void 0;a.NC(b)||q.AW(a,b)?g=b:c&&d&&e?g=a:c&&!d&&e?g=b:c||d||e?c||!d||e?(g=q.normalize(a.mi(b)),I=q.cos(g,a),g=g.oJ(I)):g=a:g=b;return g}function p(a,b,c){if(void 0===c||!0===c)d.push(a[0],a[1]),d.push(-b.y,b.x,0,0),d.push(A,0,0),l.push(a[2]); if(void 0===c||!1===c)d.push(a[0],a[1]),d.push(b.y,-b.x,0,0),d.push(A,0,0),l.push(a[2])}var s=c.length,E=0,A=0,I=void 0,D=void 0;k&&(g="bevel");c.forEach(function(c,r,H){var K=H[r-1];H=H[r+1];var L=void 0;K&&(A+=q.Fd(c,K));if(0===r||r===s-1)0===r?(void 0===H&&(H=c),L=q.normalize(h(H[0]-c[0],H[1]-c[1])),e.push(0,1,2)):(L=q.normalize(h(c[0]-K[0],c[1]-K[1])),r=d.length/9+2,4===r?e.push(3,2,1):e.push(r-3-E,r-1,r-2)),p(c,L);else{var J=q.normalize(h(c[0]-K[0],c[1]-K[1])),N=q.normalize(h(H[0]-c[0],H[1]- c[1])),L=q.normalize(J.multiply(-1).mi(N));D=q.OK(L,J);I=q.cos(L,J);p(c,n(J,N,D,!0,!0),!0);p(c,n(J,N,D,!0,!1),!1);p(c,n(J,N,D,!1,!0),!0);p(c,n(J,N,D,!1,!1),!1);r=d.length/9;K=r-4;H=K+2;var M=9*K,T=M+9,W=T+9,Z=W+9;D?(W=m(d.slice(T,W)),M=m(d.slice(M,T)),M=q.normalize(h(W).fg(h(M))),M=Math.abs(q.cos(J,M)/q.sin(J,M)*2),d[T+7]=-M,d[Z+7]=M):(Z=m(d.slice(M,T)),T=m(d.slice(T,W)),T=q.normalize(h(Z).fg(h(T))),T=Math.abs(q.cos(T,J)/q.sin(T,J)*2),d[M+7]=-T,d[W+7]=T);q.AW(J,N)?e.push(K,K+1,K-2-E):e.push(K,K-1- E,K+1);"miter"==g&&(D?p(c,n(J,N,0,!0,!0),!0):p(c,n(J,N,0,!0,!0),!1),E=1);if("round"===g){M=N=J=void 0;D?(J=d.slice(9*(K+1),9*(K+2)),N=d.slice(9*K,9*(K+1)),M=d.slice(9*H,9*(H+1))):(J=d.slice(9*K,9*(K+1)),N=d.slice(9*(K+1),9*(K+2)),M=d.slice(9*(H+1),9*(H+2)));L=a(d,e,J,N,M,L.multiply(-1));if(l)for(;0<L--;)l.push(c[2]);E=d.length/9-r}e.push(H,H+1,H+2+E);k||"bevel"!=g&&"miter"!=g||(D?e.push(H,K,K+1):e.push(H,H-1,H+1),"miter"==g&&(D?e.push(H+2,H-2,H):e.push(H+2,H+1,H-1)))}})}function d(a,b,c,d){function e(a, b){var c=void 0;if(a.NC(b))c=b;else{var c=q.normalize(a.mi(b)),d=q.cos(c,a);d>Math.sqrt(3)/2&&(d=Math.sqrt(3)/2);c=c.oJ(d)}return c}function g(a,c,e){if(void 0===e||!0===e)b.push(a[0],a[1]),b.push(-c.y,c.x,0,0),b.push(m,0,0),d.push(a[2]);if(void 0===e||!1===e)b.push(a[0],a[1]),b.push(c.y,-c.x,0,0),b.push(m,0,0),d.push(a[2])}for(var k=a[0],l=a[a.length-1],m=0,n=void 0;k[0]===l[0]&&k[1]===l[1]&&k!==l;)a.pop(),l=a[a.length-1];a.push(k);a.push(a[1]);a.unshift(l);var p=a.length;a.forEach(function(a,d, k){var l=k[d-1];k=k[d+1];var r=void 0;l&&(m+=q.Fd(a,l));if(0===d||d===p-1)0===d?(r=q.normalize(h(k[0]-a[0],k[1]-a[1])),c.push(0,1,2)):(r=q.normalize(h(a[0]-l[0],a[1]-l[1])),d=b.length/9+2,c.push(d-3,d-1,d-2)),g(a,r);else{d=q.normalize(h(a[0]-l[0],a[1]-l[1]));k=q.normalize(h(k[0]-a[0],k[1]-a[1]));l=q.normalize(d.multiply(-1).mi(k));n=q.OK(l,d);g(a,e(d,k),!0);g(a,e(d,k),!1);g(a,e(d,k),!0);g(a,e(d,k),!1);a=b.length/9-4;k=a+2;var r=9*a,s=r+9,x=s+9,B=x+9;d=Math.abs(q.cos(d,l)/q.sin(d,l));n?(b[r+7]=d,b[s+ 7]=-d,b[x+7]=-d,b[B+7]=d):(b[r+7]=-d,b[s+7]=d,b[x+7]=d,b[B+7]=-d);c.push(a,a-1,a+1);c.push(k,k+1,k+2)}})}function e(c,d,e){function g(a,b){if(p)for(;0<a--;)p.push(b)}function m(a,b){E.push.apply(E,a.slice(0,k));E.push(b.x,b.y);E.push.apply(E,a.slice(l));E.push.apply(E,a)}var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"butt",p=arguments[4],s=c.length-1,G=d.length,E=[],A=[],I=[d.slice(0,9),d.slice(9,18)],D=[d.slice(G-9,G),d.slice(G-18,G-9)];"square"===n?(n=q.normalize(h(c[0]).fg(h(c[1]))), m(I[0],n),m(I[1],n),n=q.normalize(h(c[s]).fg(h(c[s-1]))),m(D[0],n),m(D[1],n),A.push(0,2,3,3,1,0),A.push(6,7,4,4,7,5),p&&(p.push(c[0][2]),p.push(c[s][2]))):"round"===n&&(n=I[0].slice(0,2).concat(0,0,0,0).concat(I[0].slice(l)),I=a(d,e,n,I[0],I[1],q.normalize(h(c[0]).fg(h(c[1])))),g(I,c[0][2]),n=D[0].slice(0,2).concat(0,0,0,0).concat(D[0].slice(l)),I=a(d,e,n,D[0],D[1],q.normalize(h(c[s]).fg(h(c[s-1])))),g(I,c[s][2]));d.push.apply(d,E);e.push.apply(e,A.map(function(a){return a+G/9}))}function g(a,b){var c= [];a.forEach(function(a){var d=a[0],e=a[1];a=a[2];b&&(d-=p[0],e-=p[1]);var g=c.length-1;if(-1===g)c.push([d,e,a]);else if(d!==c[g][0]||e!==c[g][1]||a!==c[g][2])if(1<=g){var k=q.normalize(h(d-c[g][0],e-c[g][1])),l=q.normalize(h(c[g][0]-c[g-1][0],c[g][1]-c[g-1][1]));k.NC(l)&&a===c[g][2]?c[g]=[d,e,a]:c.push([d,e,a])}else c.push([d,e,a])});return c}function h(a,b){"object"===typeof a&&a.length&&(b=a[1],a=a[0]);return w.a.create(s,{x:{value:a},y:{value:b}})}var k,l;function m(a){return[a[0]+n*a[2],a[1]+ n*a[3]]}var n=1;k=4;l=6;var p=[215440491,106744817],q={normalize:function(a){var b=this.length(a);return a.oJ(b)},Qj:function(a,b){return a.multiply(b)},gJ:function(a,b){return a.x*b.y-a.y*b.x},length:function(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))},sin:function(a,b){return this.gJ(a,b)/(this.length(a)*this.length(b))},cos:function(a,b){return this.Qj(a,b)/(this.length(a)*this.length(b))},OK:function(a,b){return 0<this.gJ(a,b)},Fd:function(a,b){return Math.sqrt(Math.pow(b[0]-a[0],2)+ Math.pow(b[1]-a[1],2))},AW:function(a,b){return a.multiply(-1).NC(b)},oD:function(a){a=Math.atan2(a.y,a.x);0>=a&&(a+=2*Math.PI);return a}},s={mi:function(a){return h(this.x+a.x,this.y+a.y)},fg:function(a){return h(this.x-a.x,this.y-a.y)},multiply:function(a){return"number"===typeof a?h(this.x*a,this.y*a):this.x*a.x+this.y*a.y},oJ:function(a){return h(this.x/a,this.y/a)},NC:function(a){var b=a.y;return this.x===a.x&&this.y===b}};return{parse:function(a,b){var h=a.lineJoin,h=void 0===h?"bevel":h,k= a.lineCap,k=void 0===k?"butt":k,l=a.Zda,l=void 0===l?!1:l,m=a.tn,n=void 0===m?!1:m,p=a.LX,m=a.Iia,q=void 0===m?!0:m,m=a.Sda,s=[],A=[],I=g(a.Nr,void 0===p?!0:p),p=[];l?(d(I,s,A,p),h=s.length,[0,1,2,h/9-1,h/9-2].forEach(function(a){s[9*a+8]=-1})):(c(I,s,A,h,n,p),e(I,s,A,k,p));q&&(s=new Float32Array(s),A=65535<A.length?new Uint32Array(A):new Uint16Array(A));h=[s,A];m&&h.push(p);if(b)b(null,{data:h});else return h}}}w.uN=a();w.Jja=new w.Os(a,{})})();w.pk={Jda:function(a,b,c){b=w.pk.createProgram(a,b,c);if(!b)return console.log("Failed to create program"),!1;a.useProgram(b);a.ab=b;return!0},createProgram:function(a,b,c){b=w.pk.bX(a,a.VERTEX_SHADER,b);c=w.pk.bX(a,a.FRAGMENT_SHADER,c);if(!b||!c)return null;var d=a.createProgram();if(!d)return null;a.attachShader(d,b);a.attachShader(d,c);a.bindAttribLocation(d,0,"a_Position");a.linkProgram(d);return a.getProgramParameter(d,a.LINK_STATUS)?d:(console.log("Failed to link program: "+a.getProgramInfoLog(d)), a.deleteProgram(d),a.deleteShader(c),a.deleteShader(b),null)},bX:function(a,b,c){b=a.createShader(b);if(null===b)return console.log("unable to create shader"),null;a.shaderSource(b,c);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(console.log("Failed to compile shader: "+a.getShaderInfoLog(b)),a.deleteShader(b),null)},Pe:function(a,b,c,d){var e=d,g=!1;"number"!==typeof d&&(e=d.toString(),g=!0);if(c.uT!==e){var h="uniform"+b;if(g&&2===b.length)a[h].apply(a,[c].concat(d));else a[h](c, d);c.uT=e}},Mx:function(a){a.length||(a=[a]);for(var b=0,c=a.length;b<c;b++)delete a[b].uT}};w.Q.uf.Yc=w.Q.Gd.zi.extend({ga:[w.Ls],B:function(a,b){this.Ni=20;this.kb=Math.min(2,window.devicePixelRatio||1);this.qp=1;arguments.callee.oa.apply(this,arguments);this.X("mapStyle",a.g);this.X("style",a.g);this.bg=this.ji=!0;a.g.J.vn&&this.Ax(a,b);this.Cm=0;this.Jj={};this.nD()||this.set("reload")},R0:"precision highp float;attribute vec4 a_Position;attribute vec3 a_op,a_Next,a_Previous;attribute float a_Tags;uniform float u_xDelta,u_width;uniform lowp int u_type;uniform mat4 u_othMatrix,u_zoomMatrix,u_modelMatrix;uniform float u_scale;varying float v_distance;varying vec2 v_op;varying float v_TB;varying float v_cap;varying lowp float v_Tags;void main() {vec4 position=a_Position;position.x+=u_xDelta;if (u_type==0) {gl_Position=u_othMatrix*u_zoomMatrix*u_modelMatrix*position;}else if(u_type>1) {v_op=a_op.xy;v_TB=a_op.z;vec3 curPos=position.xyz;v_distance=a_Next.z;float ddis=0.0;vec3 previous=vec3(a_Previous.x+u_xDelta,a_Previous.y,0);vec3 next=vec3(a_Next.x+u_xDelta,a_Next.y,0);vec4 up,dir;v_distance *= u_scale;if(previous==curPos){ dir= vec4(normalize(next-curPos).xy,0,0);}else if(next==curPos){dir= -vec4(normalize(previous-curPos).xy,0,0);}else {vec3 dir0=previous-curPos;vec3 dir1=next-curPos;vec3 dir2=normalize(dir0);vec3 dir3=normalize(dir1);float f0=dir0.x*dir1.y-dir1.x*dir0.y;dir = vec4(0); v_cap=1.0;if(f0==0.0){up = vec4(dir3.y,-dir3.x,0,0); }else{vec3 dir4=normalize(dir2+dir3);float sinA=length(cross(dir4,dir2));float cosA=dot(dir4,dir2);if(sinA<0.5){sinA=0.5;}up= vec4(dir4,0)/sinA;ddis=abs(length(up)*cosA*u_width*0.5);if(f0<0.0){up=-up;ddis=-ddis;}v_distance += v_TB*a_Previous.z*ddis;}}if(previous==curPos||next==curPos){ up = vec4(dir.y,-dir.x,0,0); if(u_type==4){v_cap=sqrt(v_TB*v_TB+a_Previous.z*a_Previous.z);}else if(u_type==3){v_cap=1.0;}else{dir = vec4(0);}}vec4 pos=u_zoomMatrix*u_modelMatrix*position;pos=pos+(up*v_TB-dir*a_Previous.z)*u_width*0.5;gl_Position=u_othMatrix*pos;}else if (u_type==1) {v_Tags=a_Tags;gl_Position=u_othMatrix*u_zoomMatrix*u_modelMatrix*position;}}", S_:"precision lowp float;uniform vec4 u_FragColor,u_FragColor2;varying lowp float v_distance,v_TB;varying vec2 v_op;varying lowp float v_Tags;varying float v_cap;uniform lowp int u_type;uniform int u_isDash,u_onlyBorder;uniform vec4 u_dash;void main() {vec4 color=u_FragColor;if (u_type==0) {}else if(u_type>1) {if(v_op.x<-0.2||v_op.x>256.2||v_op.y<-0.2||v_op.y>256.2){discard;}if(v_cap>1.0){discard;}if(u_isDash==1){float all = u_dash[0] + u_dash[1] + u_dash[2] + u_dash[3];float off = mod(v_distance - u_dash[0], all);if(off> u_dash[0]&&off<=(u_dash[0]+u_dash[1])||off>(all-u_dash[3])){discard;}}if(u_onlyBorder==1&&v_TB<=0.7&&v_TB>=-0.7){discard;}}else if(u_type==1) {color=v_Tags==3.0?u_FragColor2:vec4((u_FragColor+(u_FragColor2-u_FragColor)*v_Tags/3.0).xyzw);}gl_FragColor=color;}", reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.Qa&&this.Qa.parentNode&&this.Qa.parentNode.removeChild(this.Qa);this.set("display")},Fu:function(a){if(this.q&&a.XK===this.q.Ac)for(var b=0,c=a.Uc.length;b<c;b+=1)this.Qy(a.Uc[b],a.uu,a.Vu,a.Y)},cM:function(a){for(var b=this.Pa,c=a.buffer,d=0,e=a.length;d<e;d+=1){var g=a[d];this.g.jk&&g[3]&&!this.g.ec&&(g[2]=this.T.Ro(g[2],g[3]),c.gs[d][0]=g[2])}c.Ia=this.wf(b.ARRAY_BUFFER,c.Ia);c.Nh=this.wf(b.ELEMENT_ARRAY_BUFFER,c.Nh)},mM:function(a){for(var b= 0,c=a.length;b<c;b+=1){var d=a[b];d.Kf=d[1].length;d[0]=this.wf(this.Pa.ARRAY_BUFFER,d[0]);d[1]=this.wf(this.Pa.ELEMENT_ARRAY_BUFFER,d[1]);this.g.jk&&d[2][10]&&!this.g.ec&&(d[2][1]=this.T.Uj(d[2][1],d[2][10],1),d[2][4]=this.T.Uj(d[2][4],d[2][10],0))}},OI:function(a){for(var b=0,c=a.length;b<c;b+=1){var d=a[b];d.Ny=d[0].length/3;d[0]=this.wf(this.Pa.ARRAY_BUFFER,d[0]);d.GD=d[1].length/3;d[1]=this.wf(this.Pa.ARRAY_BUFFER,d[1]);d.Oy=d[2].length/3;d[2]=this.wf(this.Pa.ARRAY_BUFFER,d[2]);if(this.g.jk&& d[3][2]&&!this.g.ec){var e=this.T.gr(d[3][0],d[3][1],d[3][2]);d[3][0]=e[0];d[3][1]=e[1]}}},wf:function(a,b){if(b.length){var c=this.Pa,d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,b,c.STATIC_DRAW);return d}},jV:function(a){var b=a.ma,c=b.x,d=b.y,e=b.z,g=Math.pow(2,e),h=(c+g)%g,k=h+g,l=h-g,m=null;h!==c&&(m=this.qr(e,h,d));m||l===c||(m=this.qr(e,l,d));m||k===c||(m=this.qr(e,k,d));return m?(a.status=m.status,a.qa=m.qa,a.hc=m.hc,a.Pc=m.Pc,a.Ga={building:m.Ga.building,region:m.Ga.region,road:m.Ga.road, en:(b.x-m.ma.x)/g+m.Ga.en},!0):!1},qr:function(a,b,c){if((a=this.wa.get(a+"/"+b+"/"+c))&&a.Ga)return a},Qy:function(a){var b=a.Wc,c=this.wa.get(a.ll);if(c){c.Ga||(c.Ga={en:0});c.Ga[b]=a.Ba;if("region"===b)this.cM(a.Ba);else if("road"===b)for(var d in a.Ba)a.Ba.hasOwnProperty(d)&&this.mM(a.Ba[d]);else"building"===b&&(this.OI(a.Ba),a.Xk&&a.Xk.length&&!c.Te&&(c.Te={},c.Te.je=a.Xk,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:c})));b===this.q.xa[this.q.xa.length-1]&&(c.qa=!0,this.set("display"))}},ld:function(){if(this.rg&& !this.q.ta){var a=this.q;this.g.Ey||w.Yd.ue.end({key:"rb",index:2,id:this.g.J.id});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.ia("complete"))}},kc:function(a,b){!window.wa&&this.wa&&(window.wa=this.wa);this.rk=a.rk;this.mm(a,b);this.ld();a.kD||(a.G$=this.rg,this.Tu(a,b),this.ep=this.gb,this.pi&&this.set("display",0))},gi:function(){return this.Qa},Py:function(){w.Q.uf.Yc.Go+=1;this.Qa&&w.C.I(this.Qa,"webglcontextlost",this.Py,this);this.Qa.parentNode&&this.Qa.parentNode.removeChild(this.Qa);if(1< w.Q.uf.Yc.Go)this.OD();else{var a=this.Qa.className;this.Qa=document.createElement("canvas");this.Qa.className=a;this.nD()}this.set("reload");new w.Sa.fb(w.A.Rb+"://webapi.amap.com/count?"+["type=glfail","c="+w.Q.uf.Yc.Go,"crd="+w.l.qK,"k="+w.A.key,"u="+w.A.Sm,"m="+(w.l.Y?1:0),"pf="+w.l.Pr,"dpr="+window.devicePixelRatio,"scale="+(w.l.SE||0),"detect="+w.l.ja].join("&"))},OD:function(){w.l.Je=!1;this.q&&this.q.g.J&&(this.q.g.set("baseRender",w.l.SU?"dv":"d"),this.q.g.J.fL(),this.q.Q=null,this.q.fa.up(), this.q=null);this.Qa=this.T=null},Ef:function(a){this.Qa=document.createElement("canvas");this.Qa.className=a||"amap-layer"},nD:function(){if(1<w.Q.uf.Yc.Go)return this.OD(),!1;var a=this.Pa=this.Qa.getContext(w.l.q_,w.l.r_);if(a)w.C.h(this.Qa,"webglcontextlost",this.Py,this);else return this.OD(),!1;w.pk.Jda(a,this.R0,this.S_);this.mN=a.getUniformLocation(a.ab,"u_xDelta");this.d_=a.getUniformLocation(a.ab,"u_othMatrix");this.g_=a.getUniformLocation(a.ab,"u_zoomMatrix");this.c_=a.getUniformLocation(a.ab, "u_modelMatrix");this.mf=a.getAttribLocation(a.ab,"a_Position");this.Lj=a.getAttribLocation(a.ab,"a_op");this.Kj=a.getAttribLocation(a.ab,"a_Previous");this.xh=a.getAttribLocation(a.ab,"a_Next");this.Gt=a.getAttribLocation(a.ab,"a_Tags");a.enableVertexAttribArray(this.mf);this.Sh=a.getUniformLocation(a.ab,"u_FragColor");this.mv=a.getUniformLocation(a.ab,"u_FragColor2");this.ui=a.getUniformLocation(a.ab,"u_type");this.os=a.getUniformLocation(a.ab,"u_width");this.eN=a.getUniformLocation(a.ab,"u_isDash"); this.fN=a.getUniformLocation(a.ab,"u_onlyBorder");this.bN=a.getUniformLocation(a.ab,"u_dash");this.jN=a.getUniformLocation(a.ab,"u_scale");a.enable(a.BLEND);a.enable(a.CULL_FACE);a.cullFace(a.FRONT);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.clearColor(0,0,0,0);this.Hu=this.St=this.tn=void 0;this.qk=0;return!0},Ur:function(a){var b=Math.pow(2,a.W.zoom-this.re),c=a.W.gb.Ua(this.ep).wc(this.qi);this.transform={translate:this.transform[0].translate.add(c), scale:b,rotate:0};this.gb=a.W.gb},Tu:function(a,b){var c=this.DI(a,b),d=this.Pa;d.clear(d.COLOR_BUFFER_BIT);var e=this.q.ja?this.kb:this.qp,g=0,h=0;0!==a.W.rotation?(g=2*Math.floor(a.W.Aa.Vb.x)*e,h=2*Math.floor(a.W.Aa.Vb.y)*e):(g=a.size.width*e,h=a.size.height*e);g&&h&&(this.Qa.width=g,this.Qa.height=h,d.viewport(0,0,this.Qa.width,this.Qa.height),this.vp.apply(this,c),this.Qe(a))},zp:256*Math.pow(2,20),tJ:function(a,b){w.pk.Mx([this.Sh]);for(var c=0,d=b.length;c<d;c++){var e=b[c],g=e.Ga.region;if(g&& g.length){this.Xm(e.Ga.en*this.zp);e=g.buffer;a.bindBuffer(a.ARRAY_BUFFER,e.Ia);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e.Nh);for(var h=0,k=e.Tp.length;h<k;h++){var l=e.gs[h],m=l[0];(l=l[1])&&this.g.ec&&(m=this.T.Ro(m,l),g[h].ed=m);m&&(a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,8,0),a.uniform4f(this.Sh,m[0],m[1],m[2],m[3]),a.drawElements(a.TRIANGLES,e.Tp[h][0],a.UNSIGNED_SHORT,2*e.Tp[h][1]))}}}},uJ:function(a,b){var c=w.pk,d=this.q.ja?this.kb:this.qp;c.Mx([this.Sh,this.ui,this.os]);for(var e in b)if(b.hasOwnProperty(e)){for(var g= b[e],h=0;h<g.length;h+=1){var k=g[h],l=k[2],m=l[4],n=l[10];n&&this.g.ec&&(m=this.T.Uj(m,n,0),k.ed=m);if(m){n="square"===k[2][9]?3:"round"===k[2][9]?4:2;c.Pe(a,"1i",this.ui,n);var p=this.uw(l)[1];p&&(this.Xm(k.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,k[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(this.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(this.Kj,3,a.FLOAT,!1,44,20),a.vertexAttribPointer(this.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,k[1]),k=k.Kf, c.Pe(a,"1f",this.os,p*d),c.Pe(a,"4f",this.Sh,m),this.Wm(l[5]?1:0,l[5],0),a.drawElements(a.TRIANGLES,k,a.UNSIGNED_SHORT,0))}}for(h=0;h<g.length;h+=1)if(k=g[h],l=k[2],m=this.uw(l)[0])p=l[1],(n=l[10])&&this.g.ec&&(p=this.T.Uj(p,n,1),k.ed=p),p&&(n="square"===k[2][8]?3:"round"===k[2][8]?4:2,c.Pe(a,"1i",this.ui,n),this.Xm(k.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,k[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(this.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(this.Kj,3,a.FLOAT, !1,44,20),a.vertexAttribPointer(this.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,k[1]),k=k.Kf,c.Pe(a,"1f",this.os,m*d),c.Pe(a,"4f",this.Sh,p),this.Wm(l[2]?1:0,l[2],l[6]?1:0),a.drawElements(a.TRIANGLES,k,a.UNSIGNED_SHORT,0))}},fc:new w.G(215440491,106744817),vp:function(a,b,c){if(a.length){this.hc+=1;b=this.Qa.width;c=this.Qa.height;var d=this.Pa;b=(new w.ge).dZ(-b/2,b/2,c/2,-c/2,0);c=Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:this.qp);c=(new w.ge).scale(c,c,1);var e=this.gb.wc(this.S/ Math.pow(2,this.Ni-this.zoom)).Ua(this.fc),e=(new w.ge).translate(-e.x,-e.y,0);d.uniformMatrix4fv(this.d_,!1,b.elements);d.uniformMatrix4fv(this.g_,!1,c.elements);d.uniformMatrix4fv(this.c_,!1,e.elements);d.uniform1f(this.jN,Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:1));b=this.Fm=[];for(c=a.length-1;0<=c;c-=1){e=a[c];d.disableVertexAttribArray(this.Lj);d.disableVertexAttribArray(this.Kj);d.disableVertexAttribArray(this.xh);d.disableVertexAttribArray(this.Gt);this.Wm(0,void 0,void 0);d.uniform1i(this.ui, 0);this.Xm(0);for(var g=0,h=e.length;g<h;g+=1){var k=e[g];e[g].Ga&&(k.hc=this.hc,b.push(k))}this.tJ(d,e);d.enableVertexAttribArray(this.Lj);d.enableVertexAttribArray(this.Kj);d.enableVertexAttribArray(this.xh);d.disableVertexAttribArray(this.Gt);if(e.length){for(var l={},g=0,h=e.length;g<h;g+=1){var k=e[g],m=k.Ga.road;if(m)for(var n in m)if(m.hasOwnProperty(n)){l[n]||(l[n]=[]);for(var p=0,q=m[n].length;p<q;p+=1)m[n][p].qk=k.Ga.en,l[n].push(m[n][p])}}this.uJ(d,l,e[0].ma.z)}if(!(14>this.zoom))for(d.uniform1i(this.ui, 1),this.Wm(0,void 0,void 0),d.disableVertexAttribArray(this.Lj),d.disableVertexAttribArray(this.Kj),d.disableVertexAttribArray(this.xh),d.enableVertexAttribArray(this.Gt),g=0,h=e.length;g<h;g+=1)k=e[g],k.Ga.building&&this.KC(d,k)}}},KC:function(a,b){for(var c=b.Ga.building,d=0;d<c.length;d+=1){var e=c[d],g=e[3][0],h=e[3][1];if(!e||!g)break;var k=e[3][2];k&&this.g.ec&&(h=this.T.gr(g,h,k),g=h[0],h=h[1],e.ed=g);if(g||h)g||(g=[0,0,0,0]),h||(h=[0,0,0,0]),a.uniform4f(this.mv,g[0],g[1],g[2],g[3]),a.uniform4f(this.Sh, h[0],h[1],h[2],h[3]),e.Ny&&(a.bindBuffer(a.ARRAY_BUFFER,e[0]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8),a.drawArrays(a.TRIANGLES,0,e.Ny)),e.Oy&&(a.bindBuffer(a.ARRAY_BUFFER,e[2]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8),a.drawArrays(a.LINES,0,e.Oy)),e.GD&&(a.bindBuffer(a.ARRAY_BUFFER,e[1]),a.vertexAttribPointer(this.mf,2,a.FLOAT,!1,12,0),a.vertexAttribPointer(this.Gt,1,a.FLOAT,!1,12,8), a.drawArrays(a.TRIANGLES,0,e.GD))}},Wm:function(a,b,c){var d=this.Pa;a!==this.tn&&(d.uniform1i(this.eN,a),this.tn=a);a&&b!==this.St&&(this.St=b,d.uniform4f(this.bN,b[0],b[1],b[2]||0,b[3]||0));c!==this.Hu&&(d.uniform1i(this.fN,c),this.Hu=c)},Xm:function(a){a!==this.qk&&(this.Pa.uniform1f(this.mN,a),this.qk=a)},Qe:function(){this.transform={translate:{x:this.Qa.width/2,y:this.Qa.height/2},scale:this.q.ja?1/this.kb:1/this.qp,rotate:0}},oI:function(a,b,c){var d=null;if(a.length&&c)d=a[11].id+"-"+c,this.Jj[d]&& (a[0]=this.Jj[d][0],a[3]=this.Jj[d][3]);else return c=[],b&&b[0]&&(c=b[0].split("&")),(b=c[2])&&0===b.indexOf("railway")?(a[0]=1,a[3]=3):a[0]=parseInt(c[0])||0,c[3]&&c[4]&&3<c.length?(a[3]=a[0]+parseInt(c[3]),0===w.a.indexOf(c[5],"dash")&&(a[3]+=1)):a[3]=0,d&&void 0===this.Jj[d]&&(this.Jj[d]=[a[0],0,0,a[3]]),a},uw:function(a){function b(a,b,c){var d;a&&b?d=a+c%1*(b-a):0===a&&b?d=Math.max(0,c%1-0.5)/0.5*b:0===a&&0===b?d=0:0!==a&&0===b&&(d=0);return w.a.Sc(d,3)}var c=a[11].browserStyle,d=a[11].levelStyleMapping; if(18<this.zoom){var e=this.Fi(a,18,c,d);a=Math.pow(2,this.zoom-18);return[e[0]*a,e[3]*a]}if(w.a.zW(this.zoom))return e=this.Fi(a,this.zoom,c,d),[e[0],e[3]];e=this.Fi(a,Math.floor(this.zoom),c,d);c=this.Fi(a,Math.ceil(this.zoom),c,d);a=b(e[0],c[0],this.zoom);e=b(e[3],c[3],this.zoom);return[a,e]},Fi:function(a,b,c,d){a=a[11].id+"-"+b;this.Jj[a]||(this.Jj[a]=this.oI([],c[d[b]]));return this.Jj[a]}});w.Q.uf.Yc.Go=0; ')
_jsload_('AMap.CustomLayer', '$.w.oj=$.w.qc.extend({F:{visible:!0,opacity:1,zIndex:11,zooms:[3,20],alwaysRender:!1},B:function(a,b){this.CLASS_NAME=this.CLASS_NAME||"AMap.CustomLayer";w.e.eb(this.CLASS_NAME,b);this.Og=w.j.create("div",null,"amap-e");a&&(this.Og.appendChild(a),a.className="amap-custom");w.a.Bb(this,b);this.Qf(this.F)},setOpacity:function(a){w.e.add(this.CLASS_NAME,"setOpacity");this.Og&&w.j.Kn(this.Og,a);this.set("opacity",a,!0)},getContainer:function(){w.e.add(this.CLASS_NAME,"getContainer");return this.Og},show:function(){w.e.add(this.CLASS_NAME, "show");this.set("visible",!0)},hide:function(){w.e.add(this.CLASS_NAME,"hide");this.set("visible",!1)},setzIndex:function(a){w.e.add(this.CLASS_NAME,"setzIndex");this.set("zIndex",a,!0);this.Og&&(this.Og.style.zIndex=a)},sg:function(a){this.get("map")||this.set("map",a.J,!0);return new w.w.oj(this,a)}});window.AMap.CustomLayer=$.w.oj; $.w.Ds=$.w.oj.extend({B:function(a,b){this.CLASS_NAME=this.CLASS_NAME||"AMap.GLCustomLayer";arguments.callee.oa.apply(this,arguments)},setzIndex:function(a){w.e.add(this.CLASS_NAME,"setzIndex");this.set("zIndex",a)},sg:function(a){this.get("map")||this.set("map",a.J,!0);return new w.w.Ds(this,a)},setMap:function(a){w.e.add(this.CLASS_NAME,"setMap");var b=this.get("map");a?(b&&a!==b&&b.fk(this),"3D"===a.view.type&&this.set("map",a)):b&&(b.fk(this),this.set("map",null,!0),this.Oi=!1,this.gg&&this.gg())}}); window.AMap.GLCustomLayer=$.w.Ds;w.w.oj=w.w.qc.extend({B:function(a,b){this.fa=a;this.Xi=!0;this.eA=w.a.Jb(this);a&&this.he("opacity visible zIndex zooms container alwaysRender".split(" "),a);this.g=b;this.X("display",b)},mn:function(){return{visible:this.get("visible"),zIndex:this.get("zIndex"),gd:this.get("zooms"),opacity:this.get("opacity"),K:this.get("container"),wx:this.get("alwaysRender")}},KV:function(){return this.fa.render},Jl:function(a){if(w.Q.oj)return new w.Q.oj(this,a)}}); w.w.Ds=w.w.oj.extend({Jl:function(){return null},Kl:function(a){if(w.Ma.Ds)return new w.Ma.Ds(this,a)}});w.Q.oj=w.Q.qc.extend({gi:function(){return this.q.get("container")},kc:function(a,b){if(this.q){var c=a.W.gb;if(this.ra&&!this.q.fa.vs){if(this.ra===c&&this.re===a.W.zoom&&!this.g.ds)return;if(!b.wx&&(a.If||a.Se)){if(!w.j.jf&&a.Se){b.K.style.visibility="hidden";return}var c=Math.pow(2,a.W.zoom-this.re),d=a.W.gb.Ua(this.ra);d.x<-w.a.Za/2&&(d.x+=w.a.Za);d.x>w.a.Za/2&&(d.x-=w.a.Za);d=d.wc(this.qi);1!==c&&(b.K.style[w.j.jf]="scale3d("+c+","+c+",1)");b.K.style.top=-d.y*c+"px";b.K.style.left=-d.x*c+"px"; return}}(d=this.q.KV())&&d.call(this.q.fa,a);this.q.ta||(this.q.ta=!0,w.a.pc(function(){this.q&&(this.q.cd?this.q.ia("renderComplete"):(this.q.cd=!0,this.q.ia("complete")))},this));this.ra=c;this.qi=a.W.S;this.re=a.W.zoom;b.K.style.zIndex=b.zIndex;b.K.style[w.j.jf]="";b.K.style.top="";b.K.style.left="";b.K.style.height="";b.K.style.visibility="";w.j.Kn(b.K,b.opacity)}}}); ')
_jsload_('Map3D', 'w.dA=function(a,b,c){this.path=a;this.WY=b;this.height=c};w.dA.prototype={vb:function(){return new w.dA(this.path,this.WY,this.height)}};w.Ob.ob({HR:function(a){this.dL(a);this.Aq();this.Vf=!0;a.Bd&&(this.R.Yt=a.Bd.x,this.R.Xx=a.Bd.y);this.R.IC=a.sb.x;this.R.JC=a.sb.y;this.Pd&&(this.Pd.stop(),this.Oo(!0));this.ia("dragstart");this.ia("movestart");this.r("movestart",a)},DR:function(){var a=this.R.ei;if(2!=a.button&&!a.ctrlKey&&!a.shiftKey||this.R6(a)){var b=this.R;if(void 0!==b.Yt){if(!a.Bd)return;var c=a.Bd.x-b.Yt,a=a.Bd.y-b.Xx;this.TS(c,a);b=this.get("centerCoords").Ua(new w.G(c,a)).toFixed(3);this.set("centerCoords",b);this.xr&& (this.Wf?(b=new Date,this.lt=100<b-this.Wf?new w.G(0,0):new w.G(c,a),this.Wf=b):this.Wf=new Date)}else a.Bd&&(this.R.Yt=a.Bd.x,this.R.Xx=a.Bd.y);this.ia("dragging");this.ia("mapmove")}},FR:function(){this.ps();this.Aq();100<new Date-this.Wf&&(this.lt=null);this.R.Gf=null;this.Vf=!1;this.ia("dragend");if(this.xr&&this.lt)if(this.R.Bf){var a=this.lt,b=new w.G(0,0);a.x>=w.a.Za?a.x-=w.a.Za:a.x<=-w.a.Za&&(a.x+=w.a.Za);this.Pd=new w.yi(a,b,function(a,b,e){return 600<=e?b:a.Vc(1-Math.pow(e/600,1.5))},1); this.Pd.An=function(a){2>Math.abs(a.x)&&2>Math.abs(a.y)?(this.Pd.stop(),this.r("moveend"),this.Oo(),this.lt=this.Wf=null):(a=this.get("centerCoords").Ua(a).toFixed(3),this.set("centerCoords",a),this.ia("mapmove"))};this.Pd.il(this)}else this.r("moveend"),this.Oo(!0),this.lt=this.Wf=null;else this.r("moveend"),this.Oo(),this.lt=this.Wf=null},R6:function(a){var b=this.get("rotateEnable"),c=this.get("pitchEnable");if(b||c){var d=this.get("size"),e=a.sb.y-this.R.JC;if(Math.abs(a.sb.x-this.R.IC)<Math.abs(e)&& c)this.set("pitch",90*e/d.height+this.get("pitch"));else if(b){var b=this.R.IC-d.width/2,c=this.R.JC-d.height/2,e=a.sb.x-d.width/2,d=a.sb.y-d.height/2,g=Math.acos((b*e+c*d)/(Math.sqrt(b*b+c*c)*Math.sqrt(e*e+d*d)));0>b*d-e*c&&(g=-g);this.set("rotation",(g/Math.PI*180+this.get("rotation"))%360)}else return this.R.IC=a.sb.x,this.R.JC=a.sb.y,!0;this.R.IC=a.sb.x;this.R.JC=a.sb.y}else return!0}});w.w.oj.ob({Kl:function(a){return new w.Ma.oj(this,a)}});w.w.Xa.ob({Kl:function(a){return new w.Ma.zi(this,a)}});w.w.Yc.ob({Kl:function(a){var b=this;if(!this.g.ec||this.g.ec&&w.hb.yy(["wgl2"]))return new w.Ma.Yc(b,a);w.hb.load("wgl2",function(){b.set("display")})}}); w.w.Wh.ob({Kl:function(a){var b=this,c;if(this.FK())return this.rv=!0,w.Q.canvas.uF&&(this.XT(),c=new w.Ma.g0(this,a),c.h("afterLabelRender",this.Vv,this)),c;b.rv=!1;if(w.Q.canvas.tF)return c=new w.Ma.h0(this,a),c.h("afterLabelRender",this.Vv,this),c;w.hb.eg(["cmng","labelcanvas"],function(){b.set("display")})}});w.Ma={Rd:{}}; w.Ma.Wz=w.aa.extend({ga:[w.ka,w.te],B:function(a){this.type="3D";this.ZL=new w.oF;this.Oj={};this.Ne={};this.g=a;this.wj=a.wj;this.K=a.La.w;this.X("display",a);this.X("rotateEnable",a);this.X("hightlight",a);this.Ni=20;this.kb=Math.min(2,window.devicePixelRatio||1);this.qp=1;this.Qa=document.createElement("canvas");this.Qa.className="amap-layer";a.La.w.appendChild(this.Qa);this.nD();this.Qk=256*Math.pow(2,18);this.Ou={};this.lz=new w.Ma.hO(this);this.EM=new w.Ma.G0(this);this.fF=new w.Ma.fF(this);this.ja= a.J.ja;this.X("style",a)},nD:function(){var a=this.Pa=this.Qa.getContext(w.l.q_,w.l.r_);if(a)w.C.h(this.Qa,"webglcontextlost",this.Py,this);else return console.error("create webgl failed!"),!1;a.enable(a.CULL_FACE);a.frontFace(a.CW);a.cullFace(a.BACK);a.clearColor(0,0,0,0);this.ar||(this.ar=[this.xU()]);return!0},rW:function(a,b){var c=this.ZL,d=b.pd;if(d){d.oe||(d.oe=d.Wi());var e=new w.Ea(d.oe.Jf(a)),d=new w.Ea(d.oe.Jf(new w.qj(0,0,0,1))),e=e.sub(d).normalize();c.origin.copy(d);c.direction.copy(e); for(var e=b.Ia,d=b.Nh,g=new w.Ea,h=new w.Ea,k=new w.Ea,l=0,m=d.length;l<m;l+=3){var n=3*d[l],p=3*d[l+1],q=3*d[l+2];g.set(e[n],e[n+1],e[n+2]);h.set(e[p],e[p+1],e[p+2]);k.set(e[q],e[q+1],e[q+2]);if(c.qu(g,h,k))return b}}},hga:function(a){var b=[],c=this.g.get("zoom");if(this.lz.eD(c)){var d=this.rW(a,this.lz);d&&b.push({type:d.tz,color:w.RGBA.toString(d.ed)})}this.EM.eD(c)&&(a=this.rW(a,this.EM))&&b.push({type:a.tz,color:w.RGBA.toString(a.ed)});return b},tL:function(a,b,c,d){this.vd=a||w.a.Vr(this.g.vd.slice(1)); this.XB=b||w.a.Vr(this.g.XB.slice(1));this.fx=c||w.a.Vr(this.g.fx.slice(1));this.p9=d[0]||w.a.Li(this.g.iA[0]);this.Y9=d[1]||w.a.Li(this.g.iA[1])},Py:function(){w.Q.uf.Yc.Go+=1;this.set("reload");new w.Sa.fb(w.A.Rb+"://webapi.amap.com/count?"+["type=glfail","c="+w.Q.uf.Yc.Go,"crd="+w.l.qK,"k="+w.A.key,"u="+w.A.Sm,"m="+(w.l.Y?1:0),"pf="+w.l.Pr,"mode=3d","dpr="+window.devicePixelRatio,"scale="+(w.l.SE||0),"detect="+this.ja].join("&"))},OD:function(){w.l.cU=!1;w.l.rm=!1;this.q&&this.q.g.J&&(this.q.g.set("baseRender", w.l.SU?"dv":"d"),this.q.g.J.fL(),this.q.Q=null,this.q.fa.up(),this.q=null);this.Qa=this.T=null},kr:function(a,b,c,d){function e(a,d){a.length&&(h[w.a.indexOf(b,d)]=a);k-=1;0>=k&&(c(h),k=0)}for(var g=b.length,h=[],k=0,l,m=[],n=0;n<g;n+=1)if(l=b[n],l instanceof w.w.Kc&&l.get("visible")&&!l.oL&&(l=this.nr(l)))m.push(l),k+=1;for(g=0;g<m.length;g+=1)m[g].kr(a,e,d)},kc:function(a){var b=this.g.Sx||this.g.vd;this.aM!==b&&this.g.J.dh&&(this.g.YY(b),this.aM=b);var b=this.Pa,c=this.ja?this.kb:this.qp,d=a.size.width* c,c=a.size.height*c;if(d&&c){var e=this.g.J;e.DirectionLight&&(this.YW=(new w.Ea(e.DirectionLight.direction)).normalize().Ye(e.view.xp).Ye(e.view.iga));this.Qa.width=d;this.Qa.height=c;this.Qa.style.width=a.size.width+"px";this.Qa.style.height=a.size.height+"px";b.viewport(0,0,this.Qa.width,this.Qa.height);b.clear(b.COLOR_BUFFER_BIT);d=a.W;c=a.$a;11>d.zoom&&this.fF.kc(b,a);for(e=0;e<c.length;e+=1){var g=c[e].mn(),h=c[e];if(!g.visible||c[e].oL||g.gd[0]>d.zoom||g.gd[1]<d.zoom)h.Xi&&h.get("container").parentNode=== this.K&&this.K.removeChild(h.get("container"));else{var k=this.nr(c[e]);k&&(h.Xi&&h.get("container").parentNode!==this.K&&this.K.appendChild(h.get("container")),k.kc(b,a,g))}}this.EM.kc(b,a);this.lz.kc(b,a);a=this.g.La.w;b=this.g.La.D;this.g.La.Ao.style.cssText="";a.style.cssText="-webkit-transform: translateZ(0);";b.style.cssText="";this.g.ds=!1}},nr:function(a){if(!a.pm&&a.Kl){var b=a.Kl(this);b&&!b.Xaa&&(a.pm=b)}return a.pm},xU:function(){var a=this.Pa,b=a.createTexture();a.bindTexture(a.TEXTURE_2D, b);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array([0,0,0,255]));var c=a.RGB,d=a.RGB,e=a.UNSIGNED_BYTE,g=new Uint8Array([0,0,0]);a.texImage2D(a.TEXTURE_2D,0,c,1,1,0,d,e,g);return b},j_:function(a){this.ar||(this.ar=[this.xU()]);var b={},c=!1,d;for(d in a)if(a.hasOwnProperty(d)&&a[d].lc)if(this.Oj[d]&&this.Oj[d].url===a[d].lc&&this.Oj[d].lc)b[d]=this.Oj[d];else{c=!0;b[d]={url:a[d].lc};var e=this;this.cX(d,a[d].lc,function(a,c,d,l){b[a].lc=c;b[a].width=d;b[a].height=l; e.set("display")},function(a){delete b[a]})}c||this.set("display");this.Oj=b},vD:function(a){for(var b=2;b!==a&&b<a;)b*=2;return b==a?!0:!1},cX:function(a,b,c,d,e){var g=document.createElement("img");g.crossOrigin="anonymous";g.src=b;var h=this;g.onload=function(){if(16>g.width||16>g.height||!h.vD(g.width)||!h.vD(g.height))d(a);else{var b=h.createTexture(g,e);c(a,b,g.width,g.height)}}},createTexture:function(a,b){var c=this.Pa,d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,a);c.generateMipmap(c.TEXTURE_2D);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,b?c.MIRRORED_REPEAT:c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,b?c.MIRRORED_REPEAT:c.REPEAT);return d}});w.Ma.Wz.ob(w.CU);w.Ma.qc=w.aa.extend({ga:[w.ka,w.te],sW:!0,B:function(a,b){this.q=a;this.T=b;this.g=b.g;this.Ph=a.fa.Ph;this.X("display",a);this.aea||this.createProgram()},Vt:function(){this.Eu&&this.Eu();this.Qn();this.ab=this.g=this.T=this.q=null},fca:"varying highp float w;",gca:"w = gl_Position.w;",dca:"varying highp float w;uniform vec2 fog;uniform vec4 fogColor;uniform float _opacity;",eca:"float depth = gl_FragCoord.z * w;highp float fogFactor = smoothstep( fog.x, fog.y, depth );gl_FragColor.w*=(1.0-fogFactor)*_opacity;", wfa:"uniform float _opacity;",xfa:"gl_FragColor=vec4(gl_FragColor.rgb,gl_FragColor.a*_opacity);",ET:function(a,b,c,d){var e="",g="",h=this.wfa,k=this.xfa;d&&(k=h="");(c||this).yh&&(e=this.fca,g=this.gca,h=this.dca,k=this.eca,a=a.replace("void main",e+"void main"),a=a.substr(0,a.lastIndexOf("}"))+g+"}");b=b.replace("void main",h+"void main");b=b.substr(0,b.lastIndexOf("}"))+k+"}";return[a,b]},createProgram:function(){var a;a="custom"===this.type?this.q.fa.get("type"):this.type;if(!this.T.Ou[a]){var b= this.T.Pa,c=this.nj||this.q.fa.get("vertexShader"),d=this.me||this.q.fa.get("fragmentShader");if(c&&d&&(c=this.ET(c,d),c=w.pk.createProgram(b,c[0],c[1]))){this.T.Ou[a]=c;c.Hz=b.getUniformLocation(c,"u_projectionMatrix");c.Gz=b.getUniformLocation(c,"u_modelViewMatrix");var e,g;this.q&&this.q.fa.getWebGLVariableLoaction?(g=this.q.fa,e=g.getWebGLVariableLoaction):this.Kh&&(g=this,e=this.Kh);this.yh&&(c.dN=b.getUniformLocation(c,"fog"),c.cN=b.getUniformLocation(c,"fogColor"));c.Ez=b.getUniformLocation(c, "_opacity");e&&(b=this.T.Pa,e.call(g,b,c))}}this.ab=this.T.Ou[a]},kc:function(a,b,c){var d=this.ab;if(!d)return!1;a.useProgram(d);b=b.W;this.Aa=b.Aa;d.Hz&&a.uniformMatrix4fv(d.Hz,!1,b.hh.elements);d.Gz&&a.uniformMatrix4fv(d.Gz,!1,b.pd.elements);c=parseFloat((c||{}).opacity);isNaN(c)&&(c=1);a.uniform1f(d.Ez,c);if(0>=c)return!1;1>c&&(a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA));this.yh&&(c=this.g.J.view.Qk*(1+1.1*Math.cos(b.pitch*Math.PI/180)), a.uniform2f(d.dN,0.9*c,1.5*c),c=this.T.lz.mz,a.uniform4f(d.cN,c[0],c[1],c[2],1));return!0},Uca:function(a){var b=-Infinity,c=Infinity,d=-Infinity,e=Infinity;a.forEach(function(a){a[0]>b&&(b=a[0]);a[1]>d&&(d=a[1]);a[0]<c&&(c=a[0]);a[1]<e&&(e=a[1])});return[c,e,b,d]},kr:function(a,b){var c=[],d=this.q;if(this.Aa&&a){var e=[a.x,a.y],g=this.q.g.J.view.Ee(a);if(d.Vk){for(var h=d.Lf,k=!0,l=[],m=0;m<h.length;m+=1){var n=h[m].tg;if(n)if(n.parentNode&&n.parentNode.parentNode&&this.T&&n.parentNode.parentNode!== this.T.wj&&"none"!==n.parentNode.style.display){var p=w.j.ey(n),n=p[0],p=p[1];n&&p?(Math.max(Math.abs(h[m].get("offset").x),Math.abs(h[m].get("offset").y)),Math.max(n,p),d.Ge=Math.max(d.Ge,n),d.df=Math.max(d.df,p),h[m].width=n,h[m].height=p):(k=!1,l.push(h[m]))}else k=!1,l.push(h[m])}k?(d.Vk=!1,d.Lf=[]):d.Lf=l}h=this.Uca(this.Aa.path);if(h=d.Ui(h)){for(var q in h)if(h.hasOwnProperty(q)&&(k=h[q],k.get("visible")&&!k.get("noSelect")))if(l=k.Z,l instanceof w.pa.Tf)if(this.Ph){m=this.q.kk;m instanceof Array&&(m="number"===typeof k.Ra.style&&m[k.Ra.style]?m[k.Ra.style]:m[0]);var s=m.size.width*this.S,r=m.size.height*this.S,u=m.anchor.x*this.S,v=m.anchor.y*this.S,m=w.H.HI([[e[0]-s+u,e[1]-r+v],[e[0]+u,e[1]+v]]);w.H.nd(m,l.Oa)&&c.push(k)}else"undefined"!==typeof l.get("radius")?(m=l.Oa,n=k.get("deltaPos")||[0,0],p={x:m[0],y:m[1]},k.zr?(p.x+=n[0],p.y+=n[1],this.g.J.Ee(p).Ld(g)<l.get("radius")+l.get("strokeWeight")&&c.push(k)):(p=this.g.J.qe(p),l=l.get("radius")/this.g.J.getResolution(p,20),Math.sqrt(Math.pow(m[0]- a.x+n[0],2)+Math.pow(m[1]-a.y+n[1],2))<=l&&c.push(k))):(m=k.get("params"),m.visible&&(l=l.Oa,n=new w.G(l[0],l[1]),n=this.q.g.J.view.Ee(n),s=k.width,r=k.height,u=m.offset.x,v=m.offset.y,p=null,p=function(a,b){var c=Math.round(a.x+u),d=Math.round(a.x+u+s),e=Math.round(a.y+v+r),g=Math.round(a.y+v),h=Math.round(b.x),k=Math.round(b.y);return h<=d&&h>=c&&k<=e&&k>=g?!0:!1},p=m.shape?this.xy(k,g,n):p(n,g),l[0]instanceof Array||(l=[l]),p&&c.push(k)));else l.nd?(n=k.get("deltaPos")||[0,0],l.nd([a.x-n[0],a.y- n[1]])&&c.push(k)):l.Xt&&(n=k.get("deltaPos")||[0,0],1.8*l.Xt([a.x-n[0],a.y-n[1]])<=k.get("strokeWeight")*this.S&&c.push(k));this.Ph?c.sort(function(a,b){return a.Tj>b.Tj?-1:1}):c.sort(function(a,b){return a.get("isTop")?-1:b.get("isTop")?1:a.get("zIndex")>b.get("zIndex")||a.get("zIndex")===b.get("zIndex")&&a.Tj>b.Tj?-1:1});b(c,d)}else b([],d)}else b(c,d)},xy:function(a,b,c){var d=a.get("params").shape,e=a.tg.children[0].clientWidth;a=a.tg.children[0].clientHeight;if("circle"===d.F.type){if(e=c.x- e/2+d.F.coords[0],c=c.y-a+d.F.coords[1],Math.sqrt((b.x-e)*(b.x-e)+(b.y-c)*(b.y-c))<=d.F.coords[2])return!0}else{if("poly"===d.F.type)return b=[b.x,b.y],d=d.F.coords,d=this.rC(d),w.Qc.nd(b,d);if("rect"===d.F.type){d=d.F.coords;c=d[0];e=d[1];a=d[3];var g=b.x;b=b.y;if(g<d[2]&&g>c&&b>a&&b<e)return!0}}return!1},rC:function(a){for(var b=[],c=0;c/2<a.length/2;c+=2)b.push([a[c],a[c+1]]);return b}});w.Ma.oj=w.Ma.qc.extend({B:function(a,b){arguments.callee.oa.apply(this,arguments);a.yb=a.get("container")},kc:function(a,b,c){if(this.q){var d=b.W.gb;if(!this.ra||this.q.fa.vs||!this.ra.qb(d)||this.re!==b.W.zoom||this.Pga!==b.W.rotation||this.Oga!==b.W.pitch||this.g.ds){var e=this.q.KV();e&&e.call(this.q.fa,b,a);this.q.ta||(this.q.ta=!0,w.a.pc(function(){this.q&&(this.q.cd?this.q.ia("renderComplete"):(this.q.cd=!0,this.q.ia("complete")))},this));this.ra=d;this.re=b.W.zoom;this.Pga=b.W.rotation;this.Oga= b.W.pitch;c.K.style.zIndex=c.zIndex;c.K.style.top="";c.K.style.left="";c.K.style.height="";c.K.style.display=c.visible?"":"none";w.j.Kn(c.K,c.opacity);this.g.La.w.appendChild(c.K)}}}});w.Ma.Ds=w.Ma.qc.extend({ga:[w.ka,w.te],B:function(a,b){this.type="custom";arguments.callee.oa.apply(this,arguments)},kc:function(a,b){arguments.callee.oa.apply(this,arguments);if(this.q.fa.onRender)this.q.fa.onRender(a,this.ab);this.q.fa.renderAgain&&(this.set("display"),this.q.fa.renderAgain=!1);this.q.ta||(this.q.ta=!0,w.a.pc(function(){this.q&&(this.q.cd?this.q.ia("renderComplete"):(this.q.cd=!0,this.q.ia("complete")))},this))}});w.Ma.Hv=w.Ma.qc.extend({B:function(a,b){arguments.callee.oa.apply(this,arguments);this.X("reload",a,!0);var c=this.SM||w.l.size;if(this.g&&this.g.J){var d=this.g.J.get("tileCacheSize");d&&0<d&&(c=d)}this.wa=new w.hf(c);"AMap.Buildings"===a.fa.CLASS_NAME&&this.X("customStyle",a.fa);this.Gi=!1;var e=this;this.wa.uL.DT(function(a){e.hw(a)});this.hc=1;this.Cm=50;this.JO=!0;this.q.wa=this.wa;this.Yj=new w.Rz(6,null,a.EJ);this.De=a.De;this.hm=a.hm},Eu:function(){this.clear();this.wa.clear()},reloadChanged:function(){this.q&& (this.q.ta=!1);this.wa.clear();this.reload=!0;this.set("display")},iu:function(a,b){var c=a+"";return(b?this.wa.VD(c):this.wa.get(c))||new w.Xa(a.vb())},wE:function(a,b){return this.ee*Math.pow(2,a-b)},hw:function(a){a.dp&&this.Yj.dU(a.dp);a.jE=!1;a.loaded=!1;this.DC&&this.DC(a)},Nt:function(a){for(var b=this.Ta,c=this.wE(20,b),d=0,e=0,g=Infinity,h=Infinity,k=[],l=0;l<a.length;l+=1){var m=a[l],n=m[0]/c,m=m[1]/c;k.push([n,m]);d=Math.max(d,n);e=Math.max(e,m);g=Math.min(g,n);h=Math.min(h,m)}k.push(k[0]); d=Math.floor(d);e=Math.min(Math.pow(2,b)-1,Math.floor(e));g=Math.floor(g);h=Math.max(0,Math.floor(h));a=[];for(l=g;l<=d;l+=1)for(c=h;c<=e;c+=1)(n=w.Qc.dY(k,[[l,c],[l+1,c],[l+1,c+1],[l,c+1],[l,c]]))&&n.length&&a.push({x:l,y:c,z:b});a.gD=Math.ceil(d-g)/2;return a},wr:function(a,b,c){return b<a.pe||b>a.Sd||c<a.zd||c>a.yd?!1:!0},es:function(a,b){if(a.length){var c=this.gb.wc(this.ee<<20-a[0].ma.z),d=Math.floor(c.x),e=Math.floor(c.y);a.sort(function(a,c){var k=a.ma,l=c.ma,m=k.x-d,k=k.y-e,n=l.x-d,l=l.y- e;return(b?-1:1)*(n*n+l*l-(m*m+k*k))})}},clear:function(){this.Yj.clear()},mm:function(a,b){this.rg=!1;b.Tl!==this.Tl&&(this.Tl=b.Tl,this.wa.clear());this.clear();this.ai=b.ai;this.$h=b.$h;this.ee=b.ee;var c=a.W;this.ef=b.ef||a.W.ef;this.zh=c.zh;this.size=a.size;this.rotation=c.rotation;this.gb=c.gb;this.Aa=a.W.Aa;this.zoom&&(this.Gu=c.zoom>this.zoom?"in":c.zoom<this.zoom?"out":!1);this.Se=a.Se;this.If=a.If;this.zoom=c.zoom;this.ce=c.ce;this.Ta=!1===this.ji&&!this.q.kW&&this.q.ja?this.ce+1:this.ce; this.De&&this.Ta>this.De&&(this.Ta=this.De);this.hm&&this.Ta<this.hm&&(this.Ta=this.hm);this.S=c.S;this.bf=c.bf;c=a.W.Aa;this.Mf=this.Nt(c.path);this.tm=c.YE?this.Nt(c.YE):null;var c=this.Mf,d=this.Aa.FZ,e=null,e=d<this.zoom&&this.tm?this.tm:c,g=[],h=[],k,l=[],m=[],n=[],p=new w.uk(0,0,0),q,s=this.zoom,m=this.Fm||[],r={},u={},v,x,t,y,B,z;this.Pc=1E6*Math.random()<<0;for(q=m.length-1;0<=q;q-=1)if(k=m[q],!(k.Rs<b.opacity))if(p.z=k.ma.z,p.x=k.ma.x,p.y=k.ma.y,p.z===this.Ta)r[p+""]|=16;else if(p.z<this.Ta){if(r[p+ ""]|=64,this.ai)for(y=this.Ta-p.z,v=Math.max(c.pe,p.x<<y),s=Math.min(c.Sd,(p.x+1<<y)-1),x=Math.max(c.zd,p.y<<y),t=Math.min(c.yd,(p.y+1<<y)-1),p.z=this.Ta,y=v;y<=s;y+=1)for(p.x=y,B=x;B<=t;B+=1)p.y=B,z=p+"",r[z]|=32,u[z]=u[z]?Math.max(k.ma.z,u[z]):k.ma.z}else if(this.$h)for(k=1;p.z>=this.Ta;){r[p+""]|=k;v=p.x>>1;x=p.y>>1;s=v<<1;t=x<<1;k=0;for(y=2;0<y;y-=1)for(p.x=s+y,B=2;0<B;B-=1)p.y=t+B,r[p+""]&5&&(k+=1);p.z-=1;p.x=v;p.y=x;k=4===k?4:2}m=[];p.z=this.Ta;q=!0;this.wa.kU();for(s=0;s<e.length;s+=1)p.x= e[s].x,p.y=e[s].y,this.wa.dX(""+p),k=this.iu(p),v=!1,k.qa?(k.Pc=this.Pc,this.wr(c,y,B)&&(m.push(k),this.tj&&(k.hc!==this.hc||1>k.Rs)&&(v=!0))):(q=!1,this.wr(c,y,B)&&(v=!0),k.status||"3D"!=this.T.type&&this.ce!==d||this.tm&&!this.wr(this.tm,y,B)||l.push(k)),v&&n.push(k);q?this.$x||(this.$x=!0,this.q.ta||(B={key:"rb",index:1,id:this.g.J.id},this.q.eh&&(B.key="rl"),this.q.fa.oi||(w.Yd.ue.end(B),w.Yd.ue.push({key:"ftc",Un:m.length,id:this.g.J.id})))):this.q.ta=!1;this.rg=q;m.length&&this.$x&&(g.push(m), m.rg=q);h.push(l);l=!1;if(this.$h){n=n.slice(0);e=[];for(q=n.length-1;0<=q;q-=1)k=n[q],r[k.key]&4||e.push(k);t=b.gd[1];for(s=this.Ta+1;n.length&&s<=t;s+=1){m=[];d=n;n=[];p.z=s;for(q=d.length-1;0<=q;q-=1)if(B=d[q],k=r[B.key],k&7)for(v=B.ma.x<<1,x=B.ma.y<<1,y=1;0<=y;y-=1)for(p.x=v+y,B=1;0<=B;B-=1)p.y=x+B,z=p+"",k=this.wa.VD(z),r[z]&5&&k&&k.qa?(k.Mw=!0,k.Pc=this.Pc,m.push(k)):n.push(new w.Xa(p.vb(),""));m.length&&(l=!0,g.push(m))}n=e}if(!l&&this.ai)for(B=!g.length||this.bg?b.gd[0]:Math.max(b.gd[0],this.Ta- 2),y=Math.max(B,this.Ta-this.B5),s=this.Ta-1;n.length&&s>=B;s-=1){x=s>=y;l=[];m=[];e={};d=n;n=[];for(q=d.length-1;0<=q;q-=1)k=d[q],p.z=s,p.x=k.ma.x>>1,p.y=k.ma.y>>1,k=this.iu(p,!x),e[k.key]||(e[k.key]=1,v=!1,k.qa&&(!this.F7||r[k.key]&64)?(p.x=Math.min(c.Sd,Math.max(c.pe,p.x<<this.Ta-s)),p.y=Math.min(c.yd,Math.max(c.zd,p.y<<this.Ta-s)),p.z=this.Ta,z=p+"","number"===typeof u[z]&&k.ma.z>u[z]?v=!0:k.Mw=!0,k.Pc=this.Pc,m.push(k)):v=!0,v&&n.push(k));m.length&&g.push(m);x&&l.length&&h.push(l)}this.Er=this.wn= 0;this.WL(a,b);a.Se||this.al(h);this.lj=g;this.q&&this.q.set("tiles",g)},cJ:function(a){var b=a.Pl,b=void 0===b?{}:b,c=a.xs,c=void 0===c?0:c;a=a.Bp;a=void 0===a?0:a;var d=Math.pow(2,c),e=this.Mf,g=e[e.length-1],c=this.Gi&&(!c||!a);return{pe:Math.floor(e[0].x*d)-(!c||b.left?a:0),Sd:Math.ceil(g.x*d)+(!c||b.right?a:0),zd:Math.floor(e[0].y*d)-(!c||b.pv?a:0),yd:Math.ceil(g.y*d)+(!c||b.HC?a:0)}},hy:function(a){var b=this,c=a.Bp,d=void 0===c?0:c,c=a.xs,e=void 0===c?0:c,c=a.mode,g=void 0===c?0:c,h=[],k=this.cJ({Pl:a.Pl, xs:e,Bp:d});a=function(){var a=void 0;switch(g){case 0:a=function(a,c){if(0<=a&&0<=c&&(a<k.pe+d||c<k.zd+d||a>k.Sd-k||c>k.yd-k)){var g=new w.uk(b.Ta+e,a,c);b.wa.Fc(g.toString())||h.push(new w.Xa(g,!0))}};break;default:a=function(a,c){var d=new w.uk(b.Ta+e,a,c);b.wa.Fc(d.toString())||h.push(new w.Xa(d,!0))}}return a}();for(c=k.pe;c<=k.Sd;c++)for(var l=k.zd;l<=k.yd;l++)a(c,l);return h},RF:function(){var a=this.g.J;return!!(a.fY&&a.get("preloadMode")&&0===a.get("pitch")&&200<=this.wa.Al&&this.q.fa.Ar())}, WL:function(a,b){var c=a.Pl,d=a.Mc,e=a.W,g=b.gd;if(this.RF()){if(d||!this.Gi)c=this.hy({Pl:c,Bp:this.Gi?2:1}),c.length&&this.al([c],!0);this.Ta>=g[0]+2&&("out"===this.Gu||!this.Gi)&&(e=this.hy({xs:this.Gi?-2:-1,Bp:this.Ta===e.zoom?1:0,mode:1}),e.length&&this.al([e],!0));this.Gi=!0}}});w.Ma.gka=w.Ma.Hv.extend({type:"GridNet",nj:"precision highp float;attribute vec2 a_Position;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;void main(void) {\\tvec4 pos = vec4(a_Position.x,a_Position.y, 0.0, 1.0);\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;}",me:"precision mediump float;void main(void) {\\tgl_FragColor =  vec4(0.0,0.7,1.0,1.0);}",Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position")},B:function(a){this.T=a;this.g=a.g;this.createProgram();a=w.l.size; if(this.g&&this.g.J){var b=this.g.J.get("tileCacheSize");b&&0<b&&(a=b)}this.wa=new w.hf(a);this.ee=256;this.q=new w.w.qc(new $.w.qc,this.g)},clear:function(){},fJ:function(a){var b=this.T.Pa,c=a.ma,d=256*Math.pow(2,20-c.z),e=c.x*d-w.a.fc.x,c=c.y*d-w.a.fc.y,d=[e,c,e+d,c,e+d,c+d,e,c+d],e=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e);b.bufferData(b.ARRAY_BUFFER,new Float32Array(d),b.STATIC_DRAW);a.wi=e},aj:function(a){a.qa=!0;a.status="loaded";this.fJ(a);a.loaded=!0;this.wa.set(a.key,a);a.qa=!0;a.dp= null},al:function(a){for(var b=a.length-1;0<=b;b-=1){var c=a[b];if(c.length)for(var d=c.length-1;0<=d;d-=1)this.aj(c[d])}},ld:function(){},kc:function(a,b){var c=this.ab;arguments.callee.oa.apply(this,arguments);a.enableVertexAttribArray(c.ud);this.rk=b.rk;this.If=b.If;this.mm(b,{ee:256});for(var d=this.lj,e=d.length-1;0<=e;e-=1){var g=d[e];if(g.length)for(var h=g.length-1;0<=h;h-=1)a.bindBuffer(a.ARRAY_BUFFER,g[h].wi),a.vertexAttribPointer(c.ud,2,a.FLOAT,!1,0,0),a.drawArrays(a.LINE_LOOP,0,4)}this.ld()}});w.Ma.zi=w.Ma.Hv.extend({type:"tile",nj:"precision highp float;attribute vec4 a_Position;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;varying vec2 vTextureCoord;void main(void) {\\tvTextureCoord = a_Position.zw;\\tvec4 pos = vec4(a_Position.x,a_Position.y, 0.0, 1.0);\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;}",me:"precision mediump float;uniform sampler2D texture;varying vec2 vTextureCoord;void main(void) {\\tvec4 smpColor = texture2D(texture, vTextureCoord);\\tgl_FragColor =  smpColor;}", Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position");b.Ap=a.getUniformLocation(b,"texture")},B:function(a,b){this.yh=!0;arguments.callee.oa.apply(this,arguments);this.Cm=120;this.ji=!1;this.De=a.De},fJ:function(a){var b=this.T.Pa,c=a.ma,d=Math.pow(2,20-c.z)*this.ee,e=c.x*d-w.a.fc.x,c=c.y*d-w.a.fc.y,d=[e,c,0,0,e+d,c,1,0,e+d,c+d,1,1,e,c,0,0,e+d,c+d,1,1,e,c+d,0,1],e=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e);b.bufferData(b.ARRAY_BUFFER,new Float32Array(d),b.STATIC_DRAW);a.wi=e;d=b.createTexture(); b.bindTexture(b.TEXTURE_2D,d);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.tc);b.generateMipmap(b.TEXTURE_2D);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.MIRRORED_REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.MIRRORED_REPEAT);a.CE=d},DC:function(a){a.CE&&this.T.Pa.deleteTexture(a.CE);a.wi&&this.T.Pa.deleteBuffer(a.wi)},aj:function(a,b,c){function d(b){a.loaded= !0;if(e.q){a.status="loaded";var d=a.qa=!0;"IMG"===b.tagName&&b&&0!==b.src.indexOf(window.location.origin)&&"anonymous"!==b.crossOrigin&&(console.warn&&console.warn("JSAPI warning - Image at "+b.src+\' should be load with property crossOrigin="anonymous" under viewMode 3D!\'),d=!1);d&&(a.tc=b,e.fJ(a),e.set("display",0));"function"===typeof c&&c()}}var e=this;a.status="loading";e.wa.set(a.key,a);this.q.Qt&&this.q.Qt.call(this,a,d,function(){a.loaded=!0;e.q&&(a.status="loaded",a.qa=!0,e.set("display", 0),"function"===typeof c&&c())})},al:function(a){for(var b=a.length-1;0<=b;b-=1){var c=a[b];if(c.length){var d=this,e=function(){var a=c.length;return function(){if(0===--a){var b={key:"rb",index:0,id:d.T.g.J.id};d.q.fa.oi||(w.Yd.ue.end(b),w.Yd.ue.end(w.extend(b,{index:1})))}}}();this.es(c);this.wn+=c.length;for(var g=c.length-1;0<=g;g-=1)this.aj(c[g],this.Yj,e)}}},ld:function(){if(this.rg&&!this.q.ta){var a=this.q;this.q.fa.oi||w.Yd.ue.end({id:this.T.g.J.id,key:"rb",index:2});a.ta=!0;a.cd?a.ia("renderComplete"): (a.cd=!0,a.ia("complete"))}},kc:function(a,b,c){var d=this.ab;this.ee=c.ee;arguments.callee.oa.apply(this,arguments);a.enableVertexAttribArray(d.ud);a.activeTexture(a.TEXTURE0);this.mm(b,c);if(this.yh||"overlayer"===this.q.get("type"))a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);for(var e=this.lj,g=[],h=e.length-1;0<=h;h-=1){var k=e[h];if(k.length)for(var l=k.length-1;0<=l;l-=1){var m=k[l];m.CE&&(g.push(m),a.bindTexture(a.TEXTURE_2D,m.CE),a.uniform1i(d.Ap, 0),a.bindBuffer(a.ARRAY_BUFFER,m.wi),a.vertexAttribPointer(d.ud,4,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6))}}a.disable(a.BLEND);a.disableVertexAttribArray(d.ud);this.ld();this.Fm=g}});w.Ma.Yc=w.Ma.Hv.extend({ga:[w.Ls],type:"wbase",nj:"precision highp float;attribute vec4 a_Position;attribute vec2 a_uvs;varying vec2 vTextureCoord;attribute vec3 a_op,a_Next,a_Previous;uniform float u_xDelta,u_width;uniform lowp int u_type;uniform mat4 u_modelViewMatrix,u_projectionMatrix;uniform float u_scale;uniform float u_heightPercent;varying float v_distance;varying vec4 v_color;uniform vec3 u_ambient;uniform vec3 u_light;uniform vec3 u_lightDirection;uniform mat3 u_normalMatrix;uniform vec4 u_FragColor,u_FragColor2; uniform lowp int useTexture;varying vec2 v_op;varying float v_TB;varying highp float v_cap;void main() {vec4 position=a_Position;position.x+=u_xDelta;if (u_type==0) {\\tgl_Position=u_projectionMatrix*u_modelViewMatrix*position;\\tvTextureCoord = a_uvs;}else if(u_type>1) {\\tv_op=a_op.xy;\\tv_TB=a_op.z;\\tvec3 curPos=position.xyz;\\tv_distance=a_Next.z;\\tfloat ddis=0.0;\\tvec3 previous=vec3(a_Previous.x+u_xDelta,a_Previous.y,0);\\tvec3 next=vec3(a_Next.x+u_xDelta,a_Next.y,0);\\tvec4 up,dir;\\tv_distance *= u_scale;\\tif(previous==curPos){ \\t\\tdir= vec4(normalize(next-curPos).xy,0,0);\\t}else if(next==curPos){\\t\\tdir= -vec4(normalize(previous-curPos).xy,0,0);\\t}else {\\t\\tvec3 dir0=previous-curPos;\\t\\tvec3 dir1=next-curPos;\\t\\tvec3 dir2=normalize(dir0);\\t\\tvec3 dir3=normalize(dir1);\\t\\tfloat f0=dir0.x*dir1.y-dir1.x*dir0.y;\\t\\tdir = vec4(0); \\t\\tv_cap=1.0;\\t\\tif(f0==0.0){\\t\\t\\tup = vec4(dir3.y,-dir3.x,0,0); \\t\\t}else{\\t\\t\\tvec3 dir4=normalize(dir2+dir3);\\t\\t\\tfloat sinA=length(cross(dir4,dir2));\\t\\t\\tfloat cosA=dot(dir4,dir2);\\t\\t\\tif(sinA<0.5){\\t\\t\\t\\tsinA=0.5;\\t\\t\\t}\\t\\t\\tup= vec4(dir4,0)/sinA;\\t\\t\\tddis=abs(length(up)*cosA*u_width*0.5);\\t\\t\\tif(f0<0.0){\\t\\t\\t\\tup=-up;\\t\\t\\t\\tddis=-ddis;\\t\\t\\t}\\t\\t\\tv_distance += v_TB*a_Previous.z*ddis;\\t\\t}\\t}\\tif(previous==curPos||next==curPos){ \\t\\tup = vec4(dir.y,-dir.x,0,0); \\t\\tif(u_type==4){\\t\\t\\tv_cap=sqrt(v_TB*v_TB+a_Previous.z*a_Previous.z);\\t\\t}else if(u_type==3){\\t\\t\\tv_cap=1.0;\\t\\t}else{dir = vec4(0);}\\t}\\tposition=position+(up*v_TB-dir*a_Previous.z)*u_width*0.5/u_scale;\\tgl_Position=u_projectionMatrix*u_modelViewMatrix*position;}else if (u_type==1) {\\tfloat xielv = position.w;\\tvec4 c;\\tvec3 n;\\tbool BLC = true;\\tif (xielv <= 0.0) { \\t\\tc = xielv == 0.0 ? u_FragColor2 : u_FragColor;\\t\\tn = vec3(0, 0, -1);\\t\\tif (position.z == 0.0) {\\t\\t\\tBLC = false;\\t\\t}\\t} else {\\t\\tc = (u_FragColor2 + (u_FragColor - u_FragColor2) * (position.z == 0.0 ? 0.9 : 0.4));\\t\\tfloat dx = 5000.0 - float(xielv);\\t\\tfloat dy = 5000.0 - fract(xielv) * 10000.0;\\t\\tn = vec3(dy, -dx, 0);\\t}\\tif (BLC) {\\t\\tvec3 normal = normalize(u_normalMatrix * n);\\t\\tfloat nDotL = dot(u_lightDirection, -normal);\\t\\tvec3 diffuse = u_light * nDotL;\\t\\tvec3 ll = (u_ambient + diffuse);\\t\\tv_color = vec4(ll * c.rgb, c.a);\\t} else v_color = c;\\tposition=vec4(position.xy,position.z*u_heightPercent,1.0);\\tgl_Position=u_projectionMatrix*u_modelViewMatrix*position;\\tvTextureCoord = a_uvs;}}", me:"#define BASE 1\\nprecision highp float;uniform vec4 u_FragColor;uniform sampler2D texture;uniform vec2 textureScale;varying vec2 vTextureCoord;varying lowp float v_distance,v_TB;varying vec4 v_color;varying vec2 v_op;varying highp float v_cap;uniform lowp int u_type;uniform int u_isDash,u_onlyBorder;uniform vec4 u_dash;uniform float pitch;uniform lowp int useTexture;void main() {vec4 color;if (u_type==0) {\\tcolor = u_FragColor;\\tif (useTexture==1) {\\t\\tvec4 smpColor = texture2D(texture, vec2(vTextureCoord.x/textureScale.x,vTextureCoord.y/textureScale.y));\\t\\tcolor= vec4(smpColor.rgb*smpColor.a+color.rgb*(1.0-smpColor.a),color.a);\\t}}else if(u_type>1) {\\tif(v_op.x<-0.2||v_op.x>256.2||v_op.y<-0.2||v_op.y>256.2){discard;}\\tif(v_cap>1.0001){discard;}\\tif(u_isDash==1){\\t\\tfloat all = u_dash[0] + u_dash[1] + u_dash[2] + u_dash[3];\\t\\tfloat off = mod(v_distance*sqrt(pitch) - u_dash[0], all);\\t\\tif(off> u_dash[0]&&off<=(u_dash[0]+u_dash[1])||off>(all-u_dash[3])){discard;}}\\tif(u_onlyBorder==1&&v_TB<=0.7&&v_TB>=-0.7){discard;}\\tcolor = u_FragColor;}else if(u_type==1) {\\tcolor = v_color;\\tif(useTexture==1&&vTextureCoord.x>-0.0) {\\t\\tvec4 smpColor = texture2D(texture, vec2(vTextureCoord.x*textureScale.x,vTextureCoord.y*textureScale.y));"+ (w.l.Y?"color= vec4(smpColor.rgb,color.a);":"color= vec4(smpColor.rgb*smpColor.a+color.rgb*(1.0-smpColor.a),color.a);")+"\\t}}gl_FragColor=color;}",Kh:function(a,b){b.mN=a.getUniformLocation(b,"u_xDelta");b.d_=a.getUniformLocation(b,"u_othMatrix");b.g_=a.getUniformLocation(b,"u_zoomMatrix");b.c_=a.getUniformLocation(b,"u_modelMatrix");b.mf=a.getAttribLocation(b,"a_Position");b.Ug=a.getAttribLocation(b,"a_uvs");b.Lj=a.getAttribLocation(b,"a_op");b.Kj=a.getAttribLocation(b,"a_Previous");b.xh=a.getAttribLocation(b, "a_Next");b.Yia=a.getUniformLocation(b,"u_normalMatrix");b.Xia=a.getUniformLocation(b,"u_lightDirection");b.Wia=a.getUniformLocation(b,"u_light");b.Nia=a.getUniformLocation(b,"u_ambient");b.Sh=a.getUniformLocation(b,"u_FragColor");b.mv=a.getUniformLocation(b,"u_FragColor2");b.IE=a.getUniformLocation(b,"texture");b.nv=a.getUniformLocation(b,"textureScale");b.ui=a.getUniformLocation(b,"u_type");b.os=a.getUniformLocation(b,"u_width");b.eN=a.getUniformLocation(b,"u_isDash");b.fN=a.getUniformLocation(b, "u_onlyBorder");b.bN=a.getUniformLocation(b,"u_dash");b.jN=a.getUniformLocation(b,"u_scale");b.ov=a.getUniformLocation(b,"useTexture");b.iN=a.getUniformLocation(b,"pitch");b.b_=a.getUniformLocation(b,"u_heightPercent");this.Hu=this.St=this.tn=void 0;this.qk=0},B:function(a,b){this.SM=500;this.yh=!0;this.Il=[];arguments.callee.oa.apply(this,arguments);this.Ni=20;this.kb=Math.min(2,window.devicePixelRatio||1);this.qp=1;this.X("mapStyle",a.g);this.X("style",a.g);this.bg=this.ji=!0;a.g.J.vn&&this.Ax(a, b);this.Cm=0;this.Jj={}},al:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;if(!this.T.g.Iz)for(var c=a.length-1;0<=c;c-=1){var d=a[c];if(d.length){if(this.q.nx){for(var e=[],g=d.length-1;0<=g;g-=1){var h=d[g],k=h.ma;this.q.g.eo.sz(k.x,k.y,k.z)?e.push(d[g]):(this.wa.set(h.key,h),h.loaded=!0,h.status="loaded",h.qa=!0,h.Ga={})}d=e;a[c]=e;if(0==e.length)continue}e=d[0].ma.z;this.es(d,1);for(h=g=0;g<d.length;)this.cL(d.slice(200*h,200*h+200),e,b),g+=200,h+=1}}},customStyleChanged:function(a){this.saa(); !(a=this.get("customStyle"))||a instanceof Array||(a.areas.oda=a.hideWithoutStyle,a=a.areas);if(!a||!a.length&&this.Il.length)this.Il=[],this.g.set("display");else{for(var b=0;b<a.length;b+=1){var c=a[b];c.Nb=[];c.visible=void 0==c.visible?!0:c.visible;c.dE=c.rejectTexture||!1;c.qU=w.a.Li(c.color1);c.color2&&(c.Gaa=w.a.Li(c.color2));if(c.path){c.OL=[];for(var d=[],e=[],g=0;g<c.path.length;g+=1){var h=this.g.Fb(c.path[g]),k=h.Ua(w.a.fc);d.push(Math.floor(h.x/2048));e.push(Math.floor(h.y/2048));c.OL[g]= [k.x,k.y]}k=Math.max.apply(d,d);h=Math.min.apply(d,d);d=Math.max.apply(e,e);for(e=Math.min.apply(e,e);h<=k;h+=1)for(g=e;g<=d;g+=1){var l=2048*h-w.a.fc.x,m=2048*g-w.a.fc.y;w.Yp.doesPolygonPolygonIntersect(c.OL,[[l,m],[l,m+2048],[l+2048,m+2048],[l+2048,m]])&&c.Nb.push("17/"+h+"/"+g)}}else h=this.g.Fb(c.position),k=h.Ua(w.a.fc),g=h.x/2048,h=h.y/2048,d=Math.floor(g),e=Math.floor(h),c.Cga=c.radius/this.g.J.getResolution(c.position,20),g%=1,h%=1,c.Nb.push("17/"+d+"/"+e),0.5<g?(c.Nb.push("17/"+(d+1)+"/"+ e),0.5<h?(c.Nb.push("17/"+(d+1)+"/"+(e+1)),c.Nb.push("17/"+d+"/"+(e+1))):(c.Nb.push("17/"+(d+1)+"/"+(e-1)),c.Nb.push("17/"+d+"/"+(e-1)))):(c.Nb.push("17/"+(d-1)+"/"+e),0.5<h?(c.Nb.push("17/"+(d-1)+"/"+(e+1)),c.Nb.push("17/"+d+"/"+(e+1))):(c.Nb.push("17/"+(d-1)+"/"+(e-1)),c.Nb.push("17/"+d+"/"+(e-1)))),c.oga=[k.x,k.y]}this.Il=a;this.i_()}},saa:function(){if(this.Il)for(var a=0;a<this.Il.length;a+=1)for(var b=this.Il[a].Nb,c=0;c<b.length;c+=1){var d=this.wa.get(b[c]);if(d&&d.Ga)for(var d=d.Ga.building, e=0,g=d.length;e<g;e+=1){var h=d[e];h[3][3]=null;h[3][4]=null;h.visible=void 0;h.dE=void 0}}},i_:function(a){if(this.Il){for(var b=0;b<this.Il.length;b+=1)for(var c=this.Il[b],d=c.Nb,e=0;e<d.length;e+=1){var g;if(a){if(d[e]!==a.key)continue;g=a}else g=this.wa.get(d[e]);if(g&&g.Ga){g=g.Ga.building;for(var h=0,k=g.length;h<k;h+=1){var l=g[h],m=c.OL;if(l[7]){var n=!1;m?w.Yp.isRingInRing(l[7],m)&&(n=!0):w.Yp.distanceToPolygon(c.oga,l[7])<c.Cga&&(n=!0);n&&(l.visible=c.visible,l.dE=c.dE,l[3][3]=c.qU,l[3][4]= c.Gaa||c.qU)}}}}this.g.set("display")}},reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.Qa&&this.Qa.parentNode&&this.Qa.parentNode.removeChild(this.Qa);this.set("display")},Fu:function(a){if(this.q&&a.XK===this.q.Ac)for(var b=0,c=a.Uc.length;b<c;b+=1)this.Qy(a.Uc[b],a.uu,a.Vu,a.Y)},cM:function(a){for(var b=this.T.Pa,c=a.buffer,d=0,e=a.length;d<e;d+=1){var g=a[d];this.g.jk&&g[3]&&!this.g.ec&&(g[2]=this.T.Ro(g[2],g[3]),c.gs[d][0]=g[2])}c.Lp=this.wf(b.ARRAY_BUFFER,c.Lp);c.Ia=this.wf(b.ARRAY_BUFFER, c.Ia);c.Nh=this.wf(b.ELEMENT_ARRAY_BUFFER,c.Nh)},mM:function(a){for(var b=this.T.Pa,c=0,d=a.length;c<d;c+=1){var e=a[c];e.Kf=e[1].length;e[0]=this.wf(b.ARRAY_BUFFER,e[0]);e[1]=this.wf(b.ELEMENT_ARRAY_BUFFER,e[1]);this.g.jk&&e[2][10]&&!this.g.ec&&(e[2][1]=this.T.Uj(e[2][1],e[2][10],1),e[2][4]=this.T.Uj(e[2][4],e[2][10],0))}},DC:function(a){if(a.Ga){if(a.Ga.region&&a.Ga.region.length){for(var b=a.Ga.region.buffer,c=0,d=a.Ga.region.length;c<d;c+=1){var e=a.Ga.region[c];e[2]=null}this.T.Pa.deleteBuffer(b.Lp); this.T.Pa.deleteBuffer(b.Ia);this.T.Pa.deleteBuffer(b.Nh);for(var g in b)b.hasOwnProperty(g)&&(b[g]=null)}delete a.Ga.region;if(a.Ga.road)for(c in a.Ga.road)if(a.Ga.road.hasOwnProperty(c)){if("buffer"!==c)for(var b=a.Ga.road[c],h=0,d=b.length;h<d;h+=1)e=b[h],e[2]=null,e[3]=null}else for(d=a.Ga.road.buffer,e=0,b=d.Ia.length;e<b;e++)for(g in this.T.Pa.deleteBuffer(d.Ia[e]),this.T.Pa.deleteBuffer(d.Nh[e]),d)d.hasOwnProperty(g)&&(d[g]=null);delete a.Ga.road;if(a.Ga.building)for(c=0,d=a.Ga.building.length;c< d;c+=1)e=a.Ga.building[c],this.T.Pa.deleteBuffer(e[0]),e[0]=null,e[1]&&this.T.Pa.deleteBuffer(e[1]),e[1]=null,this.T.Pa.deleteBuffer(e[2]),e[2]=null,e[3]=null,e[4]=null,e[5]=null;delete a.Ga.building}},OI:function(a){for(var b=this.T.Pa,c=0,d=a.length;c<d;c+=1){var e=a[c];e[4]&&(e[7]=e[4]);this.g.ec&&(e[4]=e[0],e[6]=new w.Cv,ed(e[6],e[0],4));e.Ny=e[0].length/4;e[0]=this.wf(b.ARRAY_BUFFER,e[0]);e[1].length?(e.GD=e[1].length/2,e[1]=this.wf(b.ARRAY_BUFFER,e[1])):e[1]=null;e.Oy=e[2].length/4;e[2]=this.wf(b.ARRAY_BUFFER, e[2]);if(this.g.jk&&e[3][2]&&!this.g.ec){var g=this.T.gr(e[3][0],e[3][1],e[3][2]);e[3][0]=g[0];e[3][1]=g[1]}e.ii=0}},wf:function(a,b){if(b.length){var c=this.T.Pa,d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,b,c.STATIC_DRAW);return d}},jV:function(a){var b=a.ma,c=b.x,d=b.y,e=b.z,g=Math.pow(2,e),h=(c+g)%g,k=h+g,l=h-g,m=null;h!==c&&(m=this.qr(e,h,d));m||l===c||(m=this.qr(e,l,d));m||k===c||(m=this.qr(e,k,d));return m?(a.status=m.status,a.qa=m.qa,a.hc=m.hc,a.Pc=m.Pc,a.Ga={building:m.Ga.building, region:m.Ga.region,road:m.Ga.road,en:(b.x-m.ma.x)/g+m.Ga.en},!0):!1},qr:function(a,b,c){if((a=this.wa.get(a+"/"+b+"/"+c))&&a.Ga)return a},Qy:function(a){var b=a.Wc,c=this.wa.get(a.ll);if(c){c.Ga||(c.Ga={en:0});c.Ga[b]=a.Ba;if("region"===b)this.cM(a.Ba);else if("road"===b)for(var d in a.Ba)a.Ba.hasOwnProperty(d)&&this.mM(a.Ba[d]);else"building"===b&&(this.OI(a.Ba),a.Xk&&a.Xk.length&&!c.Te&&(c.Te={},c.Te.je=a.Xk,w.pj&&w.pj.r("vecTileParsed.buildings",{Ln:c})),this.i_(c));b===this.q.xa[this.q.xa.length- 1]&&(c.qa=!0,this.set("display"))}},ld:function(){if(this.rg&&!this.q.ta){var a=this.q;w.Yd.ue.end({key:"rb",index:2,id:this.g.J.id});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.fa.get("innerLayer")&&a.g?a.g.Jm():a.ia("complete"))}},kc:function(a,b,c){this.pi=!1;arguments.callee.oa.apply(this,arguments);this.rk=b.rk;if(this.zoom&&this.fm&&this.fm.length&&0.49<Math.abs(this.zoom-b.W.zoom)){for(var d=0,e=this.fm.length;d<e;d+=1)this.fm[d].ii=0;this.fm=null}this.mm(b,c);this.ld();b.kD||(b.G$=this.rg, a=this.T.Pa,this.vp(a,this.lj,b),this.pd=b.W.pd,a=this.T.Pa,a.disableVertexAttribArray(this.ab.mf),a.disableVertexAttribArray(this.ab.Ug),a.disableVertexAttribArray(this.ab.Lj),a.disableVertexAttribArray(this.ab.Kj),a.disableVertexAttribArray(this.ab.xh),this.pi&&this.set("display"))},vp:function(a,b){if(b.length){var c=this.ab,d=w.pk;this.hc+=1;a.uniform1f(c.jN,Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:1));a.enableVertexAttribArray(c.mf);a.uniform1f(c.aN,this.g.J.view.Qk);a.uniform1f(c.iN, Math.cos(this.g.J.view.get("pitch")*Math.PI/180));var e=this.Fm=[];a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);for(var g=b.length-1;0<=g;g-=1){var h=b[g];a.disableVertexAttribArray(c.Lj);a.disableVertexAttribArray(c.Kj);a.disableVertexAttribArray(c.xh);this.Wm(0,void 0,void 0);a.uniform1i(c.ui,0);this.Xm(0);for(var k=0,l=h.length;k<l;k+=1){var m=h[k];h[k].Ga&&(m.hc=this.hc,e.push(m))}this.tJ(a,h);a.enableVertexAttribArray(c.Lj); a.enableVertexAttribArray(c.Kj);a.enableVertexAttribArray(c.xh);if(h.length){for(var n={},k=0,l=h.length;k<l;k+=1){var m=h[k],p=m.Ga.road;if(p)for(var q in p)if(p.hasOwnProperty(q)){n[q]||(n[q]=[]);for(var s=0,r=p[q].length;s<r;s+=1)p[q][s].qk=m.Ga.en,n[q].push(p[q][s])}}this.uJ(a,n,h[0].ma.z)}}if("building"===this.q.xa[0]&&this.Aa.QI){e=w.a.find(this.g.get("layers"),function(a){if(a instanceof $.w.Wp&&a.get("visible"))return!0});a.clear(a.DEPTH_BUFFER_BIT);a.enable(a.DEPTH_TEST);this.Wm(0,void 0, void 0);a.disableVertexAttribArray(c.Lj);a.disableVertexAttribArray(c.Kj);a.disableVertexAttribArray(c.xh);a.uniform1i(c.ui,1);var u=this.Aa.QI.x,v=this.Aa.QI.y,k=this.q.get("sort");d.Mx([c.Sh,c.mv,c.ov]);for(g=b.length-1;0<=g;g-=1){h=b[g];d=h[0].nc;l=[];n=0;for(p=h.length;n<p;n+=1)m=h[n],l.push.apply(l,m.Ga.building);k&&l.sort(function(a,b){return Math.abs(a[5][0]-u)+Math.abs(a[5][1]-v)>Math.abs(b[5][0]-u)+Math.abs(b[5][1]-v)?1:-1});l.nc=d;this.KC(a,l,e)}17>this.Ta&&this.fm&&(this.KC(a,this.fm,e), this.pi||(this.fm=null));a.disable(a.BLEND);a.disable(a.DEPTH_TEST);a.disableVertexAttribArray(c.mf)}}},zp:256*Math.pow(2,20),tJ:function(a,b){var c=w.pk,d=this.ab;c.Mx([d.ov,d.IE,d.nv]);for(var e=0,g=b.length;e<g;e++){var h=b[e],k=h.Ga.region;if(k&&k.length){this.Xm(h.Ga.en*this.zp);h=k.buffer;a.bindBuffer(a.ARRAY_BUFFER,h.Ia);a.vertexAttribPointer(d.mf,2,a.FLOAT,!1,8,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,h.Nh);for(var l=0,m=h.Tp.length;l<m;l++){var n=h.gs[l],p=n[0];(n=n[1])&&this.g.ec&&(p=this.T.Ro(p, n),k[l].ed=p);p&&(n&&this.T.Oj[n]&&this.T.Oj[n].lc?(a.activeTexture(a.TEXTURE0),c.Pe(a,"1i",d.ov,1),c.Pe(a,"1i",d.IE,0),n=this.T.Oj[n],c.Pe(a,"2f",d.nv,[n.width/512,n.height/512]),a.bindTexture(a.TEXTURE_2D,n.lc),a.enableVertexAttribArray(d.Ug),a.bindBuffer(a.ARRAY_BUFFER,h.Lp),a.vertexAttribPointer(d.Ug,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,h.Ia),a.vertexAttribPointer(d.mf,2,a.FLOAT,!1,8,0)):(c.Pe(a,"1i",d.ov,0),a.bindTexture(a.TEXTURE_2D,this.T.ar[0])),a.uniform4f(d.Sh,p[0],p[1],p[2],p[3]), a.drawElements(a.TRIANGLES,h.Tp[l][0],a.UNSIGNED_SHORT,2*h.Tp[l][1]),a.disableVertexAttribArray(this.ab.Ug))}}}},uJ:function(a,b){var c=w.pk,d=this.ab,e=this.T.ja?this.kb:this.qp;c.Mx([d.Sh,d.ui,d.os]);for(var g in b)if(b.hasOwnProperty(g)){for(var h=b[g],k=0;k<h.length;k+=1){var l=h[k],m=l[2],n=m[4],p=m[10];p&&this.g.ec&&(n=this.T.Uj(n,p,0),l.ed=n);if(n){p="square"===l[2][9]?3:"round"===l[2][9]?4:2;c.Pe(a,"1i",d.ui,p);var q=this.uw(m)[1];q&&(this.Xm(l.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,l[0]), a.vertexAttribPointer(d.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(d.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(d.Kj,3,a.FLOAT,!1,44,20),a.vertexAttribPointer(d.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,l[1]),l=l.Kf,c.Pe(a,"1f",d.os,q*e),c.Pe(a,"4f",d.Sh,n),this.Wm(m[5]?1:0,m[5],0),a.drawElements(a.TRIANGLES,l,a.UNSIGNED_SHORT,0))}}for(k=0;k<h.length;k+=1)if(l=h[k],m=l[2],n=this.uw(m)[0])q=m[1],(p=m[10])&&this.g.ec&&(q=this.T.Uj(q,p,1),l.ed=q),q&&(p="square"===l[2][8]?3:"round"=== l[2][8]?4:2,c.Pe(a,"1i",d.ui,p),this.Xm(l.qk*this.zp),a.bindBuffer(a.ARRAY_BUFFER,l[0]),a.vertexAttribPointer(d.mf,2,a.FLOAT,!1,44,0),a.vertexAttribPointer(d.Lj,3,a.FLOAT,!1,44,8),a.vertexAttribPointer(d.Kj,3,a.FLOAT,!1,44,20),a.vertexAttribPointer(d.xh,3,a.FLOAT,!1,44,32),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,l[1]),l=l.Kf,c.Pe(a,"1f",d.os,n*e),c.Pe(a,"4f",d.Sh,q),this.Wm(m[2]?1:0,m[2],m[6]?1:0),a.drawElements(a.TRIANGLES,l,a.UNSIGNED_SHORT,0))}},KC:function(a,b,c){function d(b){b?n||(a.enableVertexAttribArray(e.Ug), g.Pe(a,"1i",e.ov,1),n=!0):n&&(a.disableVertexAttribArray(e.Ug),g.Pe(a,"1i",e.ov,0),n=!1)}var e=this.ab,g=w.pk;if(b.length&&this.pd){this.g.J.AmbientLight&&a.uniform3fv(e.Nia,this.g.J.AmbientLight.color);this.g.J.DirectionLight&&(a.uniform3fv(e.Wia,this.g.J.DirectionLight.color),a.uniform3fv(e.Xia,this.T.YW.elements));var h=new w.ZN(this.pd.Wi().WZ());a.uniformMatrix3fv(e.Yia,!1,h.elements);h=!0;17>this.Ta?h=!1:this.fm=b;var k=this.q.yr?!1:this.q.g.J.get("buildingAnimation");17>b.nc&&(k=!1);var l= this.T.Oj.buildings;a.uniform1f(e.b_,1);var m=100;a.activeTexture(a.TEXTURE0);var n=!1,p=!(!l||!l.lc);if(p){var q=Math.max(l.width,l.height),q=128/q;a.bindTexture(a.TEXTURE_2D,l.lc);a.uniform2f(e.nv,e.nv,128/l.width/q,128/l.height/q)}else a.bindTexture(a.TEXTURE_2D,this.T.ar[0]);d(p);var q=this.T.p9,s=this.T.Y9;this.g.ec&&(s=this.T.gr(q,s,"buildings"),q=s[0],s=s[1]);a.uniform4f(e.mv,q[0],q[1],q[2],q[3]);a.uniform4f(e.Sh,s[0],s[1],s[2],s[3]);for(var r=!1,u=this.Il.oda,v=0,x=b.length;v<x;v+=1){var t= b[v];if(!(t.nda&&17<=this.zoom&&c||!t||!1===t.visible||void 0==t.visible&&u)){t.dE?d(!1):d(p);t.ed=q;t[3][3]&&t[3][4]?(r=t[3][4],g.Pe(a,"4f",e.mv,t[3][3]),g.Pe(a,"4f",e.Sh,r),r=!0):r&&(r=!1,g.Pe(a,"4f",e.mv,q),g.Pe(a,"4f",e.Sh,s));if(k){if(h?100>t.ii&&(t.ii+=20):0<t.ii&&(t.ii-=20),100>t.ii&&h?this.pi=1:0<t.ii&&!h&&(this.pi=1),!t.ii)continue}else t.ii=100;m!==t.ii&&(a.uniform1f(e.b_,t.ii/100),m=t.ii);t.Ny&&(t.GD&&l&&l.lc?(a.bindBuffer(a.ARRAY_BUFFER,t[1]),a.vertexAttribPointer(e.Ug,2,a.FLOAT,!1,0, 0)):a.disableVertexAttribArray(e.Ug),a.bindBuffer(a.ARRAY_BUFFER,t[0]),a.vertexAttribPointer(e.mf,4,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,t.Ny));t.Oy&&(a.bindBuffer(a.ARRAY_BUFFER,t[2]),a.vertexAttribPointer(e.mf,4,a.FLOAT,!1,0,0),a.drawArrays(a.LINES,0,t.Oy))}}}},Wm:function(a,b,c){var d=this.ab,e=this.T.Pa;a!==this.tn&&(e.uniform1i(d.eN,a),this.tn=a);a&&b!==this.St&&(this.St=b,e.uniform4f(d.bN,b[0],b[1],b[2]||0,b[3]||0));c!==this.Hu&&(e.uniform1i(d.fN,c),this.Hu=c)},Xm:function(a){a!==this.qk&& (this.T.Pa.uniform1f(this.ab.mN,a),this.qk=a)},oI:function(a){var b=[],c=[];a&&a[0]&&(c=a[0].split("&"));(a=c[2])&&0===a.indexOf("railway")?(b[0]=1,b[3]=3):b[0]=parseInt(c[0])||0;c[3]&&c[4]&&3<c.length?(b[3]=b[0]+parseInt(c[3]),0===w.a.indexOf(c[5],"dash")&&(b[3]+=1)):b[3]=0;return b},uw:function(a){function b(a,b,c){var d;a&&b?d=a+c%1*(b-a):0===a&&b?d=Math.max(0,c%1-0.5)/0.5*b:0===a&&0===b?d=0:0!==a&&0===b&&(d=0);return w.a.Sc(d,3)}var c=a[11].browserStyle,d=a[11].levelStyleMapping;if(!c||!d){if(18< this.zoom){var e=Math.pow(2,this.zoom-18);return[a[0]*e,a[3]*e]}return[a[0],a[3]]}if(18<this.zoom)return a=this.Fi(a,18,c,d),e=Math.pow(2,this.zoom-18),[a[0]*e,a[3]*e];if(w.a.zW(this.zoom))return e=this.Fi(a,this.zoom,c,d),[e[0],e[3]];e=this.Fi(a,Math.floor(this.zoom),c,d);c=this.Fi(a,Math.ceil(this.zoom),c,d);a=b(e[0],c[0],this.zoom);e=b(e[3],c[3],this.zoom);return[a,e]},Fi:function(a,b,c,d){a=a[11].id+"-"+b;this.Jj[a]||(this.Jj[a]=this.oI(c[d[b]]));return this.Jj[a]}});w.Ma.hO=w.Ma.qc.extend({type:"sky",nj:"precision highp float;attribute vec3 a_Position;attribute vec2 a_uvs;uniform mat4 u_scaleMatrix;uniform mat4 u_scaleMatrix2;uniform mat4 u_panMatrix;uniform int u_fh;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;varying vec2 v_uvs;varying float z;void main(void) {\\tv_uvs = a_uvs;\\tz = -a_Position.z/3000.0;\\tvec4 pos = u_scaleMatrix2*u_modelViewMatrix* u_panMatrix* u_scaleMatrix * vec4(a_Position,1.0);\\tgl_Position = u_projectionMatrix * pos;}", me:"precision mediump float;uniform vec4 color;uniform sampler2D texture;uniform int ok;uniform float opacity;varying vec2 v_uvs;varying float z;void main(void) {\\tif(ok==1){\\t\\tvec4 smpColor = texture2D(texture, v_uvs);\\t\\tgl_FragColor = vec4(smpColor.xyz,color.w*opacity*z);\\t}else{\\t\\tgl_FragColor = vec4(color.xyz,color.w*opacity*z);\\t}}",Kh:function(a,b){b.gN=a.getUniformLocation(b,"u_panMatrix");b.ud=a.getAttribLocation(b,"a_Position");b.Ug=a.getAttribLocation(b,"a_uvs");b.IE=a.getUniformLocation(b, "texture");b.e_=a.getUniformLocation(b,"ok");b.Zia=a.getUniformLocation(b,"opacity");b.Fz=a.getUniformLocation(b,"color");b.a_=a.getUniformLocation(b,"aspect");b.aN=a.getUniformLocation(b,"u_cameraheight");b.Sia=a.getUniformLocation(b,"u_fh");b.bja=a.getUniformLocation(b,"u_scaleMatrix");b.cja=a.getUniformLocation(b,"u_scaleMatrix2")},B:function(a){this.tz="sky";this.gd=[11,20];this.yh=!1;this.T=a;this.g=a.g;this.X("display",this.g);this.createProgram();this.g.J.get("skyColor")?this.mz=w.a.Li("ff"+ this.g.J.get("skyColor").substr(1)):this.mz=w.a.Li("ffcce0ff");this.Px()},Px:function(){for(var a=void 0!==a?a:0,b=void 0!==b?b:2*Math.PI,c=void 0!==c?c:Math.PI/4,d=void 0!==d?d:Math.PI/4,e=c+d,g=new Float32Array(1887),h=new Float32Array(1258),k=0,l=[],m=0;16>=m;m++){for(var n=[],p=m/16,q=0;36>=q;q++){var s=q/36,r=-1*Math.cos(a+s*b)*Math.sin(c+p*d),u=1*Math.cos(c+p*d),v=1*Math.sin(a+s*b)*Math.sin(c+p*d);g[3*k]=1E4*r;g[3*k+1]=1E4*v;g[3*k+2]=1E4*-u;h[2*k]=s;h[2*k+1]=p;n.push(k);k++}l.push(n)}a=[];for(m= 0;16>m;m++)for(q=0;36>q;q++)b=l[m][q+1],d=l[m][q],k=l[m+1][q],n=l[m+1][q+1],(0!==m||0<c)&&a.push(b,d,n),(15!==m||e<Math.PI)&&a.push(d,k,n);c=this.T.Pa;e=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e);c.bufferData(c.ARRAY_BUFFER,new Float32Array(g),c.STATIC_DRAW);this.wi=e;this.sN=a.length;e=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e);c.bufferData(c.ARRAY_BUFFER,new Float32Array(h),c.STATIC_DRAW);this.NE=e;h=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,h);c.bufferData(c.ELEMENT_ARRAY_BUFFER, new Uint16Array(a),c.STATIC_DRAW);this.YM=h;this.Ia=g;this.Nh=a},ld:function(){},kc:function(a,b,c){if(this.eD(b.W.zoom)){a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);var d=this.ab;arguments.callee.oa.apply(this,arguments);a.enableVertexAttribArray(d.Ug);a.enableVertexAttribArray(d.ud);var e=this.T.fx;this.g.ec&&(this.ed=e=this.T.Ro(e,this.tz));a.uniform4f(d.Fz,e[0],e[1],e[2],e[3]);a.uniform1f(d.Zia,this.CV(b.W.zoom)); a.uniform1i(d.Sia,120*b.W.zoom);e=this.g.J.view.hca;a.uniformMatrix4fv(d.gN,!1,e.elements);var g=1.1*this.g.J.view.Qk/1E4,h=Math.max(1,b.W.yx),g=(new w.ge).as(g,g,g);a.uniformMatrix4fv(d.bja,!1,g.elements);h=(new w.ge).as(h,1,1);a.uniformMatrix4fv(d.cja,!1,h.elements);var k=this.T.Oj[this.tz];k&&k.lc?(a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,k.lc),a.uniform1i(this.ab.IE,0),a.uniform1i(this.ab.e_,1)):(a.uniform1i(this.ab.e_,0),a.bindTexture(a.TEXTURE_2D,this.T.ar[0]));a.bindBuffer(a.ARRAY_BUFFER, this.wi);a.vertexAttribPointer(d.ud,3,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.NE);a.vertexAttribPointer(d.Ug,2,a.FLOAT,!1,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.YM);a.drawElements(a.TRIANGLES,this.sN,a.UNSIGNED_SHORT,0);a.disableVertexAttribArray(d.Ug);a.disableVertexAttribArray(d.ud);a.disable(a.BLEND);this.pd=h.multiply((new w.ge).set(b.W.pd).multiply((new w.ge).set(e).multiply(g)));this.ld()}},CV:function(a){return 12<a?1:a-11},eD:function(a){return 11<a?!0:!1}}); w.Ma.G0=w.Ma.hO.extend({B:function(){this.gd=[3,11];arguments.callee.oa.apply(this,arguments);this.tz="atmosphere"},CV:function(){return 1},eD:function(a){return 12>a?!0:!1}});w.Ma.eka=w.Ma.qc.extend({type:"fog",nj:"precision highp float;attribute vec3 a_Position;uniform float u_cameraheight;uniform float pitch;uniform float aspect;uniform mat4 u_panMatrix;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;varying float z;void main(void) {\\tz = a_Position.z;\\tvec3 pos_ = vec3(a_Position.xy,a_Position.z*pitch);\\tvec4 pos = u_modelViewMatrix* u_panMatrix * vec4(pos_*u_cameraheight,1.0);\\tpos.x *= aspect;\\tgl_Position = u_projectionMatrix * pos;}",me:"precision mediump float;uniform vec4 color;varying float z;uniform float factor;void main(void) {\\tfloat a = color.a*(1.0-pow(abs(z)/(z>0.0?(0.08-factor):(0.04+factor)),2.0));\\tgl_FragColor =  vec4(color.rgb,a);}", Kh:function(a,b){b.gN=a.getUniformLocation(b,"u_panMatrix");b.ud=a.getAttribLocation(b,"a_Position");b.Fz=a.getUniformLocation(b,"color");b.iN=a.getUniformLocation(b,"pitch");b.a_=a.getUniformLocation(b,"aspect");b.Ria=a.getUniformLocation(b,"factor");b.aN=a.getUniformLocation(b,"u_cameraheight")},B:function(a){this.yh=!1;this.T=a;this.g=a.g;this.X("display",this.g);this.createProgram();this.g.J.get("skyColor")?this.mz=w.a.Li("ff"+this.g.J.get("skyColor").substr(1)):this.mz=w.a.Li("ffcce0ff");this.Px()}, Px:function(){for(var a=void 0!==a?a:0,b=void 0!==b?b:2*Math.PI,c=void 0!==c?c:30*Math.PI/100,d=void 0!==d?d:35*Math.PI/100,e=c+d,g=new Float32Array(666),h=new Float32Array(444),k=0,l=[],m=0;5>=m;m++){for(var n=[],p=m/5,q=0;36>=q;q++){var s=q/36,r=-1*Math.cos(a+s*b)*Math.sin(c+p*d),u=1*Math.cos(c+p*d),v=1*Math.sin(a+s*b)*Math.sin(c+p*d);g[3*k]=r;g[3*k+1]=v;g[3*k+2]=-u/3;h[2*k]=s;h[2*k+1]=p;n.push(k);k++}l.push(n)}a=[];for(m=0;5>m;m++)for(q=0;36>q;q++)b=l[m][q+1],d=l[m][q],k=l[m+1][q],n=l[m+1][q+1], (0!==m||0<c)&&a.push(b,d,n),(4!==m||e<Math.PI)&&a.push(d,k,n);c=this.T.Pa;e=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e);c.bufferData(c.ARRAY_BUFFER,new Float32Array(g),c.STATIC_DRAW);this.wi=e;this.sN=a.length;this.Ia=g;this.Nh=a;g=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,g);c.bufferData(c.ARRAY_BUFFER,new Float32Array(h),c.STATIC_DRAW);this.NE=g;h=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,h);c.bufferData(c.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),c.STATIC_DRAW);this.YM=h},ld:function(){}, kc:function(a,b,c){a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);var d=this.ab;arguments.callee.oa.apply(this,arguments);a.enableVertexAttribArray(d.ud);var e=b.W.zoom;a.uniform1f(d.Ez,1-0.015*(e-3));a.uniform1f(d.Ria,11>e?0:0.008*(e-11));a.uniform1f(d.a_,b.W.yx);a.uniform1f(d.iN,b.W.pitch/65*(1-0.5*Math.abs(e-11)/(11<e?6:9)));e=this.T.fx;this.g.ec&&(e=this.T.Ro(e,"sky"));a.uniform4f(d.Fz,e[0],e[1],e[2],e[3]);a.uniform1f(d.aN, this.g.J.view.Qk*(1.3+0.03*(12-Math.min(12,b.W.zoom))));a.uniformMatrix4fv(d.gN,!1,this.g.J.view.vna.Wi().elements);a.bindBuffer(a.ARRAY_BUFFER,this.wi);a.vertexAttribPointer(d.ud,3,a.FLOAT,!1,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.YM);a.drawElements(a.TRIANGLES,this.sN,a.UNSIGNED_SHORT,0);a.disableVertexAttribArray(d.ud);a.disable(a.BLEND);this.ld()}});w.Ma.fF=w.Ma.qc.extend({type:"land",nj:"precision highp float;attribute vec3 a_Position;attribute vec2 a_uvs;varying vec2 v_uvs;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;varying  float z;void main(void) {\\tv_uvs = a_uvs;\\tvec4 pos = u_projectionMatrix*u_modelViewMatrix * vec4(a_Position.xy,0.0,1.0);\\tgl_Position = pos;\\tz = a_Position.z;}",me:"precision mediump float;uniform sampler2D textureL;uniform sampler2D textureW;uniform highp vec4 textureScale;varying highp vec2 v_uvs;uniform vec4 color;uniform vec4 color2;varying highp float z;void main(void) {if(z==0.0){\\tif(textureScale.z!=0.0){\\t\\tvec4 smpColor = texture2D(textureW, vec2(v_uvs.x/textureScale.z,v_uvs.y/textureScale.w));\\t\\tgl_FragColor= vec4(smpColor.rgb*smpColor.a+color2.rgb*(1.0-smpColor.a),color2.a);\\t}else{\\t\\tgl_FragColor = color2;\\t}}else{\\tif(textureScale.x!=0.0){\\t\\thighp float u  = v_uvs.x/textureScale.x;\\t\\thighp float v  = v_uvs.y/textureScale.y;\\t\\tvec4 smpColor = texture2D(textureL, vec2(u,v));\\t\\tgl_FragColor= vec4(smpColor.rgb*smpColor.a+color.rgb*(1.0-smpColor.a),color.a);\\t}else{\\t\\tgl_FragColor = color;\\t}}}", Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position");b.Ug=a.getAttribLocation(b,"a_uvs");b.dja=a.getUniformLocation(b,"textureL");b.fja=a.getUniformLocation(b,"textureW");b.Fz=a.getUniformLocation(b,"color");b.Qia=a.getUniformLocation(b,"color2");b.nv=a.getUniformLocation(b,"textureScale")},B:function(a){this.yh=!0;this.T=a;this.g=a.g;this.X("display",this.g);this.createProgram();this.Px()},Px:function(){for(var a=this.T.Pa,b=w.a.Za,c=[-b,-b,0,2*b,-b,0,2*b,0,0,-b,-b,0,2*b,0,0,-b,0,0,-b,b,1,2* b,b,1,2*b,2*b,1,-b,b,1,2*b,2*b,1,-b,2*b,1],d=[],e=0;e<c.length;e+=3)d.push(c[e]+b,c[e+1]+b),c[e]-=w.a.fc.x,c[e+1]-=w.a.fc.y;b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW);this.wi=b;c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW);this.NE=c},ld:function(){},kc:function(a,b,c){a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ZERO);a.disable(a.DEPTH_TEST); var d=this.ab;arguments.callee.oa.apply(this,arguments);a.enableVertexAttribArray(d.ud);a.enableVertexAttribArray(d.Ug);var e=this.T.vd;a.uniform4f(d.Fz,e[0],e[1],e[2],e[3]);e=this.T.XB;a.uniform4f(d.Qia,e[0],e[1],e[2],e[3]);var e=this.T.Oj["regions:land"],g=this.T.Oj.water,h=b.W.bf,k=0,l=0,m=0,n=0;a.activeTexture(a.TEXTURE1);var p=b.W.zoom;11>p&&e&&e.lc&&(k=e.width*h,l=e.height*h,a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,e.lc),a.uniform1i(this.ab.dja,0));11>p&&g&&g.lc&&(m=g.width*h, n=g.height*h,a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,g.lc),a.uniform1i(this.ab.fja,1));a.uniform4f(this.ab.nv,k,l,m,n);a.bindBuffer(a.ARRAY_BUFFER,this.wi);a.vertexAttribPointer(d.ud,3,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.NE);a.vertexAttribPointer(d.Ug,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,12);a.disableVertexAttribArray(d.Ug);this.ld()}});w.Ma.eF=w.Ma.Hv.extend({ga:[w.Ls],BI:1,QM:[1,0,1,1,0,0,1,1,0,1,0,0],nj:"precision mediump float;attribute highp vec4 a_Position;varying vec4 v_texcoord;varying lowp float f_texIndex;uniform lowp int u_type;uniform vec3 u_hlColorFactor;uniform vec2 u_texVertices[6];uniform highp mat4 u_modelViewMatrix;uniform highp mat4 u_projectionMatrix;uniform mat4 u_poiPrjMatrix;uniform mat4 u_textureMatrix[_ElemBatchNum_];uniform mat4 u_transMatrix[_ElemBatchNum_];uniform vec4 u_params[_ElemBatchNum_];void main(void) {\\tif(u_type == 2){\\t\\tgl_Position = u_poiPrjMatrix * vec4(a_Position.xyz, 1.0); \\t\\treturn;\\t}\\tint pointIdx = int(a_Position.z); \\tint elemIdx = int(a_Position.w); \\tvec4 param = u_params[elemIdx]; \\tf_texIndex  = param.z;   v_texcoord = vec4((u_textureMatrix[elemIdx] * vec4(u_texVertices[pointIdx].xy, 0.0, 1.0)).xy, param.xy);\\tvec4 pos =  vec4(a_Position.xy, 0.0, 1.0);\\tif(u_type == 0 ){ \\t\\tpos.z = param.w;\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * u_transMatrix[elemIdx] * pos;\\t} else if(u_type == 1){\\t\\tgl_Position = u_poiPrjMatrix * pos;\\t\\tgl_Position.z = param.w;\\t} }", me:"precision mediump float;uniform sampler2D texture[_TexBatchNum_];uniform lowp int u_type;uniform vec3 u_hlColorFactor;varying vec4 v_texcoord;varying lowp float f_texIndex;void main(void) {\\tif(u_type == 2){\\t\\tgl_FragColor = normalize(vec4(0, 0, 0, 1)); return;\\t}\\tint style = int(v_texcoord.w); \\tif(style < 0){ gl_FragColor = vec4(0, 0, 0, 1); return; }\\tint texIdx = int(floor(f_texIndex+0.1)); \\tfloat opacity = v_texcoord.z; \\tvec4 smpColor; \\t__SmpColorLoop__\\tif(smpColor.a < 0.07) { discard; }\\tif( style > 0 ) {\\t\\tfloat r = u_hlColorFactor.x > 0.0 ? smpColor.r * u_hlColorFactor.x : -u_hlColorFactor.x; \\t\\tfloat g = u_hlColorFactor.y > 0.0 ? smpColor.g * u_hlColorFactor.y : -u_hlColorFactor.y; \\t\\tfloat b = u_hlColorFactor.z > 0.0 ? smpColor.b * u_hlColorFactor.z : -u_hlColorFactor.z; \\t\\tsmpColor = vec4(r, g, b, smpColor.a);\\t\\tif(style > 1){ smpColor = vec4(smpColor.rgb * 0.9, smpColor.a); }\\t} \\tsmpColor *= opacity;\\tgl_FragColor =  smpColor;}", Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position");b.Ap=a.getUniformLocation(b,"texture");b.kN=a.getUniformLocation(b,"u_texVertices");b.lN=a.getUniformLocation(b,"u_textureMatrix");b.$ia=a.getUniformLocation(b,"u_poiPrjMatrix");b.gja=a.getUniformLocation(b,"u_transMatrix");b.hN=a.getUniformLocation(b,"u_params");b.Via=a.getUniformLocation(b,"u_hlColorFactor");b.ui=a.getUniformLocation(b,"u_type")},B:function(a,b){this.SM=500;this.Nda=!0;var c=b.Pa;this.Zx=Math.max(1,Math.min(Math.floor((c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS)- 20)/4/4),128));this.nj=this.nj.replace(/_ElemBatchNum_/g,this.Zx);this.BE=Math.min(this.Zx,c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),16);for(var d=[],e=0;e<this.BE;e++)d.push((0<e?"else ":" ")+"if(texIdx=="+e+"){ smpColor = texture2D(texture["+e+"], v_texcoord.xy); }");this.me=this.me.replace(/_TexBatchNum_/g,this.BE).replace(/__SmpColorLoop__/g,d.join("\\n"));arguments.callee.oa.apply(this,arguments);this.X("reload",a,!0);this.X("style",b);this.kb=Math.min(2,window.devicePixelRatio||1);this.eh=this.ji= !0;this.ly=[];this.xA=[];this.yA=[];this.labels=[];this.kga=new w.ge;this.aL(a);this.bo=c.createBuffer()},styleChanged:function(){var a=this;this.T.g.ec?(a.IB&&clearTimeout(a.IB),a.IB=setTimeout(function(){a.IB=null;a.reloadChanged()},300)):a.reloadChanged()},reloadChanged:function(){this.q&&(this.q.ta=!1);this.wa.clear();this.labels=[];this.ly=[];this.xA=[];this.yA=[];this.set("display")},aL:function(a){a=w.l.Y||a.ja?"big":"small";var b=w.A.Rb+"://vdata.amap.com/style_icon/icon-biz-"+a+".png";w.Mh.$k(w.A.Rb+ "://vdata.amap.com/style_icon/icon-normal-"+a+".png",!0);w.Mh.$k(b,!0)},al:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;if(!this.IB&&!this.g.Nc.mB)for(var c=a.length-1;0<=c;c-=1){var d=a[c];if(d.length){if(this.q.nx){for(var e=[],g=d.length-1;0<=g;g-=1){var h=d[g],k=h.ma;this.q.g.eo.sz(k.x,k.y,k.z)?e.push(d[g]):(this.wa.set(h.key,h),h.loaded=!0,h.status="loaded",h.qa=!0,h.Ga={})}d=e;a[c]=e;if(0==e.length)continue}if(this.g.Iz)break;e=d[0].ma.z;18<e&&(d=this.VZ(d,e)); this.es(d,1);for(h=g=0;g<d.length;)this.cL(d.slice(100*h,100*h+100),e,b),g+=100,h+=1}}},ld:function(){if(this.rg&&!this.q.ta){var a=this.q;w.Yd.ue.end({key:"rl",index:2,id:this.T.g.J.id});a.ta=!0;a.cd?a.ia("renderComplete"):(a.cd=!0,a.ia("complete"))}},Rca:function(a){var b=a.Oa,c=b[0];a.reverse&&(c>w.a.Za/2?c-=w.a.Za:c<-w.a.Za/2&&(c+=w.a.Za));return[c,b[1]]},KI:function(a,b,c){a=b.createTexture();b.bindTexture(b.TEXTURE_2D,a);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);b.texImage2D(b.TEXTURE_2D, 0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);return{width:c.width,height:c.height,lc:a,fv:this.BI++}},NF:function(a,b,c){for(var d=[],e=0,g=b.length;e<g;e++){var h=b[e].md,k=h[0],l=h[1],m=h[2],h=h[3];d.push.apply(d,[m,l,0,e,m,h,1,e,k,l,2,e,m,h,3,e,k,h,4,e,k,l,5,e])}a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW);return c},H1:function(a,b, c){for(var d=[],e=0,g=b.length;e<g;e++){var h=b[e][0],k=b[e][1];d.push.apply(d,[h[0],h[1],h[2],e,k[0],k[1],k[2],e])}a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW);return c},T$:function(a,b,c,d,e,g){if(!a.mL&&!1===a.visible)return!1;var h=this.Ql(d);if(!h||!h.width||!h.height)return!1;d="string"===typeof d&&0<d.indexOf("/style_icon/");g=g||0;h.Rm&&h.Rm.Ac===this.Ac&&a.floor===h.FA||(h.Rm=this.KI(a,b,h),h.Rm.Ac=this.Ac,a.cm&&void 0!==a.floor&&(h.FA=a.floor)); var k=this.q.ja?d?1.75:2:1;b=this.S;var h=h.Rm,l=e[2]/k,m=e[3]/k,n=e[0]/k,k=e[1]/k,p=e[4],q=e[5],s=e[6],r=e[7];e=null;a.Yi&&a.zB&&(e=a.zB.KZ,e={md:e?[e[0],e[1],e[0]+e[2],e[1]+e[3]]:null,dir:a.zB.dir});var u=c[0]+n*b,v=c[1]+k*b,p=[p,q,p+s,q+r],q=[u,v,u+l*b,v+m*b];d&&(a.qI=!0);s=1;a.mL?s=1-this.T.ou:a.cm&&(s=a.opacity);return{Ff:a,bp:d,fv:h.fv,via:h.lc,LZ:h.width,IZ:h.height,rZ:p,hz:e,Mba:q,width:l,height:m,SL:c,offset:[n,k],Qna:b,rotation:g,opacity:s}},aD:function(a,b,c,d){var e=c[0],g=c[1],h=c[2]- e;c=c[3]-g;var k=new w.ge;k.as(1/a,1/b,1);0!==d&&(a=[e+h/2,g+c/2],k.translate(a[0],a[1],0),k.rotate(d,0,0,1),k.translate(-a[0],-a[1],0));k.translate(e,g,0);k.scale(h,c,1);return k},gda:function(a,b,c,d){var e=new w.ge;if(b||c||1!==d){var g=a[0],h=a[1];a=[g+(a[2]-g)/2,h+(a[3]-h)/2];e.translate(a[0],a[1],0);b&&e.rotate(b,0,0,1);c&&e.rotate(c,1,0,0);1!==d&&e.scale(d,d,1);e.translate(-a[0],-a[1],0)}return e},HL:function(a){for(var b=a.length;b<this.BE;b++)a[b]=0;return a},Jba:function(a,b,c){var d=[], e,g;e=0;for(g=c.hs.length;e<g;e++)b.activeTexture(b.TEXTURE0+e),b.bindTexture(b.TEXTURE_2D,c.hs[e]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),d[e]=e;b.uniform1iv(a.Ap,this.HL(d));c=c.list;var d=[],h=this.Ys.W,k={PM:!0,XM:!0},l=h.rotation%360;0>l&&(l+=360);e=0;for(g=c.length;e<g;e++){var m=c[e],n=!1,p=-m.rotation,q=0,s=m.Ff.qI;s?q=-l:45<=l&&315>=l&&m.hz&&(q=m.hz.dir,0===q?45<=l&&225>=l&&(n=!0):1===q&&135<=l&&315>=l&&(n=!0), q=90*-Math.round(l/90));var n=this.aD(m.LZ,m.IZ,n&&m.hz&&m.hz.md?m.hz.md:m.rZ,0),r=this.hI(m.Mba),p=this.gda(r,p+q,s?h.pitch:0,s?1:this.JS);d.push([n.elements,p.elements,{Ff:m.Ff,md:r,opacity:m.opacity,OM:m.eI,TL:m.bp?-1:-2,KM:0}]);if(e===g-1||d.length>=this.Zx)this.pJ(a,b,d,k),d.length=0}},hI:function(a){var b=w.a.fc,c=b.x,b=b.y;return[a[0]-c,a[1]-b,a[2]-c,a[3]-b]},Gba:function(a,b,c){var d=[],e,g;e=0;for(g=c.hs.length;e<g;e++)b.activeTexture(b.TEXTURE0+e),b.bindTexture(b.TEXTURE_2D,c.hs[e]),b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),d[e]=e;b.uniform1iv(a.Ap,this.HL(d));c=c.list;var d=[],h,k,l={PM:!0,XM:!1};this.vj&&(h=this.vj.M,k="active"===this.vj.Vl?2:1);e=0;for(g=c.length;e<g;e++){var m=c[e],n=this.aD(m.LZ,m.IZ,this.lr(m,m.rZ),0);d.push([n.elements,null,{Ff:m.Ff,md:this.lr(m,m.Pu),opacity:m.opacity,OM:m.eI,TL:m.RL.z,KM:m.Ff===h?k:0}]);if(e===g-1||d.length>=this.Zx)this.pJ(a,b,d,l),d.length=0}},Vla:function(a,b,c){var d=[],e=b.NEAREST, g,h;g=0;for(h=1;g<h;g++)b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,c.hs[g]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,e),d[g]=g;b.uniform1iv(a.Ap,this.HL(d));c=c.list;d=[];e={PM:!1,XM:!1};g=0;for(h=c.length;g<h;g++){var k=c[g];d.push([null,null,{Ff:k.Ff,md:this.lr(k),opacity:k.opacity,OM:k.eI,TL:k.RL.z,KM:-1}]);if(g===h-1||d.length>=this.Zx)this.pJ(a,b,d,e),d.length=0}},pJ:function(a,b,c,d){var e=c.length;if(e){for(var g=[], h=[],k=[],l=[],m=d.PM,n=d.XM,p=0;p<e;p++)m&&h.push.apply(h,c[p][0]),n&&k.push.apply(k,c[p][1]),d=c[p][2],g.push(d),l.push(d.opacity),l.push(d.KM),l.push(d.OM),l.push(d.TL||0);m&&b.uniformMatrix4fv(a.lN,!1,h);n&&b.uniformMatrix4fv(a.gja,!1,k);b.uniform4fv(a.hN,l);this.NF(b,g,this.bo);b.vertexAttribPointer(a.ud,4,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,6*e)}},pga:function(a,b){var c=!1;b.Ub&&(this.T.Wo===b.Ub?c=!0:void 0!==b.Xq&&this.T.Wo===b.Ub+"-"+b.Xq&&(c=!0),b.mL=c);var d=b.mL||void 0===b.ik? !0:b.ik,e=b.Oa||this.Rca(b);if(!w.Qc.nd(e,this.qP))return null;if(this.yQ&&!b.cm&&this.Ys.Hb.length){var g=!1;w.a.Pb(this.yQ,function(a){if(w.Qc.nd(e,a.Of[0].Oa))return g=!0,!1});if(g)return null}var c=[],h=b.Da,k=b.wb,l,m;l=0;for(m=h.length;l<m;l+=1)if(d||"CANVAS"===h[l].tagName){var n=this.T$(b,a,e,h[l],k[l],b.Xr);n&&c.push(n)}return b.Yi&&(d=this.Ys.W.pitch,60<d||45<d&&!b.qI)?null:c.length?c:null},V$:function(a){for(var b=0,c=a.length;b<c;b++){var d=this.Q$(a[b]);d&&d.length?a[b]=d:(a.splice(b, 1),b--,c--)}},Q$:function(a){if(!a.length)return null;var b,c;b=0;for(c=a.length;b<c;b++)this.TT(a[b]);b=a[0].HJ;if(11>(a[0].Ff.le||13)*b||0.75>b)return null;a=this.$ba(a);if(!a)return null;var d=!1;b=0;for(c=a.length;b<c;b++)if((new w.Ie(this.lr(a[b]))).sf(this.X2,10)){d=!0;break}return d?a:null},lr:function(a,b){b||(b=a.Pu);var c=a.yga||[0,0,0,0];return[b[0]-c[3],b[1]-c[0],b[2]+c[1],b[3]+c[2]]},cfa:function(a,b){this.ao.ty(a,b)},HW:function(a){var b=0,c=0,d=a[2]-a[0],e=a[3]-a[1];1>this.Zs&&(b+= Math.min(10,d)*(1-this.Zs),c+=Math.min(10,e)*(1-this.Zs));return 0===this.ao.search([a[0]-b,a[1]-c,a[2]+b,a[3]+c]).length},z$:function(a){for(var b=0,c=a.length;b<c;b++)if(!this.HW(a[b]))return!1;return!0},IW:function(a){for(var b=0,c=a.length;b<c;b++)if(!this.HW(this.lr(a[b])))return!1;return!0},dfa:function(a){for(var b=0,c=a.length;b<c;b++)this.cfa(this.lr(a[b]),a[b].Ff)},$ba:function(a){var b,c,d=[],e=[];b=0;for(c=a.length;b<c;b++){var g=a[b];g.bp?d.push(g):e.push(g)}return this.IW(d)?this.IW(e)? (this.dfa(a),a):null:null},iV:function(a,b,c,d){var e=a[0],g=[],h,k=0,l;a=a[1];if(d){d=0;for(h=b.length;d<h;d++)0<d&&(k+=c),k+=b[d].height;a-=k}d=0;for(h=b.length;d<h;d++)k=b[d].width,l=b[d].height,g[d]=[e-k/2,a],g[d][2]=g[d][0]+k,g[d][3]=g[d][1]+l,a+=l+c;return g},hV:function(a,b,c,d){var e=a[0],g=a[1];a=[];var h,k,l=0;h=0;for(k=b.length;h<k;h++)0<h&&(l+=c),l+=b[h].height;var m=g-l/2;h=0;for(k=b.length;h<k;h++)g=b[h].width,l=b[h].height,a[h]=[e+(d?-g:0),m],a[h][2]=a[h][0]+g,a[h][3]=a[h][1]+l,m+= l+c;return a},Moa:function(a,b){if(b&&b.length){var c=this.Ys.W.rotation,c=c%360;0>c&&(c+=360);var d=null,e=a.Ff,g,h,k;if(0!==c&&(e.XA&&(!this.SA||10>Math.abs(e.XA.rotation-c))&&(d=e.XA.list,d.length!==b.length&&(d=null)),this.SA&&!d)){h=this.lr(a);var l=[(h[0]+h[2])/2,(h[1]+h[3])/2],m=0,n=[],p=[];g=0;for(k=b.length;g<k;g++){var q=b[g].Ju;n[g]={width:q[2]-q[0],height:q[3]-q[1]};1===g&&(m=q[1]-b[0].Ju[3]);p.push(q)}l=[p,this.iV([l[0],h[3]+1],n,m,!1),this.hV([h[2]+1,l[1]],n,m,!1),this.hV([h[0]-1,l[1]], n,m,!0),this.iV([l[0],h[1]-1],n,m,!0)];g=0;for(k=l.length;g<k;g++)if(this.z$(l[g])){m=[];d=0;for(k=b.length;d<k;d++){n=[];for(h=0;4>h;h++)n[h]=l[g][d][h]-b[d].Ju[h];m[d]=n}d=m;break}d&&(e.XA={list:d,rotation:c})}g=0;for(k=b.length;g<k;g++)if(c=b[g],d){e=[];for(h=0;4>h;h++)e[h]=c.Ju[h]+d[g][h];c.Pu=e}else c.Pu=c.Ju;return!!d}},dda:function(a){var b=a.Ff;if(a.bp)if(a=b.$e,0===b.vr){if(0===a)return[-5,0,-4,0];if(2===a)return[-7,-7,-7,-7];if(3===a||4===a||5===a||160<=a&&164>=a)return[-8,-8,-8,-8];if(6<= a&&8>=a)return[-5,0,-5,0];if(9===a)return[-7,0,-7,0];if(10<=a&&139>=a&&120!==a||142<=a&&144>=a||150<=a&&159>=a||164<=a&&169>=a)return[-3,-3,-3,-3]}else{if(1===b.vr)return[-3,-3,-3,-3]}else if(13<=b.le)return[-1,-1,-1,-1];return null},TT:function(a){var b=a.RL,c=1;a.HJ=1;if(1>this.Zs){var d=this.fw.height,e=b.y/d;0.5>e&&(d=Math.min(1,0<this.Zs?(0.5-e)*d/this.Zs*this.Y2/3E3:1),a.HJ=1-0.4*d)}c*=a.HJ;d=b.x+a.offset[0]*c;b=b.y+a.offset[1]*c;a.Pu=a.Ju=[d,b,d+a.width*c,b+a.height*c];a.yga=this.dda(a);return!0}, Hga:function(a){var b=a[0].Ff.XA,c=[],d=[],e,g;e=0;for(g=a.length;e<g;e++)this.TT(a[e]),a[e].bp?c.push(a[e]):d.push(a[e]);if(b&&b.length===d.length)for(e=0,g=d.length;e<g;e++){a=d[e];for(var c=[],h=0;4>h;h++)c[h]=a.Ju[h]+b[e][h];a.Pu=c}},VV:function(a){function b(a,b,c){if(!e[c])for(var h=0,k=d.length;h<k;h++)if(d[h].hs.length<g){d[h].JZ.push(c);d[h].hs.push(b);e[c]=[h,d[h].JZ.length-1];break}e[c]||(d.push({hs:[b],JZ:[c],list:[]}),e[c]=[d.length-1,0]);a.eI=e[c][1];b=d[e[c][0]];a.bp&&(b.x_=!0);b.list.push(a)} function c(a,b){var c=a.bp?1:2,d=b.bp?1:2;return c!==d?d-c:a.fv-b.fv}var d=[],e={},g=this.BE;if(!a||!a.length)return d;var h,k;h=0;for(k=a.length;h<k;h++)for(var l=0,m=a[h].length;l<m;l++){var n=a[h][l];b(n,n.via,n.fv)}h=0;for(k=d.length;h<k;h++)d[h].list.sort(c),d[h].list.reverse();d.sort(function(a,b){return(a.x_?1:2)-(b.x_?1:2)});return d},Wla:function(a,b,c){for(var d=[],e=0,g=c.length;e<g;e++)for(var h=c[e],k=0,l=h.length;k<l;k++)if(h[k].bp){l=h[k].Pu;h=h[k].Yma;d.push([[(l[0]+l[2])/2,l[3],h.z], [h.x,h.y,h.z]]);break}d.length&&(this.H1(b,d,this.bo),b.vertexAttribPointer(a.ud,4,b.FLOAT,!1,0,0),b.drawArrays(b.LINES,0,2*d.length))},Iba:function(a,b,c){c=this.VV(c);for(var d=0,e=c.length;d<e;d++)this.Jba(a,b,c[d])},Fba:function(a,b,c){c=this.VV(c);for(var d=0,e=c.length;d<e;d++)this.Gba(a,b,c[d])},qga:function(a,b,c,d){var e,g,h=Math.abs(this.V2),k=Math.round(this.zoom),l=k+1;e=0;for(g=b.length;e<g;e+=1){var m=b[e];if(!m.cm){if(m.im>l||m.iL<k)continue;if(!m.im&&!m.iL&&1.5<=h)continue}var n=m.un, p=m.Yi,q=m.cm;if(c&&(n||q)||d&&p)if(m=this.pga(a,m))if(n||q)c.push(m);else if(p)d.push(m);else throw Error("Unknow label");}this.YT(c);this.V$(c)},YT:function(a){var b,c,d,e,g,h=[];b=0;for(c=a.length;b<c;b++){d=a[b][0].SL;e=0;for(g=a[b].length;e<g;e++)d!==a[b][e].SL&&console.error("coord not equal!!!!");h[b]=new w.G(d[0],d[1])}d=this.g.J.view.rX(h);b=0;for(c=a.length;b<c;b++)for(e=0,g=a[b].length;e<g;e++)a[b][e].RL=d[b]},kc:function(a,b,c){arguments.callee.oa.apply(this,arguments);if(this.g&&this.g.J){this.rk= b.rk;this.If=b.If;this.mm(b,c);var d=this.lj;this.Ys=b;this.SA=this.g.J.view.EW();var e=Date.now(),g=!1;if(this.labels&&7E3<e-this.labels.jha||b.Hb&&b.Hb.length&&this.P4!==b.Hb)g=!0;for(var h=d.length-1;0<=h;h-=1){var k=d[h];if(k.length){var l=k[0].ma.z,m=!1;!1===k.rg||w.Da.be||this.labels&&this.labels.length&&!b.ck&&!this.SA&&!g||(m=!0,this.labels=[],this.labels.zoom=l,this.labels.hv=this.Mf,this.labels.jha=e);if(m)for(l=k.length-1;0<=l;l-=1){var n=k[l],m=!1,p=n.xa;!p&&n.Jc&&n.Jc.xa&&(p=n.Jc.xa, m=!0);if(p){for(var n=0,q=p.length;n<q;n+=1)p[n].reverse=m;Array.prototype.push.apply(this.labels,p)}}}}b.Hb&&b.Hb.length&&(this.g.Nc.mB&&(this.labels=[]),this.P4=b.Hb,w.a.Pb(b.Hb,function(a){a.cm=!0}),this.labels.unshift.apply(this.labels,b.Hb),this.yQ=b.Hb.bU);this.ld();this.g.J.ta&&this.labels.length&&this.iM()}},gia:function(a,b){var c=a.hl||-1,d=b.hl||-1;c===d&&(c=a.Da.length,d=b.Da.length);c===d&&(c=a.le,d=b.le);return a.cm&&!b.cm?-1:!a.cm&&b.cm?1:c!==d?d-c:a.gl&&b.gl?a.gl>b.gl?1:-1:a.name> b.name?1:-1},qY:function(){this.set("display")},taa:function(){this.ao&&(this.ao=this.ao.iz=null)},sga:function(a){var b=Date.now(),c,d,e=[];c=0;for(d=a.length;c<d;c++){var g=b-a[c].qQ.startTime;if(200<=g||!w.Qc.nd(a[c][0].SL,this.qP))a.splice(c,1),c--,d--;else{for(var g=a[c][0].Ff.cm?0:a[c].qQ.opacity*(1-g/200)*(1-g/200),h=0,k=a[c].length;h<k;h++)a[c][h].opacity=g;a[c][0].Ff.un&&e.push(a[c])}}this.YT(e);c=0;for(d=e.length;c<d;c++)this.Hga(e[c])},Nca:function(){var a=this.g.J.get("highlightColorFactor")|| [0.95,0.95,-0.95],b=this.Ys.jp||"normal",b=b.replace("amap://styles/","");switch(b){case "insight":case "grey":case "dark":case "blue":case "darkblue":case "blue_night":case "mapv":a=[1.5,1.5,1];break;case "graffiti":a=[0.5,0.5,0.5]}return a},zba:function(a,b,c){var d=this.T.Pa,e=this.ab;d.enable(d.BLEND);d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA);d.enableVertexAttribArray(e.ud);d.uniform2fv(e.kN,this.QM);d.uniform3fv(e.Via,this.Nca());var g=this.kga;g.dZ(0,this.fw.width,this.fw.height,0,-1);d.uniformMatrix4fv(e.$ia, !1,g.elements);this.sga(c);for(var g=[],h=[],k=0,l=c.length;k<l;k++)c[k][0].Ff.Yi?h.push(c[k]):g.push(c[k]);a&&(d.uniform1i(e.ui,0),this.Iba(e,d,h.concat(a)));b&&(d.uniform1i(e.ui,1),this.Fba(e,d,g.concat(b)));d.disableVertexAttribArray(e.ud);d.disable(d.BLEND)},nja:function(){for(var a=this.yA,a=[].concat(this.xA).concat(a),b=this.labels.length=0,c=a.length;b<c;b++)this.labels.push(a[b][0].Ff)},pja:function(a){var b=this.xA.concat(this.yA);if(b&&b.length){var c=[],d=[],e,g;e=0;for(g=a.length;e<g;e++)c.push(a[e][0].Ff); a=Date.now();e=0;for(g=b.length;e<g;e++){var h=b[e][0].Ff;0>c.indexOf(h)&&(!h.Yi||h.qI)&&(b[e].qQ={startTime:a,opacity:b[e][0].opacity},d.push(b[e]))}this.ly.push.apply(this.ly,d)}},iM:function(){var a=this.T.Pa;this.fw=this.g.J.get("size");this.X2=new w.Ie(0,0,this.fw.width,this.fw.height);this.ao&&this.taa();this.ao=new w.Vh(32);this.V2=this.labels.zoom-this.zoom;var b=this.Ys.W.pitch*Math.PI/180;this.Zs=Math.cos(b);this.Y2=Math.sin(b);this.qP=this.Aa.path;this.JS=1;this.labels.zoom>this.zoom&& (this.JS=Math.min(1,Math.max(0.75,1-(this.labels.zoom-this.zoom))));var b=[],c=[];this.labels.sort(this.gia);this.qga(a,this.labels,b,c);this.pja(b.concat(c));this.xA=b;this.yA=c;this.nja();this.zba(c,b,this.ly);!this.ly.length&&this.SA||this.set("display")},eu:function(a){var b;if(this.zoom&&this.ao){var c=this.g.J.Ee(new w.G(a.Be(),a.Hd()));a=c.Be();c=c.Hd();a=this.ao.search([a-1,c-1,a+1,c+1]);a.length&&(b=a[0],b.PK=!1)}return b?[b]:[]},Ql:function(a){if(!a)return null;if("IMG"===a.tagName||"CANVAS"=== a.tagName||(a=w.Mh.mV(a))&&a.loaded)return a},$D:function(a,b){return a.zd===b.zd&&a.pe===b.pe&&a.yd===b.yd&&a.Sd===b.Sd},KJ:function(a,b){if("roadlabel"===a||"poilabel"===a)for(var c=0;c<b.length;c+=1){var d=b[c];if(d.Ub){var e="",g="",h="";d.Td&&(h=d.Td[0],e=h[3],g=h[4],h=d.Yi?"":h[7]);if(e=this.T.du&&this.T.du(e,g,h,d.Ub,d.Xq))d.visible=e[4],d.ik=e[3],d.ed=e[0];if(d.Td)for(g=0;g<d.Td.length;g+=1)h=d.Td[g],h[3]=e[0],h[4]=e[1],d.un&&(h[7]=e[2])}}}}); w.Ma.g0=w.Ma.eF.extend({ga:[w.vF],type:"road_poi_label_limg",B:function(a,b){arguments.callee.oa.apply(this,arguments);this.Ac=w.a.Jb(this);this.ak=!0}});w.Ma.h0=w.Ma.eF.extend({type:"road_poi_label",B:function(a,b){arguments.callee.oa.apply(this,arguments);this.Ac=w.a.Jb(this);a.g.J.vn&&this.Ax(a,b);this.ak=!1;this.wq=w.w.Pv.Oh;a.g.h("zoomend",this.Ri,this);a.g.h("moveend",this.Ri,this)}});w.Ma.eF.ob({hq:function(a,b){if(a){if(!this.vj||this.vj.M!==a||this.vj.Vl!==b){var c=[];this.vj&&c.push(this.vj.M);this.vj={M:a,Vl:b};c.push(a);this.qY(c)}}else this.aw()},aw:function(){this.vj=null},NB:function(){},SB:function(){if(this.vj){var a=[this.vj.M];this.vj=null;this.qY(a)}}});w.Ma.Rd.Kc=w.aa.extend({B:function(a){this.ej=a},ez:function(a,b){var c=document.createDocumentFragment(),d=b&&b.KK?null:{},e=!0,g;for(g in a)if(a.hasOwnProperty(g)){var h=a[g],k,l=h.get("params");if(h.ea)k=h.ea;else{k=w.j.create("div");k.className="amap-marker";var m=l.tg,n=l.jZ;m&&k.appendChild(m);n&&k.appendChild(n);h.ea=k;h.tg=m;if(n=l.title)m.title=n;this.q.Vk=!0;-1===w.a.indexOf(this.q.Lf,h)&&this.q.Lf.push(h);h.Yg=!0}var m=l.offset,n=m.x,p=m.y,q=l.textAlign,s=l.verticalAlign,m=!1;if("left"!== q||"top"!==s)if(k.parentNode!==this.ej&&d&&(m=!0,d[g]=h,e=!1),!m){var r=w.j.ey(h.tg),u=r[0],r=r[1];switch(q){case "center":n-=u/2;break;case "right":n-=u}switch(s){case "middle":p-=r/2;break;case "bottom":p-=r}}h.Yg?(s=[],q=h.Z.Oa,q=new w.G(q[0],q[1]),u=this.q.g.J.view.Ee(q,null,l.altitude),h.ra=this.ra,q=Math.round(u.y+p),u=Math.round(u.x+n),s.push("top:"+q+"px"),s.push("left:"+u+"px"),s.push("z-index:"+(l.JW?this.q.Nn+10:l.zIndex)),w.l.ae||s.push(w.j.NV(k,l.cC,{x:-n,y:-p})),s.push("display:"+(l.visible? "block":"none")+";"),k.style.cssText=s.join(";"),(n=l.label)&&n.content&&(l=l.NW,u=q=0,n.offset&&(q=n.offset.y+"px",u=n.offset.x+"px"),l.style.top=q,l.style.left=u,k.appendChild(l))):(q=h.Z.Oa,q=new w.G(q[0],q[1]),u=this.q.g.J.view.Ee(q,null,l.altitude),q=Math.round(u.y+p),u=Math.round(u.x+n),h.ra=this.ra,k.style.top=q+"px",k.style.left=u+"px");h.zoom=this.zoom;k.parentNode!==this.ej&&(w.l.bh&&w.a.iepngFix(k),c.appendChild(k),h.Yg=m);k.Qw=this.ej}this.ej.appendChild(c);e||this.ez(d,{KK:!0})},Ho:function(a){return[(a[0]- this.ra.x)/this.S,(a[1]-this.ra.y)/this.S]}});w.Ma.Rd.rj=w.Ma.qc.extend({B:function(a,b){this.aea=!0;arguments.callee.oa.apply(this,arguments);this.Ef()},nK:function(){return this.mb.MM},gi:function(){return this.yb},Ef:function(){this.yb=document.createElement("div");this.yb.className="amap-markers";this.mb=new w.Ma.Rd.Kc(this.yb);this.mb.q=this.q;this.T.K.appendChild(this.yb)},Kp:function(a,b,c){this.tu=c;this.ef=b.W.ef;this.S=b.W.S;this.zoom=b.W.zoom;this.size=b.size;this.Aa=b.W.Aa;this.zn=b.S;this.ib=b.W.gb;this.zh=b.W.zh;a=!1;if(!this.ra|| 3E4<Math.abs(this.ib.x-this.ra.x)/this.S||3E4<Math.abs(this.ib.y-this.ra.y)/this.S)a=!0;if(a||this.zoom<<0!==this.zoom||this.re!==this.zoom)this.ra=this.ib,this.re=this.zoom},rr:function(a){a=a.W.Aa.path;for(var b=a.length,c,d,e,g,h=0;h<b;h++)0===h?(c=a[h][0],e=a[h][0],d=a[h][1],g=a[h][1]):(a[h][0]<c&&(c=a[h][0]),a[h][0]>e&&(e=a[h][0]),a[h][1]<d&&(d=a[h][1]),a[h][1]>g&&(g=a[h][1]));return[c,d,e,g]},Tr:function(){if(this.Bg&&this.Bg)for(var a in this.Bg)if(this.Bg.hasOwnProperty(a)){var b=this.Bg[a]; b.Pc!==this.Pc&&b.ea&&this.T.wj.appendChild(b.ea)}},kc:function(a,b,c){this.Pc=1E6*Math.random()<<0;this.Kp(a,b,c);this.W=b.W;this.size=b.size;var d=this.q;this.ee=256;var e;this.Fea=d=d.Ui(this.rr(b));for(e in d)d.hasOwnProperty(e)&&(d[e].Pc=this.Pc,d[e].UW=this);this.Tr(d);this.Kp.call(this.mb,a,b,c);this.mb.ez(d);this.Bg=d;this.Qe(b)},Qe:function(){var a=Math.pow(2,this.zoom-this.ce);this.transform={translate:this.ra.Ua(this.ib).wc(this.S),scale:a,rotate:0}},kr:function(a,b){var c=this.q,d=this.Fea, e=[];if(d&&a){var g=this.q.g.J.view.Ee(a);if(c.Vk){for(var h=c.Lf,k=!0,l=[],m=0;m<h.length;m+=1){var n=h[m].tg;if(n)if(n.parentNode&&n.parentNode.parentNode&&this.T&&n.parentNode.parentNode!==this.T.wj&&"none"!==n.parentNode.style.display){var p=n.clientWidth,q=n.clientHeight;n.childNodes[0]&&(p=p||n.childNodes[0].clientWidth,q=q||n.childNodes[0].clientHeight);window.opera&&(p=Math.max(p,n.childNodes[0].scrollWidth),q=Math.max(q,n.childNodes[0].scrollHeight));p&&q?(n=Math.max(Math.abs(h[m].get("offset").x), Math.abs(h[m].get("offset").y))+Math.max(p,q),c.Ge=Math.max(c.Ge,n),c.df=Math.max(c.df,n),h[m].width=p,h[m].height=q):(k=!1,l.push(h[m]))}else k=!1,l.push(h[m])}k?(c.Vk=!1,c.Lf=[]):c.Lf=l}for(var s in d)if(d.hasOwnProperty(s)&&(h=function(a,b){var c=Math.round(a.x+t),d=Math.round(a.x+t+v),e=Math.round(a.y+y+x),g=Math.round(a.y+y),h=Math.round(b.x),k=Math.round(b.y);return h<=d&&h>=c&&k<=e&&k>=g?!0:!1},k=d[s],m=k.Z)){l=k.get("params");m=m.Oa;m=new w.G(m[0],m[1]);m=this.q.g.J.view.Ee(m,null,l.altitude); if(n=l.cC%360){var p=g.x-m.x,q=g.y-m.y,r=Math.PI*n/180,n=Math.cos(-r),r=Math.sin(-r),u=p*r+q*n;g.x=m.x+(p*n-q*r);g.y=m.y+u}var v=k.width,x=k.height,t=l.offset.x,y=l.offset.y,p=l.verticalAlign;switch(l.textAlign){case "center":t-=v/2;break;case "right":t-=v}switch(p){case "middle":y-=x/2;break;case "bottom":y-=x}p=!1;l.shape?(g.x-=t,g.y-=y,p=this.xy(k,g,m)):p=h(m,g);p&&e.push(k)}e.sort(function(a,b){return a.get("isTop")?-1:b.get("isTop")?1:a.get("zIndex")>b.get("zIndex")||a.get("zIndex")===b.get("zIndex")&& a.Tj>b.Tj?-1:1});b(e,c)}else b([],c)},xy:function(a,b,c){a=a.get("params").shape;if("circle"===a.F.type){var d=c.x+a.F.coords[0];c=c.y+a.F.coords[1];if(Math.sqrt((b.x-d)*(b.x-d)+(b.y-c)*(b.y-c))<=a.F.coords[2])return!0}else{if("poly"===a.F.type)return b=[b.x,b.y],a=a.F.coords,a=this.rC(a),w.Qc.nd(b,a);if("rect"===a.F.type){a=a.F.coords;c=a[0];var d=a[1],e=a[3],g=b.x;b=b.y;if(g<a[2]&&g>c&&b>e&&b<d)return!0}}return!1}});w.Ma.N0=w.Ma.Hv.extend({type:"traffic",nj:"\\n    precision highp float;\\n    attribute vec4 a_Position;\\n    attribute vec3 a_Op, a_Pre, a_Next;\\n    \\n    uniform float u_Scale;\\n    uniform float u_Width;\\n\\n    uniform mat4 u_modelViewMatrix,u_projectionMatrix;\\n\\n    void main() {\\n      vec4 position = a_Position;\\n\\n      vec3 dir, preDir, nextDir;\\n      vec3 curCoord = position.xyz;\\n      vec3 preCoord = a_Pre.xyz;\\n      vec3 nextCoord = a_Next.xyz;\\n\\n      if (curCoord == preCoord) {\\n        dir = normalize(nextCoord - curCoord);\\n      } else if (curCoord == nextCoord) {\\n        dir = normalize(curCoord - preCoord);\\n      } else {\\n        preDir = normalize(preCoord - curCoord);\\n        nextDir = normalize(nextCoord - curCoord);\\n\\n        if (preDir == -nextDir) {\\n          dir = nextDir; \\n        } else {\\n          dir = normalize(-preDir + nextDir); \\n\\n          float cosA = dot(dir, -preDir);\\n\\n          if (cosA > sqrt(3.0) / 2.0) {\\n            cosA = sqrt(3.0) / 2.0; \\n          }\\n\\n          dir = dir / cosA;\\n        }\\n      }\\n\\n      if (a_Op.z > 0.0) {\\n        position.x = position.x - dir.y * u_Width;\\n        position.y = position.y + dir.x * u_Width;\\n      } else {\\n        position.x = position.x + dir.y * u_Width;\\n        position.y = position.y - dir.x * u_Width;\\n      }\\n\\n      gl_Position=u_projectionMatrix*u_modelViewMatrix*position;\\n    }\\n  ", me:"\\n    precision lowp float;\\n    uniform vec4 v_Color;\\n\\n    void main() {\\n      gl_FragColor=v_Color;\\n    }\\n  ",B:function(a,b){this.SM=300;this.yh=!0;arguments.callee.oa.apply(this,arguments);this.Ni=20;this.kb=this.q.kb},Kh:function(a,b){b.mf=a.getAttribLocation(b,"a_Position");b.xh=a.getAttribLocation(b,"a_Next");b.CT=a.getAttribLocation(b,"a_Pre");b.tI=a.getAttribLocation(b,"a_Op");b.Mp=a.getUniformLocation(b,"v_Color");b.Mia=a.getUniformLocation(b,"u_Scale");b.Dz=a.getUniformLocation(b, "u_Width")},Wj:function(){return Math.pow(2,this.zoom-this.Ni)*(this.q.ja?this.kb:1)},al:function(a){for(var b=a.length-1;0<=b;b-=1){var c=a[b];if(c.length){var d=function(){var a=c.length;return function(){--a}}();this.es(c);this.wn+=c.length;for(var e=c.length-1;0<=e;e-=1)this.aj(c[e],this.Yj,d)}}},aj:function(a){var b=a.ma;this.wa.Fc(a.key)||(this.wa.set(a.key,a),a.status="loading");var c=this.q.Tl(b.x,b.y,b.z),c=new w.Sa.fb(c,{callback:"callback"});c.h("complete",function(c){var e=this;this.q&& (a.Ba=c.data?c.data[w.a.LC(b.x,b.y,b.z).join("_")]:[],this.Er+=1,w.WE.aga({nc:a.ma.z,Uc:[a],Y:this.q.get("forceBig")||w.l.Y,kb:this.q.get("forceBig")?1:this.kb,qd:this.q.get("forceBig")?!1:this.q.ja},function(a,b){b.data.Uc.forEach(function(a){e.Hia(a.Ba);a.status="loaded";a.qa=!0;e.wa.set(a.key,a)});e.set("display")}))},this);c.h("error",function(){a.status=null},this)},ld:function(){this.Er>=this.wn&&(this.q.ta||(this.q.ta=!0),this.q.cd?this.q.ia("renderComplete"):(this.q.cd=!0,this.q.ia("complete")))}, kc:function(a,b,c){arguments.callee.oa.apply(this,arguments);this.Pa=a;this.mm(b,c);if(this.lj.length&&this.lj[0].length){var d=this.lj[0].filter(function(a){return"loaded"===a.status});d.length&&this.vp(a,d)}this.ld()},Hia:function(a){var b=this,c=this.T.Pa;a.forEach(function(a){a&&a[0].length&&a[1].length&&(a.Kf=a[1].length,a[0]=b.Di(c.ARRAY_BUFFER,a[0]),a[1]=b.Di(c.ELEMENT_ARRAY_BUFFER,a[1]))})},Di:function(a,b){if(b.length){var c=this.T.Pa,d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,b, c.STATIC_DRAW);return d}},vp:function(a,b){var c=this;if(b.length){var d=this.ab;a.useProgram(d);a.enableVertexAttribArray(d.mf);a.enableVertexAttribArray(d.tI);a.enableVertexAttribArray(d.CT);a.enableVertexAttribArray(d.xh);b.forEach(function(b){return c.Lba(a,b.Ba)})}},DC:function(a){var b=this;a.Ba&&a.Ba.forEach(function(a){b.T.Pa.deleteBuffer(a[0]);a[0]=null;b.T.Pa.deleteBuffer(a[1]);a[1]=null;a[2]=null})},Lba:function(a,b){var c=this,d=this.ab;b.forEach(function(b){if(0<b.Kf){var g=b[2].borderColor, h=b[2].width;g&&(a.bindBuffer(a.ARRAY_BUFFER,b[0]),a.uniform1f(d.Mia,c.Wj()),a.uniform1f(d.Dz,h/c.Wj()/2),a.uniform4fv(d.Mp,g),a.vertexAttribPointer(d.mf,2,a.FLOAT,!1,36,0),a.vertexAttribPointer(d.tI,3,a.FLOAT,!1,36,8),a.vertexAttribPointer(d.CT,2,a.FLOAT,!1,36,20),a.vertexAttribPointer(d.xh,2,a.FLOAT,!1,36,28),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b[1]),a.drawElements(a.TRIANGLES,b.Kf,a.UNSIGNED_SHORT,0))}})}});w.Ma.rj=w.Ma.qc.extend({type:"vector",nj:"\\n    precision highp float;\\n\\n    attribute highp vec4 a_Position;\\n    attribute vec4 v_PositionDir;\\n    attribute vec3 v_Props;\\n\\n    uniform vec2 u_DeltaPos;\\n    uniform highp float u_Width;\\n    uniform lowp int u_Type;\\n\\n    varying highp float v_Distance;\\n    varying float v_Render;\\n    uniform highp vec2 u_radius;\\n\\n    uniform mat4 u_modelViewMatrix,u_projectionMatrix;\\n\\n    void main() {\\n      highp vec4 position = vec4(a_Position.xy, 0, 1);\\n\\n      if (u_Type == 1 || u_Type == 5) {\\n        v_Distance = v_Props.x + u_Width * v_Props.y;\\n        v_Render = v_Props.z;\\n        float dis = sqrt(v_PositionDir.x*v_PositionDir.x+v_PositionDir.y*v_PositionDir.y);\\n        float x = v_PositionDir.x;\\n        float y = v_PositionDir.y;\\n        if(v_PositionDir.z==0.0&&v_PositionDir.w==0.0&&dis>4.0){\\n            x = v_PositionDir.x/dis*4.0;\\n            y = v_PositionDir.y/dis*4.0;\\n        }\\n        position.x = (position.x + u_Width * x) + u_Width * v_PositionDir.z;\\n        position.y = (position.y + u_Width * y) + u_Width * v_PositionDir.w;\\n      }\\n\\n      gl_Position=u_projectionMatrix*u_modelViewMatrix*(position + vec4(u_DeltaPos.xy, 0, 0));\\n      gl_PointSize = (2.0*u_radius.x+2.0);\\n    }\\n  ", me:"\\n    precision highp float;\\n\\n    uniform vec4 v_Color;\\n    uniform vec4 u_ColorBorder;\\n    uniform vec3 u_Dash;\\n    // 2-[10, 10] 3-[10, 2, 10]\\n    uniform float u_DashType;\\n\\n    varying highp float v_Distance;\\n    varying float v_Render;\\n\\n    uniform lowp int u_Type;\\n\\n    uniform highp vec2 u_radius;\\n\\n    void main() {\\n      if (u_Type == 1 || u_Type == 5) {\\n        if (u_DashType == 2.0) {\\n          if (u_Dash[0] != 0.0 && u_Dash[1] != 0.0) {\\n            float all = u_Dash[0] + u_Dash[1];\\n            float off = mod(v_Distance, all);\\n\\n            if (off > u_Dash[0] && off <= all) {\\n              discard;\\n            }\\n          } \\n        } else if(u_DashType == 3.0) {\\n          if (u_Dash[0] != 0.0 && u_Dash[1] != 0.0 && u_Dash[2] != 0.0) {\\n            float all = u_Dash[0] * 2.0 + u_Dash[1] * 2.0 + u_Dash[2] * 2.0;  \\n            float off = mod(v_Distance, all);\\n\\n            vec3 solidBound = vec3(u_Dash[0], u_Dash[0] + u_Dash[1] + u_Dash[2], u_Dash[0] * 2.0 + u_Dash[1] * 2.0 + u_Dash[2]);\\n            vec3 dashBound = vec3(solidBound.x + u_Dash[1], solidBound.y + u_Dash[0], solidBound.z + u_Dash[2]);\\n\\n            if (off > solidBound.x && off <= dashBound.x \\n             || off > solidBound.y && off <= dashBound.y\\n             || off > solidBound.z && off <= dashBound.z) {\\n                discard; \\n             }\\n          } \\n        }\\n\\n        if (v_Render < 0.0) {\\n          discard; \\n        }\\n      }\\n      if(u_Type==6){\\n        float dis2center = distance(gl_PointCoord,vec2(0.5,0.5));\\n        float dis2border = dis2center*(u_radius.x+1.0)*2.0;\\n        if(dis2border<=u_radius.y-0.5){\\n          gl_FragColor=v_Color;\\n        }else if(dis2border<u_radius.x-0.5){\\n          if(dis2border<u_radius.y+0.5){\\n            float fac = 0.5-dis2border+u_radius.y;\\n            gl_FragColor = fac*v_Color+(1.0-fac)*u_ColorBorder;\\n          }else{\\n            gl_FragColor=u_ColorBorder;\\n          }\\n        }else {\\n          if(dis2border<=u_radius.x+0.5){\\n            gl_FragColor = u_ColorBorder;\\n            gl_FragColor.a *= 0.5-dis2border+u_radius.x;\\n          }else{\\n            discard;\\n          }       \\n        }\\n      }else\\n      gl_FragColor=v_Color;\\n    }\\n  ", el:[215440491,106744817],Wj:function(){return Math.pow(2,this.zoom-this.Ni)*(this.T.ja?this.kb:1)},ur:function(a,b){a=w.a.uC(a);var c;"#"==a[0]?(a=a.substring(1),3==a.length&&(a=a.replace(/./g,function(a){return a+a})),c=w.a.Zf(8==a.length?a:"ff"+a)):c=a;c=c.match(/rgba?\\((.+)\\)/)[1].split(",").slice(0,3).map(function(a){return a/255});void 0===b&&(b=1);return c.concat(b)},Kh:function(a,b){b.ol=a.getAttribLocation(b,"a_Position");b.sv=a.getAttribLocation(b,"v_PositionDir");b.uv=a.getAttribLocation(b, "v_Props");b.tI=a.getAttribLocation(b,"a_Op");b.Mp=a.getUniformLocation(b,"v_Color");b.Lia=a.getUniformLocation(b,"u_ColorBorder");b.Cz=a.getUniformLocation(b,"u_Type");b.aja=a.getUniformLocation(b,"u_radius");b.HE=a.getUniformLocation(b,"u_Dash");b.Bz=a.getUniformLocation(b,"u_DashType");b.lv=a.getUniformLocation(b,"u_DeltaPos");b.Dz=a.getUniformLocation(b,"u_Width");this.Hu=this.St=this.tn=void 0;this.qk=0},Qla:function(){},i3:function(a){var b=this.Pa,c=this.ab;b.useProgram(c);b.disableVertexAttribArray(c.ol); b.disableVertexAttribArray(c.sv);b.disableVertexAttribArray(c.uv);b.uniform2fv(c.lv,[0,0]);b.uniform1f(c.Bz,0);b.disable(b.DEPTH_TEST);b.enable(b.BLEND);b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);a()},MU:function(){"function"===typeof this.Zt[this.Rj[0]]?this.Zq(this.Rj[0],this.Zt[this.Rj[0]]):this.Rj.shift()},Zq:function(a,b,c){this.Rj.length&&(this.Rj[0]===a?(this.i3(b),c||this.Rj.shift(),"function"===typeof this.Zt[this.Rj[0]]&&this.Zq(this.Rj[0],this.Zt[this.Rj[0]])): this.Zt[a]=b)},zp:256*Math.pow(2,20),B:function(a,b){this.yh=!0;arguments.callee.oa.apply(this,arguments);this.Ni=20;this.kb=this.q.kb;this.Rj=[];this.Zt={};this.Op=0},rr:function(a){a=a.W.Aa.path;for(var b=a.length,c,d,e,g,h=0;h<b;h++)0===h?(c=a[h][0],e=a[h][0],d=a[h][1],g=a[h][1]):(a[h][0]<c&&(c=a[h][0]),a[h][0]>e&&(e=a[h][0]),a[h][1]<d&&(d=a[h][1]),a[h][1]>g&&(g=a[h][1]));return[c,d,e,g]},kc:function(a,b,c){var d=this;arguments.callee.oa.apply(this,arguments);this.Pa=a;this.Op++;a.cullFace(a.BACK); this.Rj.length=0;this.Zt={};this.W=b.W;this.S=this.W.S;this.zoom=b.W.zoom;if(this.q.fi&&this.q.fi.rn.length){var e=this.q.fi.rn.filter(function(a){return!!a});this.q.rK(e).forEach(function(a){d.Wga(a[0],null)})}a.disableVertexAttribArray(this.ab.ol);a.disableVertexAttribArray(this.ab.sv);a.disableVertexAttribArray(this.ab.uv)},Wga:function(a){for(var b=0,c=a.length;b<c;b+=1){var d=a[b];if(d.get("visible")){var e=d.name.split("-")[0],e="render"+e.slice(0,1).toUpperCase()+e.slice(1);this.Rj.push(d._amap_id); if("function"===typeof this[e])this[e](d)}}},renderPolygon:function(a){function b(b,h){var l="number"===typeof k.strokeWeight;0>=k.strokeWeight&&(k.strokeWeight=1);c.Zq(a._amap_id,function(){e.bindBuffer(e.ARRAY_BUFFER,b[0]);e.vertexAttribPointer(d.ol,2,e.FLOAT,!1,0,0);e.enableVertexAttribArray(d.ol);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b[1]);e.uniform1i(d.Cz,2);e.uniform4fv(d.Mp,m);a.get("deltaPos")&&e.uniform2fv(d.lv,a.get("deltaPos"));e.drawElements(e.TRIANGLES,b.Kf,e.UNSIGNED_SHORT,0);l&&c.CY(h.Oa, k,h,a,g)})}var c=this,d=this.ab,e=this.Pa,g=this.Op,h=[],k=a.style,l=a.Z;l instanceof w.pa.dc?h=[l]:l instanceof w.pa.Gs&&(h=l.Ze);e.enable(e.BLEND);var m=this.ur(k.fillColor,k.fillOpacity);h.forEach(function(a){a.Of.forEach(function(a){if(a.Ba)b(a.Ba,a);else{var d=a.Oa;w.s_.TX({nc:c.g.get("zoom"),Nr:w.a.vb(d),qd:c.q.get("forceBig")?!1:!!c.q.ja},function(d,h){if(c.Op===g){var k=h.data;k.Kf=k[1].length;k[0]=c.Di(e.ARRAY_BUFFER,k[0]);k[1]=c.Di(e.ELEMENT_ARRAY_BUFFER,k[1]);a.Ba=k;b(a.Ba,a)}})}})})}, renderPolyline:function(a){function b(b){c.Zq(a._amap_id,function(){function g(){b.f5?w.a.Pb(b,function(a){return h(a)}):h(b)}function h(a){e.bindBuffer(e.ARRAY_BUFFER,a[0]);e.vertexAttribPointer(d.ol,2,e.FLOAT,!1,36,0);e.vertexAttribPointer(d.sv,4,e.FLOAT,!1,36,8);e.vertexAttribPointer(d.uv,3,e.FLOAT,!1,36,24);e.enableVertexAttribArray(d.ol);e.enableVertexAttribArray(d.sv);e.enableVertexAttribArray(d.uv);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a[1]);e.drawElements(e.TRIANGLES,a.Kf,e.UNSIGNED_SHORT,0)} a.get("deltaPos")&&e.uniform2fv(d.lv,a.get("deltaPos"));"dashed"===k.strokeStyle&&2<=k.strokeDasharray.length&&(2==k.strokeDasharray.length?(e.uniform1f(d.Bz,2),e.uniform3fv(d.HE,k.strokeDasharray.map(function(a){return a/c.Wj()}).concat(0))):(k.strokeDasharray=k.strokeDasharray.slice(0,3),e.uniform1f(d.Bz,3),e.uniform3fv(d.HE,k.strokeDasharray.map(function(a){return a/c.Wj()}))));e.uniform1i(d.Cz,1);k.isOutline&&(1>k.borderWeight&&(k.borderWeight=1),e.uniform1f(d.Dz,(k.strokeWeight+2*k.borderWeight)/ c.Wj()/2*c.kb),e.uniform4fv(d.Mp,c.ur(k.outlineColor,k.strokeOpacity)),g());e.uniform1f(d.Dz,k.strokeWeight/c.Wj()/2*c.kb);e.uniform4fv(d.Mp,c.ur(k.strokeColor,k.strokeOpacity));g()})}var c=this,d=this.ab,e=this.Pa,g=this.Op,h=[],k=a.style,l=a.Z;if(k.strokeColor){1>k.strokeWeight&&(k.strokeWeight=1);var m=k.lineJoin||"miter";l instanceof w.pa.Yn?h=[l]:l instanceof w.pa.Lv&&(h=l.Ze);h.forEach(function(a){a.Ba?b(a.Ba):w.uN.parse({Nr:w.a.vb(a.Oa),lineJoin:m,lineCap:k.lineCap||"butt",tn:"dashed"===k.strokeStyle}, function(d,h){if(c.Op===g){var k=h.data;k.Kf=k[1].length;if(65535<k.Kf){var l=Math.ceil(k.Kf/65535);k.count=l;k.xE=[];for(var m=0;m<l;m++){k.xE[m]=[[],[]];k.xE[m][1]=k[1].slice(65535*m,65535*(m+1));var v=k.xE[m],x=Math.min.apply(null,v[1]),t=Math.max.apply(null,v[1]);v[0]=k[0].slice(9*x,9*(t+1));for(var t=0,y=v[1].length;t<y;t++)v[1][t]-=x;v[1]instanceof Uint32Array&&(v[1]=new Uint16Array(v[1]));v.Kf=v[1].length;v[0]=c.Di(e.ARRAY_BUFFER,v[0]);v[1]=c.Di(e.ELEMENT_ARRAY_BUFFER,v[1])}a.Ba=k.xE;a.Ba.f5= !0}else k[0]=c.Di(e.ARRAY_BUFFER,k[0]),k[1]=c.Di(e.ELEMENT_ARRAY_BUFFER,k[1]),a.Ba=k;b(a.Ba)}})})}else this.MU()},Di:function(a,b){if(b.length){var c=this.T.Pa,d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,b,c.STATIC_DRAW);return d}},Uga:function(a){function b(b,g){c.Zq(a._amap_id,function(){0>=g.strokeWeight&&(g.strokeWeight=0);e.enable(e.BLEND);e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);e.vertexAttrib4f(d.ol,b[0],b[1],b[2],1);e.uniform1i(d.Cz,6);e.uniform2f(d.aja, g.radius+g.strokeWeight,g.radius);var c=h.fillColor,k=c;g.strokeWeight&&(k=h.strokeColor);e.uniform4fv(d.Lia,k);e.uniform4fv(d.Mp,c);e.uniform2fv(d.lv,a.get("deltaPos")||[0,0]);e.drawArrays(e.POINTS,0,1)})}var c=this,d=this.ab,e=this.Pa,g=a.style,h=a.Z,k=h;if(k.Ba)b(k.Ba,g);else{var l=k.Oa,l=[l[0]-w.a.fc.x,l[1]-w.a.fc.y,0];k.Ba=l;k.fillColor=c.ur(g.fillColor,g.fillOpacity);k.strokeColor=c.ur(g.strokeColor,g.strokeOpacity);b(l,g)}},renderCircle:function(a){function b(b,g,h,k){0>=g.strokeWeight&&(g.strokeWeight= 0);c.Zq(a._amap_id,function(){e.bindBuffer(e.ARRAY_BUFFER,b[0]);e.vertexAttribPointer(d.ol,2,e.FLOAT,!1,0,0);e.enableVertexAttribArray(d.ol);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b[1]);e.uniform1i(d.Cz,3);e.uniform4fv(d.Mp,c.ur(g.fillColor,g.fillOpacity));a.get("deltaPos")&&e.uniform2fv(d.lv,a.get("deltaPos"));e.drawElements(e.TRIANGLES,b.Kf,e.UNSIGNED_SHORT,0);c.CY(c.Xca(h),g,k,a,l)})}if(a.zr)this.Uga(a);else{var c=this,d=this.ab,e=this.Pa,g=[],h=a.style,k=a.Z,l=this.Op;k instanceof w.pa.Tf&&(g=[k]); g.forEach(function(d){if(d.Ba)b(d.Ba,h,d.o_,d);else{var g=d.Oa,k=c.g.J.qe({x:g[0],y:g[1]});w.s_.PX({ib:g.map(function(a,b){return a-c.el[b]}),hj:a.get("radius")/c.g.J.getResolution(k,20)},function(a,g){if(c.Op===l){var k=g.data;k.Kf=k[1].length;var n=w.a.vb(k[0]).slice(2);k[0]=c.Di(e.ARRAY_BUFFER,new Float32Array(k[0]));k[1]=c.Di(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(k[1]));d.Ba=k;d.o_=n;b(k,h,n,d)}})}})}},Xca:function(a){var b=this,c=[];a.forEach(function(a,e){var g=Math.floor(e/2);void 0===c[g]? c[g]=[a+b.el[0]]:c[g][1]=a+b.el[1]});return c},CY:function(a,b,c,d,e){function g(a){h.Zq(d._amap_id,function(){k.bindBuffer(k.ARRAY_BUFFER,a[0]);k.vertexAttribPointer(l.ol,2,k.FLOAT,!1,36,0);k.vertexAttribPointer(l.sv,4,k.FLOAT,!1,36,8);k.vertexAttribPointer(l.uv,3,k.FLOAT,!1,36,24);k.enableVertexAttribArray(l.ol);k.enableVertexAttribArray(l.sv);k.enableVertexAttribArray(l.uv);k.uniform1i(l.Cz,5);"dashed"==b.strokeStyle&&2<=b.strokeDasharray.length&&(2==b.strokeDasharray.length?(k.uniform1f(l.Bz, 2),k.uniform3fv(l.HE,b.strokeDasharray.map(function(a){return a/h.Wj()}).concat(0))):(b.strokeDasharray=b.strokeDasharray.slice(0,3),k.uniform1f(l.Bz,3),k.uniform3fv(l.HE,b.strokeDasharray.map(function(a){return a/h.Wj()}))));m&&k.uniform2fv(l.lv,m);k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,a[1]);k.uniform1f(l.Dz,b.strokeWeight/h.Wj()/2*h.kb);k.uniform4fv(l.Mp,h.ur(b.strokeColor,b.strokeOpacity));k.drawElements(k.TRIANGLES,a.Kf,k.UNSIGNED_SHORT,0)})}var h=this,k=this.Pa,l=this.ab,m=d.get("deltaPos");c.Tt? g(c.Tt):a.length?w.uN.parse({Nr:w.a.vb(a),Zda:!0},function(a,b){if(h.Op===e){var d=b.data;d.Kf=d[1].length;d[0]=h.Di(k.ARRAY_BUFFER,d[0]);d[1]=h.Di(k.ELEMENT_ARRAY_BUFFER,d[1]);c.Tt=d;g(c.Tt)}}):this.MU()}});w.Ma.o0=w.Ma.rj.extend({type:"massVector",BI:1,QM:[1,0,1,1,0,0,1,1,0,1,0,0],nj:"precision mediump float;attribute highp vec4 a_Position;varying vec4 v_texcoord;uniform vec2 u_texVertices[6];uniform highp mat4 u_modelViewMatrix;uniform highp mat4 u_projectionMatrix;uniform mat4 u_textureMatrix;void main(void) { int pointIdx = int(a_Position.z);  v_texcoord = vec4((u_textureMatrix * vec4(u_texVertices[pointIdx].xy, 0.0, 1.0))); vec4 pos =  vec4(a_Position.xy, 0.0, 1.0); gl_Position = u_projectionMatrix * u_modelViewMatrix * pos;}", me:"precision mediump float;uniform sampler2D texture;varying vec4 v_texcoord;void main(void) { gl_FragColor =  texture2D(texture, v_texcoord.xy);}",Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position");b.Ap=a.getUniformLocation(b,"texture");b.kN=a.getUniformLocation(b,"u_texVertices");b.lN=a.getUniformLocation(b,"u_textureMatrix")},B:function(a,b){arguments.callee.oa.apply(this,arguments);this.Ac=w.a.Jb(this);this.bo=b.Pa.createBuffer();this.Da={}},kc:function(a,b,c){arguments.callee.oa.oa.apply(this, arguments);this.W=b.W;this.S=this.W.S;this.zoom=b.W.zoom;var d=this.q.Ui(this.rr(b)),e=[],g;for(g in d)d.hasOwnProperty(g)&&e.push(d[g]);this.gM(e)},gM:function(a){var b={},c=this.q.get("style");a.forEach(function(a){var d=c;d instanceof Array&&(d="number"===typeof a.Ra.style&&d[a.Ra.style]?d[a.Ra.style]:d[0]);b[d.url]||(b[d.url]={style:d,list:[]});b[d.url].list.push(a)});this.v8();for(var d in b)b.hasOwnProperty(d)&&this.Xga(b[d].style,b[d].list);this.u8()},v8:function(){var a=this.ab,b=this.T.Pa; b.enable(b.BLEND);b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);b.enableVertexAttribArray(a.ud);b.uniform2fv(a.kN,this.QM)},u8:function(){var a=this.T.Pa;a.disableVertexAttribArray(this.ab.ud);a.disable(a.BLEND)},Xga:function(a,b){var c=this.Ql(a.url);if(!c)return!1;c.Rm&&c.Rm.Ac===this.Ac||(c.Rm=this.KI(c),c.Rm.Ac=this.Ac);for(var d=a.size.width,e=a.size.height,g=a.anchor.x,h=a.anchor.y,k=[],l=0,m=b.length;l<m;l++){var n=b[l].Z.Oa,p=this.S,n=[n[0]-g*p,n[1]-h* p];k.push(this.hI([n[0],n[1],n[0]+d*p,n[1]+e*p]))}this.k3(c.Rm,k);return!0},k3:function(a,b){var c=this.ab,d=this.T.Pa;d.disable(d.DEPTH_TEST);d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,a.lc);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);var e=this.aD(a.width,a.height,[0,0,a.width,a.height]);d.uniformMatrix4fv(c.lN,!1,e.elements);this.NF(d,b,this.bo);d.vertexAttribPointer(c.ud,4,d.FLOAT,!1,0,0);d.drawArrays(d.TRIANGLES, 0,6*b.length)},aD:function(a,b,c){var d=c[0],e=c[1],g=c[2]-d;c=c[3]-e;var h=new w.ge;h.as(1/a,1/b,1);h.translate(d,e,0);h.scale(g,c,1);return h},KI:function(a){var b=this.T.Pa,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);return{width:a.width,height:a.height, lc:c,fv:this.BI++}},hI:function(a){var b=w.a.fc,c=b.x,b=b.y;return[a[0]-c,a[1]-b,a[2]-c,a[3]-b]},NF:function(a,b,c){for(var d=[],e=0,g=b.length;e<g;e++){var h=b[e],k=h[0],l=h[1],m=h[2],h=h[3];d.push.apply(d,[m,l,0,e,m,h,1,e,k,l,2,e,m,h,3,e,k,h,4,e,k,l,5,e])}a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW);return c},Ql:function(a){var b=this.Da[a];if("undefined"===typeof b)b=document.createElement("img"),b.crossOrigin="Anonymous",b.src=a,this.Da[a]=b,b.loaded= !1,w.C.dk(b,"load",function(){b.loaded=!0;var a=document.createElement("canvas");a.width=b.naturalWidth;a.height=b.naturalHeight;a.getContext("2d").drawImage(b,0,0);b.canvas=a;this.set("display")},this);else if(b.loaded)return b.canvas||b}});w.Ma.Qz=w.Ma.qc.extend({type:"imagelayer",nj:"precision highp float;attribute vec3 a_Position;attribute vec2 uv;uniform mat4 u_modelViewMatrix;uniform mat4 u_projectionMatrix;varying vec2 vTextureCoord;void main(void) {\\tvTextureCoord = uv;\\tvec4 pos = u_projectionMatrix*u_modelViewMatrix * vec4(a_Position,1.0);\\tgl_Position = pos;}",me:"precision mediump float;uniform sampler2D texture;varying vec2 vTextureCoord;uniform float alpha;void main(void) {\\tvec4 smpColor = texture2D(texture, vTextureCoord);\\tgl_FragColor =  vec4(smpColor.xyz, alpha*smpColor.a);}", Kh:function(a,b){b.ud=a.getAttribLocation(b,"a_Position");b.rN=a.getAttribLocation(b,"uv");b.Ap=a.getUniformLocation(b,"texture");b.t$=a.getUniformLocation(b,"alpha")},B:function(a,b){this.yh=!0;arguments.callee.oa.apply(this,arguments);this.X("display",this.g);this.Ov=this.Nv=1},rja:function(a){var b=this.T.Pa;a=a.H;a[0]-=w.a.fc.x;a[1]-=w.a.fc.y;a[2]-=w.a.fc.x;a[3]-=w.a.fc.y;if(6===a.length){var c=-a[5],d=-a[4]-a[5];a=[a[0],a[1],d,a[2],a[3],c,a[0],a[1],c,a[0],a[1],d,a[2],a[3],d,a[2],a[3],c]}else a= [a[0],a[1],0,a[2],a[3],0,a[0],a[3],0,a[0],a[1],0,a[2],a[1],0,a[2],a[3],0];c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);this.wi=c;a=[0,0,this.Nv,this.Ov,0,this.Ov,0,0,this.Nv,0,this.Nv,this.Ov];c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);this.xja=c},tV:function(a){for(var b=2;b<a;)b*=2;return b},ld:function(){var a=this.q;a.ta||(a.ta=!0,a.cd?a.ia("renderComplete"): (a.cd=!0,a.ia("complete")))},wea:function(a){function b(a){var b=a.target;"AMap.VideoLayer"===c.q.fa.CLASS_NAME&&(b.ontimeupdate=function(){0!==b.currentTime&&(c.l_(),c.set("display"))});"AMap.CanvasLayer"!==c.q.fa.CLASS_NAME&&c.set("display");!c.q.ta&&c.q&&(c.q.ta=!0,c.q.cd?c.q.ia("renderComplete"):(c.q.cd=!0,c.q.ia("complete")));c.q.rz=!0;c.lc.loaded=!0}var c=this;switch(this.q.fa.CLASS_NAME){case "AMap.GroundImage":case "AMap.ImageLayer":this.Ib||(this.Ib=document.createElement("img"));this.Ib.crossOrigin= "anonymous";this.Ib.onload=this.Ib.onerror=b;this.Ib.src=a;break;case "AMap.CanvasLayer":this.Ib=a;b({target:a});break;case "AMap.VideoLayer":if(!this.Ib){var d=document.createElement("video");d.controls="controls";this.Ib=d}w.j.bz(this.Ib);this.Ib.loop=this.q.fa.get("loop");this.Ib.autoplay=this.q.fa.get("autoplay");this.Ib.crossOrigin="anonymous";this.Ib.onloadeddata=this.Ib.onerror=b;if(a instanceof Array)for(d=0;d<a.length;d+=1){var e=document.createElement("source");e.src=a[d];this.Ib.appendChild(e)}else e= document.createElement("source"),e.src=a,this.Ib.appendChild(e)}},Eu:function(){this.lc&&(this.Ib.ontimeupdate=null,this.T.Pa.deleteTexture(this.lc),this.T.Pa.deleteBuffer(this.wi),this.Ib=null)},l_:function(){var a=this.Ib,b=this.T.Pa,c=a.width,d=a.height;"AMap.VideoLayer"===this.q.fa.CLASS_NAME&&(c=a.videoWidth,d=a.videoHeight);if(!(2>c&&2>d)){this.Ov=this.Nv=1;if(this.T.vD(c)&&this.T.vD(d))this.canvas=null;else{var e=this.tV(c),g=this.tV(d),h=this.canvas||document.createElement("canvas");this.canvas= h;h.width=e;h.height=g;h.getContext("2d").drawImage(a,0,0,c,d);this.Nv=c/e;this.Ov=d/g}b.bindTexture(b.TEXTURE_2D,this.lc);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,this.canvas||this.Ib);b.generateMipmap(b.TEXTURE_2D);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.MIRRORED_REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.MIRRORED_REPEAT)}},kc:function(a,b, c){this.lc||(this.lc=a.createTexture());if(c.ig!==this.lc.ig||c.ig.length!==this.lc.ig.length)this.Ib&&(this.Ib.onload=this.Ib.onerror=this.Ib.rna=null),this.lc.loaded=!1,this.wea(c.ig),this.lc.ig=c.ig,this.q.lC=!0;if(this.lc.loaded){this.q.rz&&(this.q.rz=!1,this.l_(c));this.q.lC&&(this.rja(c),this.q.lC=!1);var d=this.ab;a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);arguments.callee.oa.apply(this,arguments);a.activeTexture(a.TEXTURE0);a.uniform1f(d.t$, c.opacity);a.uniform1i(d.Ap,0);a.bindTexture(a.TEXTURE_2D,this.lc);a.enableVertexAttribArray(d.ud);a.bindBuffer(a.ARRAY_BUFFER,this.wi);a.vertexAttribPointer(d.ud,3,a.FLOAT,!1,0,0);a.enableVertexAttribArray(d.rN);a.bindBuffer(a.ARRAY_BUFFER,this.xja);a.vertexAttribPointer(d.rN,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);this.ld();a.disableVertexAttribArray(d.rN);a.disableVertexAttribArray(d.ud)}}});w.Ob.ob({N1:function(){w.C.h(this.La.xc,"touchstart",this.iy,this)},a6:function(){w.C.I(this.La.xc,"touchstart",this.iy,this)},mma:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;if(0!==d||0!==c){var e=0;0!==b.pageX-a.pageX?(e=180*Math.atan((b.pageY-a.pageY)/(b.pageX-a.pageX))/Math.PI,0===c?e=0<d?0:180:0>c&&0<d?e=-e:0>c&&0>d?e=180-e:0<c&&0>d?e=180-e:0<c&&0<d&&(e=360-e)):e=0<c?270:90;return e}},R:{Mc:!1},iy:function(a){this.ps();if(!(window.PointerEvent&&a instanceof window.PointerEvent&&"mouse"=== a.pointerType||(this.Pd&&this.Pd.stop(),w.C.preventDefault(a),2<a.touches.length))){var b=this.La.xc;this.R.touches=[];for(var c=0;c<a.touches.length;c+=1)this.R.touches.push({pageX:a.touches[c].pageX,pageY:a.touches[c].pageY,clientX:a.touches[c].clientX,clientY:a.touches[c].clientY});this.R.mk||(1===a.touches.length&&(a=this.zg(a.touches[0]),a.ad.r("touchstart",a),a.ad!==this&&a.ad.get("bubble")&&this.r("touchstart",a),this.R.YA=a,w.C.h(b,"touchend",this.sr,this)),w.C.h(b,"touchmove",this.ZV,this))}}, wma:function(a,b){return Math.sqrt((a.pageX-b.pageX)*(a.pageX-b.pageX)+(a.pageY-b.pageY)*(a.pageY-b.pageY))},ZV:function(a){if(!this.R.mk){if(1==a.touches.length){var b=(new w.G(a.touches[0].pageX,a.touches[0].pageY)).Ua(this.R.YA.sb);if(b.length()<(w.l.Mj?30:10))return;this.R.mk="drag"}else if(2<=a.touches.length){var b=new w.G(this.R.touches[0].pageX-a.touches[0].pageX,this.R.touches[0].pageY-a.touches[0].pageY),c=new w.G(this.R.touches[1].pageX-a.touches[1].pageX,this.R.touches[1].pageY-a.touches[1].pageY), d=b.length(),e=c.length();if(17>d&&17>e)return;b.direction();c.direction();(d=b.Qq(c))&&30>d&&(60>b.Qq(new w.G(0,1))&&60>c.Qq(new w.G(0,1))||60>b.Qq(new w.G(0,-1))&&60>c.Qq(new w.G(0,-1)))?this.R.mk="pitch":(d=new w.G(a.touches[1].pageX-a.touches[0].pageX,a.touches[1].pageY-a.touches[0].pageY),b=d.Qq(b),c=d.Qq(c),this.R.mk=b&&(40>b||140<b)||c&&(40>c||140<c)?"zoom":"rotate")}switch(this.R.mk){case "drag":this.Bfa(a);break;case "pitch":this.Cfa(a);break;case "zoom":this.Efa(a);break;case "rotate":this.Dfa(a)}this.R.mk&& (w.C.I(this.La.xc,"touchmove",this.ZV,this),w.C.I(this.La.xc,"touchend",this.sr,this),w.C.h(document,"touchend",this.lu,this))}},lu:function(a){if(!(window.PointerEvent&&a instanceof window.PointerEvent&&"mouse"===a.pointerType))switch(0===a.touches.length&&w.C.I(document,"touchend",this.lu,this),this.R.mk){case "drag":this.Baa();this.R.mk=null;break;case "pitch":this.Caa();this.R.mk=null;break;case "zoom":this.Eaa();this.R.mk=null;break;case "rotate":this.Daa(),this.R.mk=null}},gq:function(a){var b= this;return function(c){b.ia(a,c)}},QO:function(){this.On||(this.On=this.gq("touchstart"),this.ns=this.gq("touchmove"),this.ms=this.gq("touchend"));this.h("touchstart",this.On,this);this.h("touchmove",this.ns,this);this.h("touchend",this.ms,this)},mR:function(){this.I("touchstart",this.On,this);this.I("touchmove",this.ns,this);this.I("touchend",this.ms,this);this.ms=this.ns=this.On=null}});w.Ob.ob({Cfa:function(a){this.AH(a);w.C.h(this.La.xc,"touchmove",this.AH,this)},Caa:function(){w.C.I(this.La.xc,"touchmove",this.AH,this)},AH:function(a){if(this.get("pitchEnable")&&!(a.touches.length<(w.l.JE?3:2))){var b=(a.touches[0].pageY-this.R.touches[0].pageY+(a.touches[1].pageY-this.R.touches[1].pageY))/2/this.get("size").height*180;this.set("pitch",b+parseFloat(this.get("pitch")));this.R.touches=[];for(b=0;b<a.touches.length;b+=1)this.R.touches.push({pageX:a.touches[b].pageX,pageY:a.touches[b].pageY, clientX:a.touches[b].clientX,clientY:a.touches[b].clientY})}}});w.Ob.ob({Bfa:function(){w.C.h(this.La.xc,"touchmove",this.XR,this);this.o7(this.R.YA);this.R.YA=null},Baa:function(){w.C.I(this.La.xc,"touchmove",this.XR,this);this.n7()},n7:function(){var a=this.R;if(a.Em){var b=this.R.ei;a.Em=!1;a.Mc=!1;a.gn.r("touchend",b);a.gn.r("dragend",b)}a.gn=null;a.Gf=null;a.fn=null;a.ei=null},o7:function(a){var b=this.R,c;this.SG(a.ad)&&a.ad.get("draggable")&&(c=a.ad);!c&&this.Wx&&(c=this);c&&(b.Mc=!0,b.gn=c,b.Gf=a.sb,b.fn=a)},XR:function(a){var b=this.R;if(b.fn){var c= this.zg(a.touches[0],!0,!0);b.fn.ad.r("touchmove",c);b.fn.ad!==this&&b.fn.ad.get("bubble")&&this.r("touchmove",c);if(this.Or(c.sb,b.ei||b.fn.sb,2))return;b.ei=c;this.KH()}else c=this.zg(a.touches[0]),c.ad.r("touchmove",c),c.ad!==this&&c.ad.get("bubble")&&this.r("touchmove",c);if(a.preventDefault)a.preventDefault();else return!1}});w.Ob.ob({Efa:function(){w.C.h(this.La.xc,"touchmove",this.dS,this);this.s7(this.R.touches)},Eaa:function(){w.C.I(this.La.xc,"touchmove",this.dS,this);this.r7()},s7:function(a){var b=a[0];a=a[1];var c=a.clientY-b.clientY,d=a.clientX-b.clientX;this.WG=1;this.UG=Math.sqrt(c*c+d*d);1==this.J.get("touchZoomCenter")?this.ys=this.get("centerCoords"):(b=new w.G((b.clientX+a.clientX)/2,(b.clientY+a.clientY)/2),this.ys=this.of(b))},dS:function(a){if(!(2>a.touches.length)&&(w.C.preventDefault(a),this.get("zoomEnable")&& this.get("touchZoom"))){var b=0;if(a.scale)b=Math.log(a.scale/this.WG)/Math.log(2),this.WG=a.scale;else{var b=a.touches[0],c=a.touches[1];a=c.clientY-b.clientY;b=c.clientX-b.clientX;a=Math.sqrt(a*a+b*b);b=Math.log(a/this.UG)/Math.log(2);this.UG=a}b&&(b=this.get("zoom")+b,this.eU(b,this.ys,!0))}},r7:function(){this.WG=1;this.UG=null}});w.Ob.ob({Dfa:function(){w.C.h(this.La.xc,"touchmove",this.ZR,this);this.q7(this.R.touches)},Daa:function(){w.C.I(this.La.xc,"touchmove",this.ZR,this);this.p7()},q7:function(a){var b=a[0];a=a[1];this.VA=Math.atan2(a.clientY-b.clientY,a.clientX-b.clientX);this.VG=0},ZR:function(a){if(!(2>a.touches.length)&&(w.C.preventDefault(a),this.get("rotateEnable"))){var b;if(a.rotation)b=Math.round(this.get("rotation")+a.rotation-this.VG),this.VG=a.rotation;else{var c=a.touches[0];a=a.touches[1];c=Math.atan2(a.clientY- c.clientY,a.clientX-c.clientX);0.1<Math.abs(c-this.VA)&&(b=Math.round(this.get("rotation")+180*(c-this.VA)/Math.PI),this.VA=c)}void 0!==b&&this.set("rotation",b)}},p7:function(){this.VG=0;this.VA=null}});w.Ob.ob({sr:function(a){if(!(this.R.mk||0<a.touches.length)){this.Bf&&!this.Vf&&this.r("moveend");a=this.R.YA;var b=a.ad,c=this.J.get("allBubble")||b.get("bubble");c?(b.r("touchend",a),b!==this&&this.r("touchend",a)):b.r("touchend",a);this.Xe&&this.Or(a.sb,this.kt,600)?(clearTimeout(this.Xe),this.Xe=null,c?(b.r("dblclick",a),b!==this&&this.r("dblclick",a)):b.r("dblclick",a),this.kt=null):(this.r("clickstart",a),this.Xe&&(clearTimeout(this.Xe),this.Xe=null),this.kt=a.sb,c?(b.r("click",a),b!==this&& this.r("click",a)):(b.r("click",a),this.r("closeOverlays",a)),b.get("topWhenClick")&&b.Bc.setTop(!0),this.r("clickend",a),this.Xe=setTimeout(w.a.bind(function(){this.Xe=null},this),260));w.C.I(this.La.xc,"touchend",this.sr,this)}}});w.Cv=function(a,b){this.min=void 0!==a?a:new w.Ea([Infinity,Infinity,Infinity]);this.max=void 0!==b?b:new w.Ea([-Infinity,-Infinity,-Infinity])}; w.Cv.prototype={constructor:w.Cv,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},vb:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},ap:function(){var a=this.max.elements,b=this.min.elements;return a[0]<b[0]||a[1]<b[1]||a[2]<b[2]},pD:function(a){return a.max.elements[0]<this.min.elements[0]||a.min.elements[0]>this.max.elements[0]||a.max.elements[1]<this.min.elements[1]||a.min.elements[1]>this.max.elements[1]|| a.max.elements[2]<this.min.elements[2]||a.min.elements[2]>this.max.elements[2]?!1:!0},qb:function(a){return a.min.qb(this.min)&&a.max.qb(this.max)},Ye:function(){var a=new w.Ea,b=new w.Ea,c=new w.Ea,d=new w.Ea,e=new w.Ea,g=new w.Ea,h=new w.Ea,k=new w.Ea,l=[a,b,c,d,e,g,h,k];return function(m){var n=this.max.elements,p=this.min.elements;a.set(n[0],n[1],n[2]);b.set(p[0],n[1],n[2]);c.set(n[0],p[1],n[2]);d.set(p[0],p[1],n[2]);e.set(n[0],n[1],p[2]);g.set(p[0],n[1],p[2]);h.set(n[0],p[1],p[2]);k.set(p[0], p[1],p[2]);a.Ye(m);b.Ye(m);c.Ye(m);d.Ye(m);e.Ye(m);g.Ye(m);h.Ye(m);k.Ye(m);m=new w.Cv;for(var q=p=n=Infinity,s=-Infinity,r=-Infinity,u=-Infinity,v=0,x=l.length;v<x;v+=1){var t=l[v].elements,y=t[0],B=t[1],t=t[2]||0;y<n&&(n=y);B<p&&(p=B);t<q&&(q=t);y>s&&(s=y);B>r&&(r=B);t>u&&(u=t)}m.min.set(n,p,q);m.max.set(s,r,u);return m}}()}; function ed(a,b,c){var d=Infinity,e=Infinity,g=Infinity,h=-Infinity,k=-Infinity,l=-Infinity;c=c||3;for(var m=0,n=b.length;m<n;m+=c){var p=b[m],q=b[m+1],s=b[m+2];p<d&&(d=p);q<e&&(e=q);s<g&&(g=s);p>h&&(h=p);q>k&&(k=q);s>l&&(l=s)}a.min.set(d,e,g);a.max.set(h,k,l)};w.oF=function(a,b){this.origin=void 0!==a?a:new w.Ea;this.direction=void 0!==b?b:new w.Ea}; w.oF.prototype={constructor:w.oF,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},vb:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},FC:function(a,b){return Math.sqrt(this.sba(a,b))},sba:function(){var a=new w.Ea;return function(b,c){var d=a.ev(b,this.origin).Qj(this.direction);if(0>d)return Infinity;a.copy(this.direction).Hr(d).add(this.origin);c&&c.copy(a);return a.KU(b)}}(),JU:function(){var a= new w.Ea,b=new w.Ea,c=new w.Ea;return function(d,e,g,h){a.copy(d).add(e).Hr(0.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var k=0.5*d.Ld(e),l=-this.direction.Qj(b),m=c.Qj(this.direction),n=-c.Qj(b),p=c.XW(),q=Math.abs(1-l*l),s;0<q?(d=l*n-m,e=l*m-n,s=k*q,0<=d?e>=-s?e<=s?(k=1/q,d*=k,e*=k,l=d*(d+l*e+2*m)+e*(l*d+e+2*n)+p):(e=k,d=Math.max(0,-(l*e+m)),l=-d*d+e*(e+2*n)+p):(e=-k,d=Math.max(0,-(l*e+m)),l=-d*d+e*(e+2*n)+p):e<=-s?(d=Math.max(0,-(-l*k+m)),e=0<d?-k:Math.min(Math.max(-k,-n),k),l= -d*d+e*(e+2*n)+p):e<=s?(d=0,e=Math.min(Math.max(-k,-n),k),l=e*(e+2*n)+p):(d=Math.max(0,-(l*k+m)),e=0<d?k:Math.min(Math.max(-k,-n),k),l=-d*d+e*(e+2*n)+p)):(e=0<l?-k:k,d=Math.max(0,-(l*e+m)),l=-d*d+e*(e+2*n)+p);g&&g.copy(this.direction).Hr(d).add(this.origin);h&&h.copy(b).Hr(e).add(a);return w.a.Sc(l,6)}}(),pD:function(){var a=new w.Ea;return function(b){return null!==fd(this,b,a)}}(),qu:function(){var a=new w.Ea,b=new w.Ea,c=new w.Ea,d=new w.Ea,e=new w.Ea;return function(g,h,k,l,m){var n=this.origin, p=this.direction;c.ev(h,g);d.ev(k,g);e.Rt(p,d);h=c.Qj(e);if(0<h){if(l)return;a.ev(n,g)}else a.ev(g,n),h=-h;if(0>h)return!1;g=a.Qj(e);if(0>g||g>h)return!1;b.Rt(a,c);p=p.Qj(b);if(0>p||g+p>h)return!1;p=d.Qj(b);if(0>=p)return!1;p*=1/h;m&&m.copy(this.origin.vb().add(this.direction.vb().Hr(p)));return p}}(),qb:function(a){return a.origin.qb(this.origin)&&a.direction.qb(this.direction)}}; function fd(a,b,c){var d,e,g,h;e=1/a.direction.elements[0];h=1/a.direction.elements[1];var k=1/a.direction.elements[2],l=a.origin;0<=e?(d=(b.min.elements[0]-l.elements[0])*e,e*=b.max.elements[0]-l.elements[0]):(d=(b.max.elements[0]-l.elements[0])*e,e*=b.min.elements[0]-l.elements[0]);0<=h?(g=(b.min.elements[1]-l.elements[1])*h,h*=b.max.elements[1]-l.elements[1]):(g=(b.max.elements[1]-l.elements[1])*h,h*=b.min.elements[1]-l.elements[1]);if(d>h||g>e)return null;if(g>d||d!==d)d=g;if(h<e||e!==e)e=h;0<= k?(g=(b.min.elements[2]-l.elements[2])*k,b=(b.max.elements[2]-l.elements[2])*k):(g=(b.max.elements[2]-l.elements[2])*k,b=(b.min.elements[2]-l.elements[2])*k);if(d>b||g>e)return null;if(g>d||d!==d)d=g;if(b<e||e!==e)e=b;return 0>e?null:(c||new w.Ea).copy(a.direction).Hr(0<=d?d:e).add(a.origin)};$.w.$n=$.w.qc.extend({F:{visible:!0,opacity:1,zIndex:1200,zooms:[3,20],alwaysRender:!1,type:"obj3d"},B:function(a){this.CLASS_NAME=this.CLASS_NAME||"AMap.Object3DLayer";arguments.callee.oa.apply(this,arguments);this.objects=this.li=[]},add:function(a){-1==w.a.indexOf(this.li,a)&&(this.li.push(a),a.w=this,a.LD&&a.LD(),this.reDraw(),this.Wea=!0)},remove:function(a){-1!==w.a.indexOf(this.li,a)&&(this.li=w.a.Ut(this.li,a),a.w=null,this.reDraw())},clear:function(){for(var a=0,b=this.li.length;a<b;a+=1)this.li[a].w= null;this.objects=this.li=[];this.reDraw()},om:function(a,b,c,d,e){for(var g=[],h=0,k=this.li.length;h<k;h+=1){var l=this.li[h];(l=(l.raycast||l.om).call(l,a,b,c,d,e))&&(l.length?g.push.apply(g,l):g.push(l))}g.sort(function(a,b){return a.Fd-b.Fd});return g[0]||null},reDraw:function(){this.w&&this.w.set("display")},sg:function(a){this.get("map")||this.set("map",a.J,!0);return new w.w.$n(this,a)}});w.w.$n=w.w.qc.extend({B:function(a,b){this.fa=a;this.Pp="3D";this.eA=w.a.Jb(this);a&&this.he(["opacity","visible","zIndex","zooms"],a);this.g=b;this.X("display",b)},mn:function(){this.fa.Wea&&this.fa.li.sort(function(a,b){return a.transparent!==b.transparent?a.transparent?1:-1:a.id>b.id?1:-1});return{visible:this.get("visible"),zIndex:this.get("zIndex"),gd:this.get("zooms"),opacity:this.get("opacity"),K:this.get("container"),li:this.fa.li}},Kl:function(a){if(w.Ma.$n)return new w.Ma.$n(this,a)}});w.Ma.$n=w.Ma.qc.extend({ga:[w.ka,w.te],sW:!0,B:function(a,b){this.q=a;this.T=b;this.g=b.g;this.X("display",a);this.Ou={}},createProgram:function(a){var b=this.T.Pa,c=a.ih.sm,d=a.ih.me;if(c&&d){c=this.ET(c,d,a);if(c=w.pk.createProgram(b,c[0],c[1]))c.Ez=b.getUniformLocation(c,"_opacity"),c.Hz=b.getUniformLocation(c,"u_projectionMatrix"),c.Gz=b.getUniformLocation(c,"u_modelViewMatrix"),d=a.getWebGLVariableLoaction||a.Kh,a.yh&&(c.dN=b.getUniformLocation(c,"fog"),c.cN=b.getUniformLocation(c,"fogColor")), d&&(b=this.T.Pa,d.call(a,b,c));return c}},$ca:function(a){var b=a.type;if(!b)return null;var c=this.Ou[b];c||(c=this.createProgram(a),this.Ou[b]=c);return c},Saa:function(a){return{Uda:a.isEnabled(a.DEPTH_TEST),Pda:a.isEnabled(a.BLEND),Tda:a.isEnabled(a.CULL_FACE)}},Raa:function(a,b){b.Uda?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);b.Pda?a.enable(a.BLEND):a.disable(a.BLEND);b.Tda?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.cullFace(a.BACK)},Dda:function(a,b,c){var d=a.pd;d||(d=b);a=a.Z.Tm.Ye(d); return c.pD(a)?!0:!1},kc:function(a,b,c){b=b.W;var d=c.li;this.Aa=b.Aa;a.clear(a.DEPTH_BUFFER_BIT);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);var e=this.Saa(a);a.enable(a.DEPTH_TEST);for(var g=0,h=d.length;g<h;g+=1){var k=d[g];k.mC&&k.mC(this.g.J);k.KE();k.jm&&k.oN(b.pd);var l=k.mp;l&&(k.pd=(new w.ge).set(b.pd).multiply(l));if(this.Dda(k,b.pd,b.hh.eV,this.g.J)&&(l=this.$ca(k))){a.useProgram(l);a.uniform1f(l.Ez,isNaN(c.opacity)?1:parseFloat(c.opacity));k.update(a, l,b.pd,this.g.J);l.Hz&&a.uniformMatrix4fv(l.Hz,!1,b.hh.elements);l.Gz&&(k.bfa=new w.ZN(k.pd.Wi().WZ()),a.uniformMatrix4fv(l.Gz,!1,k.pd.elements));if(k.acceptFog||k.yh){var m=this.g.J.view.Qk*(1+1.1*Math.cos(b.pitch*Math.PI/180));a.uniform2f(l.dN,0.9*m,1.5*m);m=this.T.lz.mz;a.uniform4f(l.cN,m[0],m[1],m[2],1)}k.transparent?a.enable(a.BLEND):a.disable(a.BLEND);(k.render||k.Q).call(k,a,l)}}this.Raa(a,e);this.q.ta||(this.q.ta=!0,w.a.pc(function(){this.q&&(this.q.cd?this.q.ia("renderComplete"):(this.q.cd= !0,this.q.ia("complete")))},this))}});w.Wd=w.aa.extend({B:function(){this.vertices=this.Ia=[];this.vertexUVs=this.us=[];this.vertexColors=this.Wa=[]},KE:function(){this.boundingBox=this.Tm=new w.Cv;ed(this.Tm,this.Ia)},om:function(a){if(!fd(a,this.Tm))return null}});w.Wd.Sj({KE:"updateBoundingBox"});w.Fs={};w.Fs.AN=w.aa.extend({B:function(a,b){this.dw=a;this.zw=b;this.update()},update:function(){var a=this.dw,b=this.zw;this.color=[a[0]*b,a[1]*b,a[2]*b]},setColor:function(a){this.dw=a;this.update()},setIntensity:function(a){this.zw=a;this.update()}}); w.Fs.IN=w.aa.extend({B:function(a,b,c){this.dw=b;this.zw=c;this.direction=a;this.update()},update:function(){var a=this.dw,b=this.zw;this.color=[a[0]*b,a[1]*b,a[2]*b]},setDirection:function(a){this.direction=a},setIntensity:function(a){this.zw=a;this.update()},setColor:function(a){this.dw=a;this.update()}});w.Wd.Kv=w.Wd.extend({B:function(){this.type="mesh";this.boundingBox=this.Tm=null;this.vertices=this.Ia=[];this.faces=this.Ih=[];this.vertexUVs=this.us=[];this.vertexColors=this.Wa=[];this.textureIndices=this.gv=[]}});w.Wd.Xn=w.Wd.extend({B:function(){this.type="line";this.boundingBox=this.Tm=null;this.vertices=this.Ia=[];this.segments=this.jl=[];this.vertexUVs=this.us=[];this.vertexColors=this.Wa=[];this.textureIndices=this.gv=[]}});w.Wd.Mv=w.Wd.extend({B:function(){this.type="points";this.boundingBox=this.Tm=null;this.vertices=this.Ia=[];this.vertexColors=this.Wa=[];this.pointSizes=this.PL=[];this.pointAreas=this.Mu=[];this.vertexUVs=this.us=[];this.textureIndices=this.gv=[]}});w.Wd.Rv=w.Wd.extend({B:function(){this.type="wideline";this.boundingBox=this.Tm=null;this.vertices=this.Ia=[];this.vertexIndices=this.Vn=[];this.directions=this.mJ=[];this.vertexUVs=this.us=[];this.vertexColors=this.Wa=[];this.textureIndices=this.gv=[]},Tfa:function(){if(this.Ia.length){for(var a=[],b=0,c=this.Ia.length/3;b<c;b++){var d=3*b;a.push([this.Ia[d],this.Ia[d+1],this.Ia[d+2]])}c=w.uN.parse({Nr:a,LX:!!this.LX,Sda:!0,Iia:!1});a=c[0];b=c[2];this.Vn=c[1];this.RE=[];this.mJ=[];c=0;for(d=a.length/ 9;c<d;c++){var e=9*c;this.RE.push(a[e],a[e+1],b[c]);this.mJ.push(a[e+2],a[e+3])}if(this.RE.length/3>this.Wa.length/4)for(a=this.RE.length/3-this.Wa.length/4;0<a--;)this.Wa.push.apply(this.Wa,this.Wa.slice(0,4))}}});w.zc=w.aa.extend({B:function(){this.id=w.zc.count++;this.type="basic";this.DEPTH_TEST=!0;this.transparent=!1;this.yh=!0;this.textures=this.Ne=[];this.geometry=this.Z=new w.Wd;Object.defineProperty(this,"needUpdate",{configurable:!1,enumerable:!0,set:function(a){this.kR=this.Lw=a},get:function(){return this.Lw}});this.jm=this.needUpdate=!0;this.mp=new w.ge;this.oE=new w.ge;this.xp=new w.ge},position:function(a,b){a&&(this.Ej=a);this.vw=b||0;this.jm=!0;return this.Ej},reDraw:function(){this.w&&this.w.reDraw()}, scale:function(a,b,c){this.oE.scale(a,b,c);this.jm=!0;this.reDraw()},as:function(a,b,c){this.oE.as(a,b,c);this.jm=!0;this.reDraw()},$u:function(a,b,c,d){this.xp.$u(a,b,c,d);this.jm=!0;this.reDraw()},nM:function(a){this.xp.nM(a);this.jm=!0;this.reDraw()},oM:function(a){this.xp.oM(a);this.jm=!0;this.reDraw()},pM:function(a){this.xp.pM(a);this.jm=!0;this.reDraw()},reset:function(){this.mp.vM();this.xp.vM();this.oE.vM();this.jm=!0;this.reDraw()},oN:function(){var a=this.w.getMap(),b={x:0,y:0};this.Ej&& (b=a.$K(this.Ej));this.mp=(new w.ge).translate(b.x,b.y,-this.vw||0).multiply(this.xp).multiply(this.oE);this.jm=!1},gX:{vec4:"4fv",mat3:"Matrix3fv",vec3:"3fv",vec2:"2fv","float":"1f","int":"1i",bool:"1i"},om:function(){return!1},MZ:function(){if(this.Ne.length)for(var a=this.w.w.g.T,b=0;b<this.Ne.length;b+=1)if(!a.Ne[this.Ne[b]].lc)return!1;return!0},wf:function(a,b,c,d){if(c.length)return d=d||a.createBuffer(),a.bindBuffer(b,d),a.bufferData(b,c,a.STATIC_DRAW),d},m_:function(){if(this.Ne.length)for(var a= this,b=this.w.w.g.T,c=0;c<this.Ne.length;c+=1){var d=this.Ne[c];if(!b.Ne[d]||d.needUpdate)if(b.Ne[d]={url:d},d instanceof HTMLCanvasElement){var e=b.createTexture(d);b.Ne[d].lc=e;b.Ne[d].width=d.width;b.Ne[d].height=d.height}else e=d.replace(/http[s]{0,1}:/,w.A.Rb+":"),b.cX(d,e,function(c,d,e,l){b.Ne[c].lc=d;b.Ne[c].width=e;b.Ne[c].height=l;a.w.w.set("display")},function(a){b.Ne[a].status="load failed"})}},KE:function(){this.kR&&(this.Z.KE(),this.kR=!1)},update:function(a,b,c,d){this.g=d;this.Lw&& ((this.updateBuffers||this.h_).call(this,a,b),(this.updateTextures||this.m_).call(this,a,b),this.needUpdate=!1)},h_:function(a){var b=this.ih,c=b.attributes,d;for(d in c)if(c.hasOwnProperty(d)){var e=c[d].value.call(this,this),g=d+"Buffer";!e.length&&this[g]&&(a.deleteBuffer(this[g]),this[g]=null);e.length&&(this[g]=this.wf(a,a.ARRAY_BUFFER,new Float32Array(e),this[g]),this[g].size=parseInt(c[d].type.substr(3))||1,this[g].length=e.length/this[g].size)}if(b=b.vertexIndices||b.Vn)b=b.call(this),!b.length&& this.Zo&&(a.deleteBuffer(this.Zo),this.Zo=null),b.length&&(this.Zo=this.wf(a,a.ELEMENT_ARRAY_BUFFER,new Uint16Array(b),this.Zo),this.Zo.length=b.length)},PT:function(a,b){if(-1!==b.f_){if(this.Ne.length){for(var c=this.w.w.g.T,d=0;8>d;d+=1)d<this.Ne.length?(a.activeTexture(a["TEXTURE"+d]),a.bindTexture(a.TEXTURE_2D,c.Ne[this.Ne[d]].lc)):(a.activeTexture(a["TEXTURE"+d]),a.bindTexture(a.TEXTURE_2D,c.ar[0]));a.uniform1iv(b.f_,[0,1,2,3,4,5,6,7])}a.uniform1i(b.eja,this.Ne.length)}},Q:function(a,b){if((this.texturesAllLoaded|| this.MZ).call(this)&&this.a_vertexBuffer){this.DEPTH_TEST?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);var c=this.drawMode;if(c&&0===c.indexOf("TRIANGLE")){var d=this.backOrFront;"both"==d?a.disable(a.CULL_FACE):(a.enable(a.CULL_FACE),a.cullFace("front"==d?a.BACK:a.FRONT))}this.PT(a,b);var d=this.ih,e=d.nl,g;for(g in e)if(e.hasOwnProperty(g)){var h=b["u_"+g],k=e[g].value;k.call&&(k=k.call(this,this));if(k||0===k){var l=e[g].type;if(0==l.indexOf("mat"))a["uniform"+this.gX[l]](h,!1,k);else a["uniform"+ this.gX[l]](h,k)}}d=d.attributes;for(g in d)d.hasOwnProperty(g)&&(e=b["a_"+g],-1!==e&&((h=this[g+"Buffer"])?(a.enableVertexAttribArray(e),a.bindBuffer(a.ARRAY_BUFFER,h),a.vertexAttribPointer(e,h.size,a.FLOAT,!1,0,0)):a.disableVertexAttribArray(e)));this.Zo?(a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.Zo),a.drawElements(a[c],this.Zo.length,a.UNSIGNED_SHORT,0)):a.drawArrays(a[c],0,this.a_vertexBuffer.length);(this.afterRender||this.ld).call(this,a,b)}},ld:function(a,b){var c=this.ih.attributes,d;for(d in c)if(c.hasOwnProperty(d)){var e= b["a_"+d];-1!==e&&a.disableVertexAttribArray(e)}},ih:{nl:{},attributes:{a_vertex:{type:"vec3",value:function(){return this.Z.Ia}}},sm:"\\n\\t\\t\\tattribute vec3 a_vertex;\\n\\t\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\t\\tuniform mat4 u_projectionMatrix;\\n\\t\\t\\tvoid main() {\\n\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * vec4( a_vertex, 1.0 );\\n\\t\\t}",me:"void main() {\\n\\t\\t\\tgl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0);\\n\\t\\t}"},Kh:function(a,b){var c=this.ih,d=c.attributes,c=c.nl,e;for(e in c)c.hasOwnProperty(e)&& (b["u_"+e]=a.getUniformLocation(b,e));for(e in d)d.hasOwnProperty(e)&&(b["a_"+e]=a.getAttribLocation(b,e));b.eja=a.getUniformLocation(b,"u_textureNum");b.f_=a.getUniformLocation(b,"u_textures")}}); w.zc.extend=function(a){var b=this.prototype.ih,c=a.shader||a.ih;if(c){c.nl=w.extend({},b.nl,c.uniforms||c.nl||{});c.attributes=w.extend({},b.attributes,c.attributes||c.attributes||{});var d=c.vertexShader||c.sm;c.sm=d?d:b.sm;d=c.fragmentShader||c.me;c.me=d?d:b.me;d=c.vertexIndices||c.Vn;d||null===d||(c.Vn=b.Vn);a.shader&&!a.ih&&(a.ih=c,delete a.shader)}return w.aa.extend.call(this,a)}; w.r0=w.zc.extend({B:function(){this.children=[]},add:function(a){a&&a.Ry!==this&&(a.Ry&&a.Ry.remove(a),this.children.push(a),a.Ry=this)},remove:function(a){a.Ry===this&&(w.a.Ut(this.children,a),a.Ry=null)},om:function(a,b,c){for(var d=[],e=0,g=this.children.length;e<g;e+=1){var h=this.children[e].om(a,b,c);h&&d.push(h)}return d.length?d:null},update:function(a,b){for(var c=0,d=this.children.length;c<d;c+=1)this.children[c].update(a,b)},Q:function(a,b){for(var c=0,d=this.children.length;c<d;c+=1)this.children[c].Q(a, b)}});w.zc.count=0;w.zc.Kda={B:"initialize",update:"update",om:"raycast",ld:"afterRender",Q:"render",h_:"updateBuffers",Kh:"getWebGLVariableLoaction",PT:"bindTextures",m_:"updateTextures",MZ:"texturesAllLoaded"};w.zc.Sj({scale:"scale",as:"setScale",$u:"setRotate",nM:"rotateX",oM:"rotateY",pM:"rotateZ",reset:"reset"});w.zc.Kv=w.zc.extend({B:function(){this.kl(arguments);this.type="mesh";this.drawMode="TRIANGLES";this.geometry=this.Z=new w.Wd.Kv;this.backOrFront="back"},om:function(a,b,c){var d=this.pd;d||(d=c);d.oe||(d.oe=d.Wi());b=new w.Ea(d.oe.Jf(b));d=new w.Ea(d.oe.Jf(new w.qj(0,0,0,1)));b=b.sub(d).normalize();a.origin.copy(d);a.direction.copy(b);var e=this.Z;if((d=e.Tm)&&!fd(a,d))return null;d=new w.Ea;b=e.Ia;var e=e.Ih,g=new w.Ea,h=new w.Ea,k=new w.Ea,l=[],m=!0;"both"==this.backOrFront&&(m=!1);if(e.length)for(var n= 0,p=e.length;n<p;n+=3){var q=3*e[n],s=3*e[n+1],r=3*e[n+2];g.set(b[q],b[q+1],b[q+2]);h.set(b[s],b[s+1],b[s+2]);k.set(b[r],b[r+1],b[r+2]);(q="front"==this.backOrFront?a.qu(g,h,k,m,d):a.qu(g,k,h,m,d))&&l.push({Fd:q,nJ:0,Vy:d,index:n/3,object:this})}else for(n=0,p=b.length;n<p;n+=9)q=n,s=n+3,r=n+6,g.set(b[q],b[q+1],b[q+2]),h.set(b[s],b[s+1],b[s+2]),k.set(b[r],b[r+1],b[r+2]),(q="front"==this.backOrFront?a.qu(g,h,k,m,d):a.qu(g,k,h,m,d))&&l.push({Fd:q,nJ:0,Vy:d,index:n/9,object:this});l.sort(function(a, b){return a.Fd-b.Fd});if(a=l[0])d=d.Ye(this.mp),a.Vy=d.elements,a.Fd=(new w.Ea(0,0,0)).Ye(c.Wi()).Ld(d);return a||null},ih:{nl:{},attributes:{a_color:{type:"vec4",value:function(){return this.Z.Wa}},a_textureIndex:{type:"float",value:function(){return this.Z.gv}},a_uv:{type:"vec2",value:function(){return this.Z.us}}},Vn:function(){return this.Z.Ih},sm:"attribute vec3 a_vertex;\\n\\t\\tattribute vec4 a_color;\\n\\t\\tattribute vec2 a_uv;\\n\\t\\tattribute float a_textureIndex;\\n\\t\\t\\n\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\tuniform mat4 u_projectionMatrix;\\n\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec2 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\n\\t\\tvoid main(void) {\\n\\t\\t\\tv_color = a_color;\\n\\t\\t\\tv_uv = a_uv;\\n\\t\\t\\tv_textureIndex = a_textureIndex;\\n\\t\\t\\tvec4 pos = vec4(a_vertex, 1.0);\\n\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n\\t\\t}\\n\\t", me:" precision mediump float;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec2 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tuniform int u_textureNum;\\n\\t\\tuniform sampler2D u_textures[8];\\n\\t\\tvoid main(void) {\\n\\t\\t\\tif (u_textureNum == 0) {\\n\\t\\t\\t\\tgl_FragColor = v_color;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tvec4 smpColor;\\n\\t\\t\\t\\tfloat textureIndex;\\n\\t\\t\\t\\tif (u_textureNum == 1) {\\n\\t\\t\\t\\t\\ttextureIndex = 0.0;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\ttextureIndex = v_textureIndex;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvec2 uv = v_uv.xy;\\n\\t\\t\\t\\tif (textureIndex == 0.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[0], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 1.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[1], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 2.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[2], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 3.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[3], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 4.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[4], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 5.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[5], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 6.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[6], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 7.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[7], uv);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (smpColor.a == 0.0) {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tgl_FragColor = smpColor;\\n\\t\\t\\t}\\t\\t\\n\\t\\t}\\n\\t"}});w.zc.aO=w.zc.Kv.extend({B:function(){this.kl(arguments);this.type="lightmesh";this.Z.vertexNormals=this.Z.Eg=[];this.directionLight=this.ambientLight=null},ih:{nl:{u_ambient:{type:"vec3",value:function(){if(this.g.AmbientLight)return this.g.AmbientLight.color}},u_light:{type:"vec3",value:function(){if(this.g.DirectionLight)return this.g.DirectionLight.color}},u_lightDirection:{type:"vec3",value:function(){var a=this.g;if(this.g.DirectionLight)return a.map.T.YW.elements}},u_normalMatrix:{type:"mat3", value:function(){return this.bfa.elements}}},attributes:{a_normal:{type:"vec3",value:function(){return this.Z.Eg}}},sm:"\\n\\t\\t\\tattribute vec3 a_vertex;\\n\\t\\t\\tattribute vec4 a_color;\\n\\t\\t\\tattribute vec3 a_normal;\\n\\t\\t\\tattribute vec2 a_uv;\\n\\t\\t\\tattribute float a_textureIndex;\\n\\t\\t\\t\\n\\t\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\t\\tuniform mat4 u_projectionMatrix;\\n\\t\\t\\tuniform mediump int u_textureNum;\\n\\t\\t\\tuniform vec3 u_ambient;\\n\\t\\t\\tuniform vec3 u_light;\\n\\t\\t\\tuniform vec3 u_lightDirection;\\n\\t\\t\\tuniform mat3 u_normalMatrix;\\n\\t\\t\\tvarying vec4 v_color;\\n\\t\\t\\tvarying vec2 v_uv;\\n\\t\\t\\tvarying float v_textureIndex;\\n\\n\\t\\t\\tvoid main(void) {\\n\\t\\t\\t\\tvec3 normal = normalize(u_normalMatrix * a_normal);\\n\\t\\t\\t\\tfloat nDotL = max(dot(u_lightDirection, -normal), 0.0);\\n\\t\\t\\t\\tvec3 diffuse = u_light*nDotL;\\n\\t\\t\\t\\tvec3 ll = (u_ambient+diffuse);\\n\\t\\t\\t\\tif(u_textureNum==0){//\\u6ca1\\u6709\\u7eb9\\u7406\\uff0c\\u5728\\u9876\\u70b9\\u7740\\u8272\\u5668\\u8fdb\\u884c\\u5149\\u7167\\u53e0\\u52a0\\n\\t\\t\\t\\t\\tv_color = vec4(ll*a_color.rgb,a_color.a);\\n\\t\\t\\t\\t}else{\\n\\t\\t\\t\\t\\tv_color = vec4(ll,a_color.a);//\\u8bb0\\u5f55\\u5149\\u7167\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\n\\t\\t\\t\\tv_uv = a_uv;\\n\\t\\t\\t\\tv_textureIndex = a_textureIndex;\\n\\t\\t\\t\\tvec4 pos = vec4(a_vertex, 1.0);\\n\\t\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n\\t\\t\\t}\\n\\t\\t", me:" precision mediump float;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec2 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tuniform int u_textureNum;\\n\\t\\tuniform sampler2D u_textures[8];\\n\\t\\tvoid main(void) {\\n\\t\\t\\tif (u_textureNum == 0) {\\n\\t\\t\\t\\tgl_FragColor = v_color;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tvec4 smpColor;\\n\\t\\t\\t\\tfloat textureIndex;\\n\\t\\t\\t\\tif (u_textureNum == 1) {\\n\\t\\t\\t\\t\\ttextureIndex = 0.0;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\ttextureIndex = v_textureIndex;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvec2 uv = v_uv.xy;\\n\\t\\t\\t\\tif (textureIndex == 0.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[0], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 1.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[1], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 2.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[2], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 3.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[3], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 4.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[4], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 5.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[5], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 6.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[6], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 7.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[7], uv);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (smpColor.a == 0.0) {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tgl_FragColor = vec4(v_color.rgb*smpColor.rgb,v_color.a);;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\t"}});w.zc.bO=w.zc.aO.extend({B:function(a){this.kl(arguments);this.type="prism";this.F=a;this.fC=this.attributeNeedUpdate=!0},mC:function(a){if(this.fC||this.attributeNeedUpdate)this.OF(this.F,a),this.fC=this.attributeNeedUpdate=!1},Pm:function(a,b){var c=a,d=w.a;d.$j(c,"string")&&(c=[c]);d.Pb(c,function(a,b){c[b]=d.bJ(a)});if(c.length<b)for(var e=c[c.length-1],g=0,h=b-c.length;g<h;g++)c.push(e);return c},OF:function(a,b){var c=a.path;if(c[0]instanceof w.U||c[0]instanceof w.G)c=[c];for(var d=a.height, e=this.Pm(a.color,c.length),g=null,g=a.color2?this.Pm(a.color2,c.length):e,h=0;h<c.length;h+=1)c[h]=this.pea(c[h],b),c[h]=w.Yp.makesureAntiClockwise(c[h]);var k=c[0];k.lg=0;for(var l=[],m=[],h=1;h<c.length;h+=1)c[h].lg=h,w.Yp.isRingInRing(c[h],k)?l.push(c[h]):m.push(c[h]);c=this.Z;c.Ih.length&&(c.Ih=[],c.Wa=[],c.Eg=[],c.Ia=[]);c.QC=c.faceSet=[];for(var n=0,p=0,q=4*k.length,h=0,s=k.length;h<s;h+=1){var r=k[h],u=k[(h+1)%s];c.Ia.push(r[0],r[1],0);c.Ia.push(r[0],r[1],-d);c.Ia.push(u[0],u[1],0);c.Ia.push(u[0], u[1],-d);var v=new w.Ea(0,0,-d),r=new w.Ea(u[0]-r[0],u[1]-r[1],0),r=(new w.Ea).Rt(r,v).normalize().elements;c.Eg.push(r[0],r[1],r[2]);c.Eg.push(r[0],r[1],r[2]);c.Eg.push(r[0],r[1],r[2]);c.Eg.push(r[0],r[1],r[2]);var x=g[k.lg];c.Wa.push.apply(c.Wa,x);c.Wa.push.apply(c.Wa,x);c.Wa.push.apply(c.Wa,x);c.Wa.push.apply(c.Wa,x);var r=4*h,v=r+1,u=(r+2)%q,t=(r+3)%q;c.Ih.push(v,r,u);c.Ih.push(v,u,t);this.Ww(c,k.lg,[n++,n++])}p+=q;for(h=0;h<l.length;h+=1){for(var y=l[h],q=4*y.length,x=0,s=y.length;x<s;x+=1)r= y[x],u=y[(x+1)%s],c.Ia.push(r[0],r[1],0),c.Ia.push(r[0],r[1],-d),c.Ia.push(u[0],u[1],0),c.Ia.push(u[0],u[1],-d),v=new w.Ea(0,0,-d),r=new w.Ea(u[0]-r[0],u[1]-r[1],0),r=(new w.Ea).Rt(v,r).normalize().elements,c.Eg.push(-r[0],-r[1],-r[2]),c.Eg.push(-r[0],-r[1],-r[2]),c.Eg.push(-r[0],-r[1],-r[2]),c.Eg.push(-r[0],-r[1],-r[2]),r=g[y.lg],c.Wa.push.apply(c.Wa,r),c.Wa.push.apply(c.Wa,r),c.Wa.push.apply(c.Wa,r),c.Wa.push.apply(c.Wa,r),r=4*x,v=r+1,u=(r+2)%q,t=(r+3)%q,c.Ih.push(p+v,p+u,p+r),c.Ih.push(p+v,p+t, p+u),this.Ww(c,[n++,n++]);p+=q}h=q=0;for(s=k.length;h<s;h+=1)r=k[h],c.Ia.push(r[0],r[1],-d),c.Eg.push(0,0,-1),c.Wa.push.apply(c.Wa,e[k.lg]);q+=k.length;for(h=0;h<l.length;h+=1){y=l[h];x=0;for(s=y.length;x<s;x+=1)r=y[x],c.Ia.push(r[0],r[1],-d),c.Eg.push(0,0,-1),c.Wa.push.apply(c.Wa,e[y.lg]);q+=y.length}s=w.Ks.Gp(k,l);for(h=0;h<s.length;h+=3)c.Ih.push(s[h]+p,s[h+2]+p,s[h+1]+p),this.Ww(c,k.lg,[n++]);p+=q;for(h=0;h<m.length;h+=1){k=m[h];q=4*k.length;x=0;for(s=k.length;x<s;x+=1)r=k[x],u=k[(x+1)%s],c.Ia.push(r[0], r[1],0),c.Ia.push(r[0],r[1],-d),c.Ia.push(u[0],u[1],0),c.Ia.push(u[0],u[1],-d),v=new w.Ea(0,0,-d),r=new w.Ea(u[0]-r[0],u[1]-r[1],0),r=(new w.Ea).Rt(r,v).normalize().elements,c.Eg.push(r[0],r[1],r[2]),c.Eg.push(r[0],r[1],r[2]),c.Eg.push(r[0],r[1],r[2]),c.Eg.push(r[0],r[1],r[2]),l=g[k.lg],c.Wa.push.apply(c.Wa,l),c.Wa.push.apply(c.Wa,l),c.Wa.push.apply(c.Wa,l),c.Wa.push.apply(c.Wa,l),r=4*x,v=r+1,u=(r+2)%q,t=(r+3)%q,c.Ih.push(p+v,p+r,p+u),c.Ih.push(p+v,p+u,p+t),this.Ww(c,k.lg,[n++,n++]);p+=q;x=0;for(s= k.length;x<s;x+=1)r=k[x],c.Ia.push(r[0],r[1],-d),c.Eg.push(0,0,-1),c.Wa.push.apply(c.Wa,e[k.lg]);s=w.Ks.Gp(k);for(x=0;x<s.length;x+=3)c.Ih.push(s[x]+p,s[x+2]+p,s[x+1]+p),this.Ww(c,k.lg,[n++]);p+=k.length}this.needUpdate=!0},Ww:function(a,b,c){a.QC[b]||(a.QC[b]={});w.a.Pb(c,function(c){a.QC[b][c]=1})},qb:function(a,b){return a.qb?a.qb(b):a[0]===b[0]&&a[1]===b[1]},pea:function(a,b){var c=!1;a[0]instanceof w.U&&(c=!0);for(var d=[],e=0;e<a.length;e+=1)d[e]=c?b.$K(a[e]):a[e],d[e]=d[e].x?[w.a.Sc(d[e].x, 3),w.a.Sc(d[e].y,3)]:[w.a.Sc(d[e][0],3),w.a.Sc(d[e][1],3)];2<a.length&&this.qb(a[a.length-1],a[0])&&d.pop();return d}});w.zc.Xn=w.zc.extend({B:function(){this.kl(arguments);this.type="line";this.drawMode="LINES";this.geometry=this.Z=new w.Wd.Xn},om:function(a,b,c,d){var e=this.pd;e||(e=c);e.oe||(e.oe=e.Wi());b=new w.Ea(e.oe.Jf(b));e=new w.Ea(e.oe.Jf(new w.qj(0,0,0,1)));b=b.sub(e).normalize();a.origin.copy(e);a.direction.copy(b);var g=this.Z;if((e=g.Tm)&&!fd(a,e))return null;var h=Infinity,e=new w.Ea;b=new w.Ea;var k=new w.Ea,l=new w.Ea,m;if(g.jl.length)for(var n=0,p=g.jl.length;n<p;n+=2){var q=new w.Ea,s=new w.Ea, r=3*g.jl[n],u=3*g.jl[n+1];k.set(g.Ia[r],g.Ia[r+1],g.Ia[r+2]);l.set(g.Ia[u],g.Ia[u+1],g.Ia[u+2]);r=a.JU(k,l,q,s);r<h&&(h=r,e.copy(q),b.copy(s),m=n/2)}else for(n=0,p=g.Ia.length;n<p;n+=6)q=new w.Ea,s=new w.Ea,r=n,u=n+3,k.set(g.Ia[r],g.Ia[r+1],g.Ia[r+2]),l.set(g.Ia[u],g.Ia[u+1],g.Ia[u+2]),r=a.JU(k,l,q,s),r<h&&(h=r,e.copy(q),b.copy(s),m=n/6);d*=2;return h<d*d?(b=b.Ye(this.mp),a=b.elements,c=(new w.Ea(0,0,0)).Ye(c.Wi()).Ld(b),e=e.Ye(this.mp),d=e.Ld(b),{Fd:c,nJ:d,Vy:a,index:m,object:this}):null},ih:{nl:{}, attributes:{a_color:{type:"vec4",value:function(){return this.Z.Wa}},a_textureIndex:{type:"float",value:function(){return this.Z.gv}},a_uv:{type:"vec2",value:function(){return this.Z.us}}},Vn:function(){return this.Z.jl},sm:"attribute vec3 a_vertex;\\n\\t\\tattribute vec4 a_color;\\n\\t\\tattribute vec2 a_uv;\\n\\t\\tattribute float a_textureIndex;\\n\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\tuniform mat4 u_projectionMatrix;\\n\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec2 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\n\\t\\tvoid main(void) {\\n\\t\\t\\tv_color = a_color;\\n\\t\\t\\tv_uv = a_uv;\\n\\t\\t\\tv_textureIndex = a_textureIndex;\\n\\t\\t\\tvec4 pos = vec4(a_vertex, 1.0);\\n\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n\\t\\t}\\n\\t\\t", me:" precision mediump float;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec2 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tuniform int u_textureNum;\\n\\t\\tuniform sampler2D u_textures[8];\\n\\t\\tvoid main(void) {\\n\\t\\t\\n\\t\\t\\tif (u_textureNum == 0) {\\n\\t\\t\\t\\tgl_FragColor = v_color;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tvec4 smpColor;\\n\\t\\t\\t\\tfloat textureIndex;\\n\\t\\t\\t\\tif (u_textureNum == 1) {\\n\\t\\t\\t\\t\\ttextureIndex = 0.0;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\ttextureIndex = v_textureIndex;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvec2 uv = v_uv.xy;\\n\\t\\t\\t\\tif (textureIndex == 0.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[0], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 1.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[1], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 2.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[2], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 3.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[3], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 4.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[4], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 5.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[5], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 6.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[6], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 7.0) {\\n\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[7], uv);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (smpColor.a == 0.0) {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tgl_FragColor = smpColor;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t"}});w.zc.Rv=w.zc.extend({B:function(a){this.kl(arguments);this.type="WideLine";this.drawMode="TRIANGLES";this.geometry=this.Z=new w.Wd.Rv;w.a.$j(a,"object")||(a={});this.width=parseFloat(a.width)||2;this.backOrFront="front";this.Ni=20},update:function(){(this.uX||this.needUpdate)&&this.Z.Tfa();w.zc.Rv.rc.update.apply(this,arguments)},Wj:function(){return Math.pow(2,this.w.get("map").get("zoom")-this.Ni)},ih:{nl:{u_width:{type:"float",value:function(){return this.width/this.Wj()/2}}},attributes:{a_vertex:{type:"vec3", value:function(){return this.Z.RE}},a_dir:{type:"vec2",value:function(){return this.Z.mJ}},a_color:{type:"vec4",value:function(){return this.Z.Wa}}},Vn:function(){return this.Z.Vn},sm:"\\n      attribute vec3 a_vertex;\\n      attribute vec2 a_dir;\\n      attribute vec4 a_color;\\n\\n      uniform float u_width;\\n      uniform mat4 u_modelViewMatrix;\\n      uniform mat4 u_projectionMatrix;\\n\\n      varying vec4 v_color;\\n\\n      void main() {\\n        v_color = a_color;\\t\\n        vec4 pos = vec4(a_vertex, 1.0);\\n\\n        pos.x = pos.x + u_width * a_dir.x;\\n        pos.y = pos.y + u_width * a_dir.y;\\n\\n        gl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n      }\\n    ", me:"\\n      precision mediump float;\\n\\n      varying vec4 v_color;\\n\\n      void main() {\\n        gl_FragColor = v_color;\\t\\t\\n      }\\n    "}});w.zc.Mv=w.zc.extend({B:function(){this.kl(arguments);this.type="points";this.drawMode="POINTS";this.DEPTH_TEST=!1;this.geometry=this.Z=new w.Wd.Mv;this.borderColor=null;this.borderWeight=0},Lda:function(a,b,c,d){var e=this.Z;a=b.view.Pja(a);b=e.PL[d];var g=4*d,h=0,k=0,l=d=1;e.Mu.length&&(k=e.Mu[g],h=e.Mu[g+1],d=e.Mu[g+2],l=e.Mu[g+3]);e=a.add((new w.G(k-0.5,h-0.5)).Vc(b));a=a.add((new w.G(d-0.5,l-0.5)).Vc(b));if(c.x>=e.x&&c.x<=a.x&&c.y>=e.y&&c.y<=a.y)return!0},om:function(a,b,c,d,e){var g=this.pd; g||(g=c);g.oe||(g.oe=g.Wi());b=new w.Ea(g.oe.Jf(b));g=new w.Ea(g.oe.Jf(new w.qj(0,0,0,1)));b=b.sub(g).normalize();a.origin.copy(g);a.direction.copy(b);var h=this.Z,g=h.Ia,k=Infinity;b=new w.Ea;for(var l,m=new w.Ea,n=this.w.w.g.J,p=0,q=g.length;p<q;p+=3){m.set(g[p],g[p+1],g[p+2]);var s=new w.Ea,r=a.FC(m,s);if(!(r>h.PL[p]/2*1.414*d)&&this.Lda(m,n,e,p/3)){var u=a.origin.Ld(s);u<k&&(b.copy(s),l=p/3,k=u)}}return void 0!==l?(b=b.Ye(this.mp),a=b.elements,u=(new w.Ea(0,0,0)).Ye(c.Wi()).Ld(b),m.set(g[3*l], g[3*l+1],g[3*l+2]),r=m.Ye(this.mp).Ld(b),{Fd:u,nJ:r,Vy:a,index:l,object:this}):null},ih:{nl:{u_hasPointArea:{type:"int",value:function(){return this.a_areaBuffer?1:0}},u_borderWeight:{type:"float",value:function(){return this.borderWeight}},u_borderColor:{type:"vec4",value:function(){return this.borderColor}}},attributes:{a_color:{type:"vec4",value:function(){return this.Z.Wa}},a_textureIndex:{type:"float",value:function(){return this.Z.gv}},a_uv:{type:"vec4",value:function(){return this.Z.us}},a_size:{type:"float", value:function(){return this.Z.PL}},a_area:{type:"vec4",value:function(){return this.Z.Mu}}},sm:"attribute vec3 a_vertex;\\n\\t\\tattribute vec4 a_color;\\n\\t\\tattribute vec4 a_uv;\\n\\t\\tattribute float a_size;\\n\\t\\tattribute float a_textureIndex;\\n\\t\\tattribute vec4 a_area;\\n\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\tuniform mat4 u_projectionMatrix;\\n\\t\\tuniform mediump float u_borderWeight;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec4 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tvarying float v_borderFactor;\\n\\t\\tvarying vec4 v_area;\\n\\n\\t\\tvoid main(void) {\\n\\t\\t\\tv_color = a_color;\\n\\t\\t\\tv_uv = a_uv;\\n\\t\\t\\tv_area = a_area;\\n\\t\\t\\tv_textureIndex = a_textureIndex;\\n\\t\\t\\tvec4 pos = vec4(a_vertex, 1.0);\\n\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n\\t\\t\\tgl_PointSize = a_size;\\n\\t\\t\\tv_borderFactor = u_borderWeight/a_size;\\n\\t\\t}\\n\\t\\t", me:" precision mediump float;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec4 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tvarying vec4 v_area;\\n\\t\\tvarying float v_borderFactor;\\n\\t\\tuniform vec4 u_borderColor;\\n\\t\\tuniform int u_hasPointArea;\\n\\t\\tuniform int u_textureNum;\\n\\t\\tuniform float u_borderWeight;\\n\\t\\tuniform sampler2D u_textures[8];\\n\\t\\tvoid main(void) {\\n\\t\\t\\tfloat minX = 0.0;\\n\\t\\t\\tfloat maxX = 1.0;\\n\\t\\t\\tfloat minY = 0.0;\\n\\t\\t\\tfloat maxY = 1.0;\\n\\n\\t\\t\\tif (u_hasPointArea == 1) {\\n\\t\\t\\t\\tminX = v_area.x;\\n\\t\\t\\t\\tmaxX = v_area.z;\\n\\t\\t\\t\\tminY = v_area.y;\\n\\t\\t\\t\\tmaxY = v_area.w;\\n\\t\\t\\t\\tif (gl_PointCoord.x < minX || gl_PointCoord.x > maxX || gl_PointCoord.y <minY || gl_PointCoord.y > maxY) {\\n\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\t\\n\\t\\t\\tif (u_borderWeight!=0.0&&(gl_PointCoord.x <= minX + v_borderFactor || gl_PointCoord.x >= maxX - v_borderFactor || gl_PointCoord.y <= minY + v_borderFactor || gl_PointCoord.y >= maxY - v_borderFactor)) {\\n\\t\\t\\t\\t\\tgl_FragColor = u_borderColor;\\n\\t\\t\\t}else{\\n\\t\\t\\t\\tif (u_textureNum == 0) {\\n\\t\\t\\t\\t\\tgl_FragColor = v_color;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tvec4 smpColor;\\n\\t\\t\\t\\t\\tfloat textureIndex;\\n\\t\\t\\t\\t\\tif (u_textureNum == 1) {\\n\\t\\t\\t\\t\\t\\ttextureIndex = 0.0;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\ttextureIndex = v_textureIndex;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tvec2 uv = v_uv.xy;\\n\\t\\t\\t\\t\\tfloat x, y;\\n\\t\\t\\t\\t\\tif (u_hasPointArea == 0) {\\n\\t\\t\\t\\t\\t\\tx = gl_PointCoord.x;\\n\\t\\t\\t\\t\\t\\ty = gl_PointCoord.y;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tx = (gl_PointCoord.x - v_area.x) / (v_area.z - v_area.x);\\n\\t\\t\\t\\t\\t\\ty = (gl_PointCoord.y - v_area.y) / (v_area.w - v_area.y);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tuv = vec2(x * (v_uv.z - v_uv.x) + v_uv.x, y * (v_uv.w - v_uv.y) + v_uv.y);\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\tif (textureIndex == 0.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[0], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 1.0) {\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[1], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 2.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[2], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 3.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[3], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 4.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[4], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 5.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[5], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 6.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[6], uv);\\n\\t\\t\\t\\t\\t} else if (textureIndex == 7.0) {\\n\\t\\t\\t\\t\\t\\tsmpColor = texture2D(u_textures[7], uv);\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tsmpColor = vec4(1, 0, 0, 1);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tif (smpColor.a == 0.0) {\\n\\t\\t\\t\\t\\t\\tdiscard;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tgl_FragColor = smpColor;\\n\\t\\t\\t\\t}\\t\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\t"}});w.zc.C0=w.zc.Mv.extend({B:function(){this.kl(arguments);this.type="roundpoints";this.merge=!1},ih:{nl:{u_merge:{type:"int",value:function(){return this.merge}}},attributes:{},sm:"attribute vec3 a_vertex;\\n\\t\\tattribute vec4 a_color;\\n\\t\\tattribute vec4 a_uv;\\n\\t\\tattribute float a_size;\\n\\t\\tattribute float a_textureIndex;\\n\\t\\tuniform mat4 u_modelViewMatrix;\\n\\t\\tuniform mat4 u_projectionMatrix;\\n\\t\\tuniform mediump float u_borderWeight;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec4 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tvarying vec2 v_rs;\\n\\n\\t\\tvoid main(void) {\\n\\t\\t\\tv_color = a_color;\\n\\t\\t\\tv_uv = a_uv;\\n\\t\\t\\tv_textureIndex = a_textureIndex;\\n\\t\\t\\tvec4 pos = vec4(a_vertex, 1.0);\\n\\t\\t\\tgl_Position = u_projectionMatrix * u_modelViewMatrix * pos;\\n\\t\\t\\tgl_PointSize = a_size;\\n\\t\\t\\tv_rs = vec2(a_size/2.0,a_size/2.0-u_borderWeight);//\\u5916\\u534a\\u5f84\\uff0c\\u5185\\u534a\\u5f84\\n\\t\\t}\\n\\t", me:" precision mediump float;\\n\\t\\tvarying vec4 v_color;\\n\\t\\tvarying vec4 v_uv;\\n\\t\\tvarying float v_textureIndex;\\n\\t\\tvarying float v_borderFactor;\\n\\t\\tuniform vec4 u_borderColor;\\n\\t\\tuniform int u_textureNum;\\n\\t\\tuniform int u_merge;\\n\\t\\tuniform float u_borderWeight;\\n\\t\\tuniform sampler2D u_textures[8];\\n\\t\\tvarying vec2 v_rs;\\n\\t\\tvoid main(void) {\\n\\t\\t\\tfloat ro = v_rs.x;\\n\\t\\t\\tfloat ri = v_rs.y;\\n\\t\\t\\tfloat dis2center = distance(gl_PointCoord,vec2(0.5,0.5))*ro*2.0;//\\u8ddd\\u79bb\\u8fb9\\u754c\\u7684\\u50cf\\u7d20\\u8ddd\\u79bb\\n\\t\\t\\tif(dis2center>ro){\\n\\t\\t\\t\\tdiscard;\\n\\t\\t\\t}\\n\\t\\t\\tif(u_borderWeight>0.0){//\\u6709border\\n\\t\\t\\t\\tif(dis2center>ro-1.0){\\n\\t\\t\\t\\t\\tgl_FragColor = vec4(u_borderColor.xyz,u_borderColor.a*(ro-dis2center));\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}else if(dis2center>ri){\\n\\t\\t\\t\\t\\tgl_FragColor=u_borderColor;\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tvec4 color = v_color;\\n\\t\\t\\tif (u_textureNum != 0) {\\n\\t\\t\\t\\tfloat textureIndex;\\n\\t\\t\\t\\tif (u_textureNum == 1) {\\n\\t\\t\\t\\t\\ttextureIndex = 0.0;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\ttextureIndex = v_textureIndex;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvec2 uv = mix(v_uv.xy,v_uv.zw,gl_PointCoord);\\n\\t\\t\\t\\tif (textureIndex == 0.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[0], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 1.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[1], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 2.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[2], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 3.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[3], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 4.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[4], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 5.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[5], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 6.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[6], uv);\\n\\t\\t\\t\\t} else if (textureIndex == 7.0) {\\n\\t\\t\\t\\t\\tcolor = texture2D(u_textures[7], uv);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(u_merge==1){\\n\\t\\t\\t\\t\\tcolor = vec4(color.rgb * color.a + v_color.rgb * (1.0 - color.a), color.a+v_color.a*(1.0-color.a));\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tif(dis2center>ri-1.0){\\n\\t\\t\\t\\tfloat factor = ri-dis2center;//\\u586b\\u5145\\u8272\\u7684\\u767e\\u5206\\u6bd4\\n\\t\\t\\t\\tif (u_borderWeight == 0.0) {\\n\\t\\t\\t\\t\\tfloat a = color.a*factor;\\n\\t\\t\\t\\t\\tgl_FragColor = vec4(color.rgb, a);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tfloat a = u_borderColor.a*(1.0-factor) +color.a*factor;\\n\\t\\t\\t\\t\\tgl_FragColor = vec4(u_borderColor.rgb * (1.0-factor) + color.rgb * factor, a);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}else{\\n\\t\\t\\t\\tgl_FragColor=color;\\n\\t\\t\\t}\\n\\t\\t}"}});w.zc.p0=w.zc.Rv.extend({B:function(a){this.kl(arguments);this.type="meshline";this.F=a},mC:function(a){(this.uX||this.needUpdate)&&this.OF(this.F,a)},OF:function(a,b){var c=w.a,d=a.path,e=a.height||0,g=c.Jaa(a.color||"black"),h=[],k=[];d[0]instanceof w.U||c.Pb(d,function(a,b){d[b]=new w.U(a[0],a[1])});var e=c.isArray(e)?c.map(e,function(a){return-1*a}):c.map(d,function(){return-1*e}),l=e[e.length-1];d.forEach(function(a,d){var p=b.Fb(a);h.push(p.x-c.el[0],p.y-c.el[1],e[d]||l);k.push.apply(k,g)}); this.Z.Ia.length&&this.Z.Ia.splice(0,this.Z.Ia.length);this.Z.Wa.length&&this.Z.Wa.splice(0,this.Z.Wa.length);this.Z.Ia.push.apply(this.Z.Ia,h);this.Z.Wa.push.apply(this.Z.Wa,k)},setColor:function(a){this.F.color=a;this.TB()},setHeight:function(a){this.F.height=a;this.TB()},setWidth:function(a){this.width=this.F.width=a;this.TB()},setPath:function(a){this.F.path=a;this.TB();this.mC(this.w.get("map"))},TB:function(){this.uX=this.needUpdate=!0;this.reDraw()}});Ac=window.AMap;Ac.Vector3=w.Ea;Ac.Object3D=w.zc;Ac.Object3DLayer=$.w.$n;Ac.Object3DGroup=w.r0;Ac.Walls=w.dA;Ac.Object3D.Mesh=w.zc.Kv;Ac.Object3D.MeshAcceptLights=w.zc.aO;Ac.Object3D.Prism=w.zc.bO;Ac.Object3D.Line=w.zc.Xn;Ac.Object3D.Points=w.zc.Mv;Ac.Object3D.RoundPoints=w.zc.C0;Ac.Object3D.MeshLine=w.zc.p0;Ac.Geometry3D={Mesh:w.Wd.Kv,Line:w.Wd.Xn,Points:w.Wd.Mv};Ac.Lights={AmbientLight:w.Fs.AN,DirectionLight:w.Fs.IN}; ')
_jsload_('sync', '(function(){if(w.A.Cc){var a=function(){var a=w.A.Cc.split("."),b=window;do if(b=b[a.shift()],!b)return null;while(a.length);return b||null},b=function(b){var c=a();if(c){if("function"!==typeof c)throw Error(w.A.Cc+" is not a function!");setTimeout(c,1)}else if(b)throw Error("Can not find callback: "+w.A.Cc+", try define it before load JsApi!");};document.body&&a()?b():setTimeout(function(){b(!0)},300)}var c=(new Date).getTime(),c=["s=rsv3&product=JsInit&key="+w.A.key,"t="+c];c.push("resolution="+ window.innerWidth+"*"+window.innerHeight);c.push("mob="+(w.l.Y?1:0));c.push("vt="+(w.l.Fx?1:0));c.push("dpr="+window.devicePixelRatio);c.push("scale="+w.l.SE||0);c.push("detect="+w.l.ja);c=w.A.sd+"/v3/log/init?"+c.join("&");new w.Sa.fb(c,{callback:"callback"})})(); ')